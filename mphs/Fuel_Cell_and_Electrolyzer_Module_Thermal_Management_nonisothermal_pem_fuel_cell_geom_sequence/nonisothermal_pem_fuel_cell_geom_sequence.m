function out = model
%
% nonisothermal_pem_fuel_cell_geom_sequence.m
%
% Model exported on May 26 2025, 21:28 by COMSOL 6.2.0.339.

import com.comsol.model.*
import com.comsol.model.util.*

model = ModelUtil.create('Model');

model.modelPath('/Applications/COMSOL62/Multiphysics/applications/Fuel_Cell_and_Electrolyzer_Module/Thermal_Management');

model.modelNode.create('comp1', true);

model.geom.create('geom1', 3);
model.geom('geom1').model('comp1');

model.mesh.create('mesh1', 'geom1');

% To import content from file, use:
% model.param.loadFile('FILENAME');
model.param.set('m_th', '0.15[mm]', 'Mesh thickness');
model.param.set('m_sw', '0.6[mm]', 'Mesh saddle width');
model.param.set('m_sl', '0.3[mm]', 'Mesh saddle slope length');
model.param.set('m_sfc', '0.4[mm]', 'Mesh saddle flat contact');
model.param.set('m_sr', '0.3[mm]', 'Mesh saddle ridge');
model.param.set('m_osl', '0.8[mm]', 'Mesh opening slope length');
model.param.set('uc_vs', 'm_sfc+m_sl+m_th/sqrt(m_sl^2+m_sr^2)*m_sr+m_sr*mdp', 'Unit cell vertical shift');
model.param.set('uc_hs', 'm_osl+m_sw', 'Unit cell horizontal shift');
model.param.set('n_vc', '5', 'Number of vertical unit cells');
model.param.set('n_hc', '2', 'Number of horizontal cells');
model.param.set('c_th', '0.2[mm]', 'Cathode thickness');
model.param.set('me_th', '0.05[mm]', 'Membrane thickness');
model.param.set('a_th', '0.2[mm]', 'Anode thickness');
model.param.set('cp_th', '0.075[mm]', 'Cooling plate thickness');
model.param.set('ch_h', '0.6[mm]', 'Cooling channel height');
model.param.set('mdp', '0.2[1]', 'Mesh distance parameter, 0<=mdp<=1');

model.geom('geom1').geomRep('cadps');
model.geom('geom1').create('wp1', 'WorkPlane');
model.geom('geom1').feature('wp1').set('unite', true);
model.geom('geom1').feature('wp1').set('quickplane', 'yz');
model.geom('geom1').feature('wp1').geom.create('pol1', 'Polygon');
model.geom('geom1').feature('wp1').geom.feature('pol1').set('source', 'table');
model.geom('geom1').feature('wp1').geom.feature('pol1').set('type', 'open');
model.geom('geom1').feature('wp1').geom.feature('pol1').setIndex('table', 0, 0, 0);
model.geom('geom1').feature('wp1').geom.feature('pol1').setIndex('table', 'm_sr', 0, 1);
model.geom('geom1').feature('wp1').geom.feature('pol1').setIndex('table', 'm_sl', 1, 0);
model.geom('geom1').feature('wp1').geom.feature('pol1').setIndex('table', 0, 1, 1);
model.geom('geom1').feature('wp1').geom.feature('pol1').setIndex('table', 'm_sl+m_sfc', 2, 0);
model.geom('geom1').feature('wp1').geom.feature('pol1').setIndex('table', 0, 2, 1);
model.geom('geom1').feature('wp1').geom.run('pol1');
model.geom('geom1').feature('wp1').geom.create('thi1', 'Thicken2D');
model.geom('geom1').feature('wp1').geom.feature('thi1').selection('input').set({'pol1'});
model.geom('geom1').feature('wp1').geom.feature('thi1').set('offset', 'asymmetric');
model.geom('geom1').feature('wp1').geom.feature('thi1').set('upthick', 'm_th');
model.geom('geom1').feature('wp1').geom.feature('thi1').set('convexcorner', 'tangent');
model.geom('geom1').feature('wp1').geom.run('thi1');
model.geom('geom1').run('wp1');
model.geom('geom1').feature.create('ext1', 'Extrude');
model.geom('geom1').feature('ext1').setIndex('distance', 'm_sw/2', 0);
model.geom('geom1').run('ext1');
model.geom('geom1').create('wp2', 'WorkPlane');
model.geom('geom1').feature('wp2').set('unite', true);
model.geom('geom1').feature('wp2').set('quickplane', 'yz');
model.geom('geom1').feature('wp2').set('quickx', 'm_sw/2+m_osl');
model.geom('geom1').feature('wp2').geom.create('pol1', 'Polygon');
model.geom('geom1').feature('wp2').geom.feature('pol1').set('source', 'table');
model.geom('geom1').feature('wp2').geom.feature('pol1').set('type', 'open');
model.geom('geom1').feature('wp2').geom.feature('pol1').setIndex('table', 0, 0, 0);
model.geom('geom1').feature('wp2').geom.feature('pol1').setIndex('table', 'm_sr', 0, 1);
model.geom('geom1').feature('wp2').geom.feature('pol1').setIndex('table', '-m_sl', 1, 0);
model.geom('geom1').feature('wp2').geom.feature('pol1').setIndex('table', '2*m_sr', 1, 1);
model.geom('geom1').feature('wp2').geom.feature('pol1').setIndex('table', '-(m_sfc+m_sl)', 2, 0);
model.geom('geom1').feature('wp2').geom.feature('pol1').setIndex('table', '2*m_sr', 2, 1);
model.geom('geom1').feature('wp2').geom.run('pol1');
model.geom('geom1').feature('wp2').geom.create('thi1', 'Thicken2D');
model.geom('geom1').feature('wp2').geom.feature('thi1').selection('input').set({'pol1'});
model.geom('geom1').feature('wp2').geom.feature('thi1').set('offset', 'asymmetric');
model.geom('geom1').feature('wp2').geom.feature('thi1').set('upthick', 'm_th');
model.geom('geom1').feature('wp2').geom.feature('thi1').set('convexcorner', 'tangent');
model.geom('geom1').feature('wp2').geom.run('thi1');
model.geom('geom1').feature('wp2').geom.create('mov1', 'Move');
model.geom('geom1').feature('wp2').geom.feature('mov1').selection('input').set({'thi1'});
model.geom('geom1').feature('wp2').geom.feature('mov1').set('displx', 'm_th/sqrt(m_sl^2+m_sr^2)*m_sr');
model.geom('geom1').feature('wp2').geom.feature('mov1').set('disply', 'm_th/sqrt(m_sl^2+m_sr^2)*m_sl');
model.geom('geom1').feature('wp2').geom.run('mov1');
model.geom('geom1').feature('wp2').geom.create('mov2', 'Move');
model.geom('geom1').feature('wp2').geom.feature('mov2').set('displx', 'uc_vs');
model.geom('geom1').feature('wp2').geom.feature('mov2').selection('input').set({'mov1'});
model.geom('geom1').feature('wp2').geom.run('mov2');
model.geom('geom1').run('wp2');
model.geom('geom1').create('loft1', 'Loft');
model.geom('geom1').feature('loft1').selection('startprofile').set('ext1', 8);
model.geom('geom1').feature('loft1').selection('endprofile').set('wp2', 1);
model.geom('geom1').run('loft1');
model.geom('geom1').feature.create('ext2', 'Extrude');
model.geom('geom1').feature('ext2').set('extrudefrom', 'faces');
model.geom('geom1').feature('ext2').selection('inputface').set('loft1', 15);
model.geom('geom1').feature('ext2').setIndex('distance', 'm_sw/2', 0);
model.geom('geom1').run('ext2');
model.geom('geom1').create('mir1', 'Mirror');
model.geom('geom1').feature('mir1').selection('input').set({'ext2'});
model.geom('geom1').feature('mir1').set('keep', true);
model.geom('geom1').feature('mir1').set('axis', [1 0 0]);
model.geom('geom1').run('mir1');
model.geom('geom1').create('mov1', 'Move');
model.geom('geom1').feature('mov1').selection('input').set({'mir1'});
model.geom('geom1').feature('mov1').set('displx', 'uc_hs');
model.geom('geom1').feature('mov1').set('disply', '-uc_vs');
model.geom('geom1').run('mov1');
model.geom('geom1').create('uni1', 'Union');
model.geom('geom1').feature('uni1').selection('input').set({'ext2' 'mov1'});
model.geom('geom1').run('uni1');
model.geom('geom1').create('sel1', 'ExplicitSelection');
model.geom('geom1').feature('sel1').label('Current Collector Mesh');
model.geom('geom1').feature('sel1').selection('selection').init;
model.geom('geom1').feature('sel1').selection('selection').set({'uni1'});
model.geom('geom1').feature('sel1').set('selshow', false);
model.geom('geom1').selection.create('csel1', 'CumulativeSelection');
model.geom('geom1').selection('csel1').label('Mesh');
model.geom('geom1').feature('sel1').set('contributeto', 'csel1');
model.geom('geom1').run('sel1');
model.geom('geom1').create('sel2', 'ExplicitSelection');
model.geom('geom1').feature('sel2').label('Current Collector Cathode GDL Contact');
model.geom('geom1').feature('sel2').selection('selection').init(2);
model.geom('geom1').feature('sel2').selection('selection').set('uni1', [11 36]);
model.geom('geom1').feature('sel2').set('selshow', false);
model.geom('geom1').selection.create('csel2', 'CumulativeSelection');
model.geom('geom1').selection('csel2').label('Cathode Contact');
model.geom('geom1').feature('sel2').set('contributeto', 'csel2');
model.geom('geom1').run('sel2');
model.geom('geom1').create('if1', 'If');
model.geom('geom1').feature.createAfter('endif1', 'EndIf', 'if1');
model.geom('geom1').feature('if1').set('condition', 'n_vc > 1');
model.geom('geom1').run('if1');
model.geom('geom1').create('arr1', 'Array');
model.geom('geom1').feature('arr1').selection('input').set({'uni1'});
model.geom('geom1').feature('arr1').set('fullsize', {'1' 'n_vc' '1'});
model.geom('geom1').feature('arr1').set('displ', {'0' '-2*uc_vs' '0'});
model.geom('geom1').run('arr1');
model.geom('geom1').run('endif1');
model.geom('geom1').create('if2', 'If');
model.geom('geom1').feature.createAfter('endif2', 'EndIf', 'if2');
model.geom('geom1').feature('if2').set('condition', 'n_hc > 0.5');
model.geom('geom1').run('if2');
model.geom('geom1').create('mir2', 'Mirror');
model.geom('geom1').feature('mir2').selection('input').named('csel1');
model.geom('geom1').feature('mir2').set('keep', true);
model.geom('geom1').feature('mir2').set('pos', {'uc_hs' '0' '0'});
model.geom('geom1').feature('mir2').set('axis', [1 0 0]);
model.geom('geom1').run('mir2');
model.geom('geom1').run('endif2');
model.geom('geom1').create('if3', 'If');
model.geom('geom1').feature.createAfter('endif3', 'EndIf', 'if3');
model.geom('geom1').feature('if3').set('condition', 'n_hc > 1');
model.geom('geom1').run('if3');
model.geom('geom1').create('arr2', 'Array');
model.geom('geom1').feature('arr2').selection('input').named('sel1');
model.geom('geom1').feature('arr2').set('fullsize', {'n_hc' '1' '1'});
model.geom('geom1').feature('arr2').set('displ', {'2*uc_hs' '0' '0'});
model.geom('geom1').run('arr2');
model.geom('geom1').run('endif3');
model.geom('geom1').create('if4', 'If');
model.geom('geom1').feature.createAfter('endif4', 'EndIf', 'if4');
model.geom('geom1').feature('if4').set('condition', 'n_hc<1');
model.geom('geom1').run('if4');
model.geom('geom1').create('wp3', 'WorkPlane');
model.geom('geom1').feature('wp3').set('unite', true);
model.geom('geom1').feature('wp3').geom.create('r1', 'Rectangle');
model.geom('geom1').feature('wp3').geom.feature('r1').set('size', {'uc_hs' '2*n_vc*uc_vs-m_th/sqrt(m_sl^2+m_sr^2)*m_sr'});
model.geom('geom1').feature('wp3').geom.feature('r1').set('pos', {'0' '-2*n_vc*uc_vs-m_th/sqrt(m_sl^2+m_sr^2)*m_sr+(uc_vs+2*m_th/sqrt(m_sl^2+m_sr^2)*m_sr)'});
model.geom('geom1').feature('wp3').geom.run('r1');
model.geom('geom1').run('wp3');
model.geom('geom1').feature.create('ext3', 'Extrude');
model.geom('geom1').feature('ext3').setIndex('distance', '2*m_sr+m_th/sqrt(m_sl^2+m_sr^2)*m_sl', 0);
model.geom('geom1').selection.create('csel3', 'CumulativeSelection');
model.geom('geom1').selection('csel3').label('Cathode Gas Compartment and Mesh');
model.geom('geom1').feature('ext3').set('contributeto', 'csel3');
model.geom('geom1').run('ext3');
model.geom('geom1').create('sel3', 'ExplicitSelection');
model.geom('geom1').feature('sel3').label('Cathode Upper Surface 1');
model.geom('geom1').feature('sel3').selection('selection').init(2);
model.geom('geom1').feature('sel3').selection('selection').set('ext3', 3);
model.geom('geom1').selection.create('csel4', 'CumulativeSelection');
model.geom('geom1').selection('csel4').label('Cathode GDL Surface');
model.geom('geom1').feature('sel3').set('contributeto', 'csel4');
model.geom('geom1').run('sel3');
model.geom('geom1').create('elseif1', 'ElseIf');
model.geom('geom1').feature('elseif1').set('condition', 'n_hc >= 1');
model.geom('geom1').run('elseif1');
model.geom('geom1').create('wp4', 'WorkPlane');
model.geom('geom1').feature('wp4').set('unite', true);
model.geom('geom1').feature('wp4').geom.create('r1', 'Rectangle');
model.geom('geom1').feature('wp4').geom.feature('r1').set('size', {'n_hc*2*uc_hs' '1'});
model.geom('geom1').feature('wp4').geom.feature('r1').setIndex('size', '2*n_vc*uc_vs-m_th/sqrt(m_sl^2+m_sr^2)*m_sr', 1);
model.geom('geom1').feature('wp4').geom.feature('r1').set('pos', {'0' '-2*n_vc*uc_vs-m_th/sqrt(m_sl^2+m_sr^2)*m_sr+(uc_vs+2*m_th/sqrt(m_sl^2+m_sr^2)*m_sr)'});
model.geom('geom1').feature('wp4').geom.run('r1');
model.geom('geom1').run('wp4');
model.geom('geom1').feature.create('ext4', 'Extrude');
model.geom('geom1').feature('ext4').setIndex('distance', '2*m_sr+m_th/sqrt(m_sl^2+m_sr^2)*m_sl', 0);
model.geom('geom1').feature('ext4').set('contributeto', 'csel3');
model.geom('geom1').run('ext4');
model.geom('geom1').create('sel4', 'ExplicitSelection');
model.geom('geom1').feature('sel4').label('Cathode Upper Surface 2');
model.geom('geom1').feature('sel4').selection('selection').init(2);
model.geom('geom1').feature('sel4').selection('selection').set('ext4', 3);
model.geom('geom1').feature('sel4').set('selshow', false);
model.geom('geom1').feature('sel4').set('contributeto', 'csel4');
model.geom('geom1').run('sel4');
model.geom('geom1').run('endif4');
model.geom('geom1').feature.create('ext5', 'Extrude');
model.geom('geom1').feature('ext5').set('extrudefrom', 'faces');
model.geom('geom1').feature('ext5').selection('inputface').named('csel4');
model.geom('geom1').feature('ext5').setIndex('distance', 'c_th', 0);
model.geom('geom1').feature('ext5').setIndex('distance', 'c_th+me_th/2', 1);
model.geom('geom1').feature('ext5').set('displ', {'0' '0'; '0' '0'});
model.geom('geom1').feature('ext5').set('scale', {'1' '1'; '1' '1'});
model.geom('geom1').feature('ext5').set('twist', {'0' '0'});
model.geom('geom1').run('ext5');
model.geom('geom1').create('uni2', 'Union');
model.geom('geom1').feature('uni2').selection('input').named('csel1');
model.geom('geom1').feature('uni2').set('intbnd', false);
model.geom('geom1').feature('uni2').set('contributeto', 'csel1');
model.geom('geom1').run('uni2');
model.geom('geom1').create('co1', 'Compose');
model.geom('geom1').feature('co1').selection('input').set({'ext5' 'uni2'});
model.geom('geom1').feature('co1').set('formula', 'ext5*uni2+ext5');
model.geom('geom1').selection.create('csel5', 'CumulativeSelection');
model.geom('geom1').selection('csel5').label('Cathode Side');
model.geom('geom1').feature('co1').set('contributeto', 'csel5');
model.geom('geom1').run('co1');
model.geom('geom1').create('spl1', 'Split');
model.geom('geom1').feature('spl1').selection('input').named('csel5');
model.geom('geom1').run('spl1');
model.geom('geom1').create('difsel1', 'DifferenceSelection');
model.geom('geom1').feature('difsel1').label('Cathode Free Gas Compartment');
model.geom('geom1').feature('difsel1').set('entitydim', -1);
model.geom('geom1').feature('difsel1').set('add', {'csel3'});
model.geom('geom1').feature('difsel1').set('subtract', {'csel1'});
model.geom('geom1').run('difsel1');
model.geom('geom1').create('boxsel1', 'BoxSelection');
model.geom('geom1').feature('boxsel1').label('Cathode Gas Inlet');
model.geom('geom1').feature('boxsel1').set('entitydim', 2);
model.geom('geom1').feature('boxsel1').set('inputent', 'selections');
model.geom('geom1').feature('boxsel1').set('input', {'difsel1'});
model.geom('geom1').feature('boxsel1').set('ymin', '(-2*n_vc*uc_vs-m_th/sqrt(m_sl^2+m_sr^2)*m_sr+(uc_vs+2*m_th/sqrt(m_sl^2+m_sr^2)*m_sr))*1.01');
model.geom('geom1').feature('boxsel1').set('ymax', '(-2*n_vc*uc_vs-m_th/sqrt(m_sl^2+m_sr^2)*m_sr+(uc_vs+2*m_th/sqrt(m_sl^2+m_sr^2)*m_sr))*0.99');
model.geom('geom1').feature('boxsel1').set('condition', 'inside');
model.geom('geom1').run('boxsel1');
model.geom('geom1').create('boxsel2', 'BoxSelection');
model.geom('geom1').feature('boxsel2').label('Cathode Gas Outlet');
model.geom('geom1').feature('boxsel2').set('entitydim', 2);
model.geom('geom1').feature('boxsel2').set('inputent', 'selections');
model.geom('geom1').feature('boxsel2').set('input', {'difsel1'});
model.geom('geom1').feature('boxsel2').set('ymin', '((2*n_vc*uc_vs-m_th/sqrt(m_sl^2+m_sr^2)*m_sr)+(-2*n_vc*uc_vs-m_th/sqrt(m_sl^2+m_sr^2)*m_sr+(uc_vs+2*m_th/sqrt(m_sl^2+m_sr^2)*m_sr)))*0.99');
model.geom('geom1').feature('boxsel2').set('ymax', '((2*n_vc*uc_vs-m_th/sqrt(m_sl^2+m_sr^2)*m_sr)+(-2*n_vc*uc_vs-m_th/sqrt(m_sl^2+m_sr^2)*m_sr+(uc_vs+2*m_th/sqrt(m_sl^2+m_sr^2)*m_sr)))*1.01');
model.geom('geom1').feature('boxsel2').set('condition', 'inside');
model.geom('geom1').run('boxsel2');
model.geom('geom1').create('boxsel3', 'BoxSelection');
model.geom('geom1').feature('boxsel3').label('Membrane Middle Surface');
model.geom('geom1').feature('boxsel3').set('entitydim', 2);
model.geom('geom1').feature('boxsel3').set('zmin', '-c_th-me_th*0.51');
model.geom('geom1').feature('boxsel3').set('zmax', '-c_th-me_th*0.49');
model.geom('geom1').feature('boxsel3').set('condition', 'inside');
model.geom('geom1').run('boxsel3');
model.geom('geom1').create('uni3', 'Union');
model.geom('geom1').feature('uni3').selection('input').named('csel5');
model.geom('geom1').feature('uni3').set('contributeto', 'csel5');
model.geom('geom1').run('uni3');
model.geom('geom1').feature.create('ext6', 'Extrude');
model.geom('geom1').feature('ext6').set('extrudefrom', 'faces');
model.geom('geom1').feature('ext6').selection('inputface').named('boxsel3');
model.geom('geom1').feature('ext6').set('inputhandling', 'keep');
model.geom('geom1').feature('ext6').setIndex('distance', 'me_th/2', 0);
model.geom('geom1').feature('ext6').setIndex('distance', 'a_th+me_th/2', 1);
model.geom('geom1').feature('ext6').set('displ', {'0' '0'; '0' '0'});
model.geom('geom1').feature('ext6').set('scale', {'1' '1'; '1' '1'});
model.geom('geom1').feature('ext6').set('twist', {'0' '0'});
model.geom('geom1').run('ext6');
model.geom('geom1').create('sel5', 'ExplicitSelection');
model.geom('geom1').feature('sel5').label('Membrane Side Surface');
model.geom('geom1').feature('sel5').selection('selection').init(2);
model.geom('geom1').feature('sel5').selection('selection').set('ext6', 8);
model.geom('geom1').feature('sel5').set('selshow', false);
model.geom('geom1').run('sel5');
model.geom('geom1').create('wp5', 'WorkPlane');
model.geom('geom1').feature('wp5').set('unite', true);
model.geom('geom1').feature('wp5').set('planetype', 'faceparallel');
model.geom('geom1').feature('wp5').selection('face').named('sel5');
model.geom('geom1').feature('wp5').set('origin', 'boxcorner');
model.geom('geom1').feature('wp5').set('faceparallelaxis', 's2');
model.geom('geom1').feature('wp5').geom.create('pol1', 'Polygon');
model.geom('geom1').feature('wp5').geom.feature('pol1').set('source', 'table');
model.geom('geom1').feature('wp5').geom.feature('pol1').set('type', 'open');
model.geom('geom1').feature('wp5').geom.feature('pol1').setIndex('table', 0, 0, 0);
model.geom('geom1').feature('wp5').geom.feature('pol1').setIndex('table', 'a_th', 0, 1);
model.geom('geom1').feature('wp5').geom.feature('pol1').setIndex('table', '(m_osl+m_sw)/4', 1, 0);
model.geom('geom1').feature('wp5').geom.feature('pol1').setIndex('table', 'a_th', 1, 1);
model.geom('geom1').feature('wp5').geom.feature('pol1').setIndex('table', '(m_osl+m_sw)*3/4', 2, 0);
model.geom('geom1').feature('wp5').geom.feature('pol1').setIndex('table', 'a_th+ch_h', 2, 1);
model.geom('geom1').feature('wp5').geom.feature('pol1').setIndex('table', 'm_sw+m_osl', 3, 0);
model.geom('geom1').feature('wp5').geom.feature('pol1').setIndex('table', 'a_th+ch_h', 3, 1);
model.geom('geom1').feature('wp5').geom.run('pol1');
model.geom('geom1').feature('wp5').geom.create('thi1', 'Thicken2D');
model.geom('geom1').feature('wp5').geom.feature('thi1').selection('input').set({'pol1'});
model.geom('geom1').feature('wp5').geom.feature('thi1').set('offset', 'asymmetric');
model.geom('geom1').feature('wp5').geom.feature('thi1').set('upthick', 'm_th');
model.geom('geom1').feature('wp5').geom.feature('thi1').set('convexcorner', 'tangent');
model.geom('geom1').feature('wp5').geom.selection.create('csel1', 'CumulativeSelection');
model.geom('geom1').feature('wp5').geom.selection('csel1').label('Current Feeder Profile');
model.geom('geom1').feature('wp5').geom.feature('thi1').set('contributeto', 'csel1');
model.geom('geom1').feature('wp5').geom.run('thi1');
model.geom('geom1').feature('wp5').geom.create('if1', 'If');
model.geom('geom1').feature('wp5').geom.feature.createAfter('endif1', 'EndIf', 'if1');
model.geom('geom1').feature('wp5').geom.feature('if1').set('condition', 'n_hc > 0.5');
model.geom('geom1').feature('wp5').geom.run('if1');
model.geom('geom1').feature('wp5').geom.create('mir1', 'Mirror');
model.geom('geom1').feature('wp5').geom.feature('mir1').selection('input').named('csel1');
model.geom('geom1').feature('wp5').geom.feature('mir1').set('keep', true);
model.geom('geom1').feature('wp5').geom.feature('mir1').set('pos', {'m_sw+m_osl' '0'});
model.geom('geom1').feature('wp5').geom.feature('mir1').set('contributeto', 'csel1');
model.geom('geom1').feature('wp5').geom.run('mir1');
model.geom('geom1').feature('wp5').geom.create('uni1', 'Union');
model.geom('geom1').feature('wp5').geom.feature('uni1').selection('input').named('csel1');
model.geom('geom1').feature('wp5').geom.feature('uni1').set('contributeto', 'csel1');
model.geom('geom1').feature('wp5').geom.feature('uni1').set('intbnd', false);
model.geom('geom1').feature('wp5').geom.run('uni1');
model.geom('geom1').feature('wp5').geom.run('endif1');
model.geom('geom1').feature('wp5').geom.create('if2', 'If');
model.geom('geom1').feature('wp5').geom.feature.createAfter('endif2', 'EndIf', 'if2');
model.geom('geom1').feature('wp5').geom.feature('if2').set('condition', 'n_hc > 1');
model.geom('geom1').feature('wp5').geom.run('if2');
model.geom('geom1').feature('wp5').geom.create('arr1', 'Array');
model.geom('geom1').feature('wp5').geom.feature('arr1').selection('input').named('csel1');
model.geom('geom1').feature('wp5').geom.feature('arr1').set('fullsize', {'n_hc' '1'});
model.geom('geom1').feature('wp5').geom.feature('arr1').set('displ', {'2*(m_sw+m_osl)' '0'});
model.geom('geom1').feature('wp5').geom.feature('arr1').set('contributeto', 'csel1');
model.geom('geom1').feature('wp5').geom.run('arr1');
model.geom('geom1').feature('wp5').geom.create('uni2', 'Union');
model.geom('geom1').feature('wp5').geom.feature('uni2').selection('input').named('csel1');
model.geom('geom1').feature('wp5').geom.feature('uni2').set('intbnd', false);
model.geom('geom1').feature('wp5').geom.run('uni2');
model.geom('geom1').feature('wp5').geom.run('endif2');
model.geom('geom1').run('wp5');
model.geom('geom1').feature.create('ext7', 'Extrude');
model.geom('geom1').feature('ext7').label('Anode Current Feeder');
model.geom('geom1').feature('ext7').setIndex('distance', '-1*(2*n_vc*uc_vs-m_th/sqrt(m_sl^2+m_sr^2)*m_sr)', 0);
model.geom('geom1').feature('ext7').set('selresult', true);
model.geom('geom1').run('ext7');
model.geom('geom1').create('boxsel4', 'BoxSelection');
model.geom('geom1').feature('boxsel4').label('Anode Current Feeder Contact');
model.geom('geom1').feature('boxsel4').set('entitydim', 2);
model.geom('geom1').feature('boxsel4').set('zmin', '-(c_th+me_th+a_th+ch_h+m_th)*1.01');
model.geom('geom1').feature('boxsel4').set('zmax', '-(c_th+me_th+a_th+ch_h+m_th)*0.99');
model.geom('geom1').feature('boxsel4').set('condition', 'inside');
model.geom('geom1').run('boxsel4');
model.geom('geom1').create('wp6', 'WorkPlane');
model.geom('geom1').feature('wp6').set('unite', true);
model.geom('geom1').feature('wp6').set('planetype', 'faceparallel');
model.geom('geom1').feature('wp6').selection('face').named('sel5');
model.geom('geom1').feature('wp6').set('origin', 'boxcorner');
model.geom('geom1').feature('wp6').set('faceparallelaxis', 's2');
model.geom('geom1').run('wp6');
model.geom('geom1').feature('wp6').geom.create('if1', 'If');
model.geom('geom1').feature('wp6').geom.feature.createAfter('endif1', 'EndIf', 'if1');
model.geom('geom1').feature('wp6').geom.feature('if1').set('condition', 'n_hc < 1');
model.geom('geom1').feature('wp6').geom.run('if1');
model.geom('geom1').feature('wp6').geom.create('r1', 'Rectangle');
model.geom('geom1').feature('wp6').geom.feature('r1').set('size', {'m_sw+m_osl' 'ch_h+m_th'});
model.geom('geom1').feature('wp6').geom.feature('r1').set('pos', {'0' 'a_th'});
model.geom('geom1').feature('wp6').geom.run('r1');
model.geom('geom1').feature('wp6').geom.run('endif1');
model.geom('geom1').feature('wp6').geom.create('if2', 'If');
model.geom('geom1').feature('wp6').geom.feature.createAfter('endif2', 'EndIf', 'if2');
model.geom('geom1').feature('wp6').geom.feature('if2').set('condition', 'n_hc >= 1');
model.geom('geom1').feature('wp6').geom.create('r2', 'Rectangle');
model.geom('geom1').feature('wp6').geom.feature('r2').set('size', {'2*n_hc*(m_sw+m_osl)' '1'});
model.geom('geom1').feature('wp6').geom.feature('r2').setIndex('size', 'ch_h+m_th', 1);
model.geom('geom1').feature('wp6').geom.feature('r2').set('pos', {'0' 'a_th'});
model.geom('geom1').feature('wp6').geom.run('r2');
model.geom('geom1').feature('wp6').geom.run('endif2');
model.geom('geom1').run('wp6');
model.geom('geom1').feature.create('ext8', 'Extrude');
model.geom('geom1').feature('ext8').setIndex('distance', '-1*(2*n_vc*uc_vs-m_th/sqrt(m_sl^2+m_sr^2)*m_sr)', 0);
model.geom('geom1').run('ext8');
model.geom('geom1').create('boxsel5', 'BoxSelection');
model.geom('geom1').feature('boxsel5').label('Anode Side Domains');
model.geom('geom1').feature('boxsel5').set('entitydim', -1);
model.geom('geom1').feature('boxsel5').set('zmax', '-c_th-me_th/4');
model.geom('geom1').feature('boxsel5').set('condition', 'inside');
model.geom('geom1').run('boxsel5');
model.geom('geom1').create('uni4', 'Union');
model.geom('geom1').feature('uni4').selection('input').named('boxsel5');
model.geom('geom1').run('uni4');
model.geom('geom1').create('wp7', 'WorkPlane');
model.geom('geom1').feature('wp7').set('unite', true);
model.geom('geom1').feature('wp7').set('planetype', 'faceparallel');
model.geom('geom1').feature('wp7').selection('face').named('sel5');
model.geom('geom1').feature('wp7').set('origin', 'boxcorner');
model.geom('geom1').feature('wp7').set('faceparallelaxis', 's2');
model.geom('geom1').feature('wp7').geom.create('r1', 'Rectangle');
model.geom('geom1').feature('wp7').geom.feature('r1').set('size', {'m_sw+m_osl' 'm_th/2'});
model.geom('geom1').feature('wp7').geom.feature('r1').set('pos', {'0' '-1*(2*m_sr+m_th/sqrt(m_sl^2+m_sr^2)*m_sl+a_th+c_th+me_th+cp_th)+a_th'});
model.geom('geom1').feature('wp7').geom.selection.create('csel1', 'CumulativeSelection');
model.geom('geom1').feature('wp7').geom.selection('csel1').label('Cooling Plate Profile');
model.geom('geom1').feature('wp7').geom.feature('r1').set('contributeto', 'csel1');
model.geom('geom1').feature('wp7').geom.run('r1');
model.geom('geom1').feature('wp7').geom.create('if1', 'If');
model.geom('geom1').feature('wp7').geom.feature.createAfter('endif1', 'EndIf', 'if1');
model.geom('geom1').feature('wp7').geom.feature('if1').set('condition', 'n_hc > 0.5');
model.geom('geom1').feature('wp7').geom.create('mir1', 'Mirror');
model.geom('geom1').feature('wp7').geom.feature('mir1').selection('input').named('csel1');
model.geom('geom1').feature('wp7').geom.feature('mir1').set('pos', {'m_sw+m_osl' '0'});
model.geom('geom1').feature('wp7').geom.feature('mir1').set('contributeto', 'csel1');
model.geom('geom1').feature('wp7').geom.run('mir1');
model.geom('geom1').feature('wp7').geom.feature('mir1').set('keep', true);
model.geom('geom1').feature('wp7').geom.run('mir1');
model.geom('geom1').feature('wp7').geom.create('uni1', 'Union');
model.geom('geom1').feature('wp7').geom.feature('uni1').selection('input').set({'mir1' 'r1'});
model.geom('geom1').feature('wp7').geom.feature('uni1').set('intbnd', false);
model.geom('geom1').feature('wp7').geom.feature('uni1').set('contributeto', 'csel1');
model.geom('geom1').feature('wp7').geom.run('uni1');
model.geom('geom1').feature('wp7').geom.run('endif1');
model.geom('geom1').feature('wp7').geom.create('if2', 'If');
model.geom('geom1').feature('wp7').geom.feature.createAfter('endif2', 'EndIf', 'if2');
model.geom('geom1').feature('wp7').geom.feature('if2').set('condition', 'n_hc > 1');
model.geom('geom1').feature('wp7').geom.create('arr1', 'Array');
model.geom('geom1').feature('wp7').geom.feature('arr1').selection('input').named('csel1');
model.geom('geom1').feature('wp7').geom.feature('arr1').set('fullsize', {'n_hc' '1'});
model.geom('geom1').feature('wp7').geom.feature('arr1').set('displ', {'2*(m_sw+m_osl)' '0'});
model.geom('geom1').feature('wp7').geom.feature('arr1').set('contributeto', 'csel1');
model.geom('geom1').feature('wp7').geom.run('arr1');
model.geom('geom1').feature('wp7').geom.create('uni2', 'Union');
model.geom('geom1').feature('wp7').geom.feature('uni2').selection('input').named('csel1');
model.geom('geom1').feature('wp7').geom.feature('uni2').set('intbnd', false);
model.geom('geom1').feature('wp7').geom.selection.create('csel2', 'CumulativeSelection');
model.geom('geom1').feature('wp7').geom.selection('csel2').label('Cathode Cooling Channel Plate Profile');
model.geom('geom1').feature('wp7').geom.feature('uni2').set('contributeto', 'csel2');
model.geom('geom1').run('wp7');
model.geom('geom1').feature.create('ext9', 'Extrude');
model.geom('geom1').feature('ext9').label('Top Plate');
model.geom('geom1').feature('ext9').setIndex('distance', '-1*(2*n_vc*uc_vs-m_th/sqrt(m_sl^2+m_sr^2)*m_sr)', 0);
model.geom('geom1').feature('ext9').set('selresult', true);
model.geom('geom1').run('ext9');
model.geom('geom1').create('uni5', 'Union');
model.geom('geom1').feature('uni5').selection('input').set({'ext9' 'uni3'});
model.geom('geom1').run('uni5');
model.geom('geom1').feature('fin').set('action', 'assembly');
model.geom('geom1').run('fin');
model.geom('geom1').create('boxsel6', 'BoxSelection');
model.geom('geom1').feature('boxsel6').label('Anode Free Gas Compartment');
model.geom('geom1').feature('boxsel6').set('zmin', '-(c_th+me_th+a_th+ch_h+m_th/2)');
model.geom('geom1').feature('boxsel6').set('zmax', '-(c_th+me_th+a_th/2)');
model.geom('geom1').feature('boxsel6').set('condition', 'inside');
model.geom('geom1').run('boxsel6');
model.geom('geom1').create('boxsel7', 'BoxSelection');
model.geom('geom1').feature('boxsel7').label('Anode Gas Inlet');
model.geom('geom1').feature('boxsel7').set('entitydim', 2);
model.geom('geom1').feature('boxsel7').set('ymin', '(-2*n_vc*uc_vs-m_th/sqrt(m_sl^2+m_sr^2)*m_sr+(uc_vs+2*m_th/sqrt(m_sl^2+m_sr^2)*m_sr))*1.01');
model.geom('geom1').feature('boxsel7').set('ymax', '(-2*n_vc*uc_vs-m_th/sqrt(m_sl^2+m_sr^2)*m_sr+(uc_vs+2*m_th/sqrt(m_sl^2+m_sr^2)*m_sr))*0.99');
model.geom('geom1').feature('boxsel7').set('zmin', '-(c_th+me_th+a_th+ch_h+m_th/2)');
model.geom('geom1').feature('boxsel7').set('zmax', '-(c_th+me_th+a_th/2)');
model.geom('geom1').feature('boxsel7').set('condition', 'inside');
model.geom('geom1').run('boxsel7');
model.geom('geom1').create('boxsel8', 'BoxSelection');
model.geom('geom1').feature('boxsel8').label('Anode Gas Outlet');
model.geom('geom1').feature('boxsel8').set('entitydim', 2);
model.geom('geom1').feature('boxsel8').set('ymin', '((2*n_vc*uc_vs-m_th/sqrt(m_sl^2+m_sr^2)*m_sr)+(-2*n_vc*uc_vs-m_th/sqrt(m_sl^2+m_sr^2)*m_sr+(uc_vs+2*m_th/sqrt(m_sl^2+m_sr^2)*m_sr)))*0.99');
model.geom('geom1').feature('boxsel8').set('ymax', '((2*n_vc*uc_vs-m_th/sqrt(m_sl^2+m_sr^2)*m_sr)+(-2*n_vc*uc_vs-m_th/sqrt(m_sl^2+m_sr^2)*m_sr+(uc_vs+2*m_th/sqrt(m_sl^2+m_sr^2)*m_sr)))*1.01');
model.geom('geom1').feature('boxsel8').set('zmin', '-(c_th+me_th+a_th+ch_h+m_th/2)');
model.geom('geom1').feature('boxsel8').set('zmax', '-(c_th+me_th+a_th/2)');
model.geom('geom1').feature('boxsel8').set('condition', 'inside');
model.geom('geom1').run('boxsel8');
model.geom('geom1').create('boxsel9', 'BoxSelection');
model.geom('geom1').feature('boxsel9').label('Cooling Channels');
model.geom('geom1').feature('boxsel9').set('zmax', '-(c_th+me_th+a_th+m_th/2)');
model.geom('geom1').feature('boxsel9').set('condition', 'inside');
model.geom('geom1').run('boxsel9');
model.geom('geom1').create('boxsel10', 'BoxSelection');
model.geom('geom1').feature('boxsel10').label('Cooling Inlet');
model.geom('geom1').feature('boxsel10').set('entitydim', 2);
model.geom('geom1').feature('boxsel10').set('ymin', '(-2*n_vc*uc_vs-m_th/sqrt(m_sl^2+m_sr^2)*m_sr+(uc_vs+2*m_th/sqrt(m_sl^2+m_sr^2)*m_sr))*1.01');
model.geom('geom1').feature('boxsel10').set('ymax', '(-2*n_vc*uc_vs-m_th/sqrt(m_sl^2+m_sr^2)*m_sr+(uc_vs+2*m_th/sqrt(m_sl^2+m_sr^2)*m_sr))*0.99');
model.geom('geom1').feature('boxsel10').set('zmax', '-(c_th+me_th+a_th+m_th/2)');
model.geom('geom1').feature('boxsel10').set('condition', 'inside');
model.geom('geom1').run('boxsel10');
model.geom('geom1').create('boxsel11', 'BoxSelection');
model.geom('geom1').feature('boxsel11').label('Cooling Outlet');
model.geom('geom1').feature('boxsel11').set('entitydim', 2);
model.geom('geom1').feature('boxsel11').set('ymin', '((2*n_vc*uc_vs-m_th/sqrt(m_sl^2+m_sr^2)*m_sr)+(-2*n_vc*uc_vs-m_th/sqrt(m_sl^2+m_sr^2)*m_sr+(uc_vs+2*m_th/sqrt(m_sl^2+m_sr^2)*m_sr)))*0.99');
model.geom('geom1').feature('boxsel11').set('ymax', '((2*n_vc*uc_vs-m_th/sqrt(m_sl^2+m_sr^2)*m_sr)+(-2*n_vc*uc_vs-m_th/sqrt(m_sl^2+m_sr^2)*m_sr+(uc_vs+2*m_th/sqrt(m_sl^2+m_sr^2)*m_sr)))*1.01');
model.geom('geom1').feature('boxsel11').set('zmax', '-(c_th+me_th+a_th+m_th/2)');
model.geom('geom1').feature('boxsel11').set('condition', 'inside');
model.geom('geom1').run('boxsel11');
model.geom('geom1').create('boxsel12', 'BoxSelection');
model.geom('geom1').feature('boxsel12').label('Top Plate Surface');
model.geom('geom1').feature('boxsel12').set('zmin', '0.99*((2*m_sr+m_th/sqrt(m_sl^2+m_sr^2)*m_sl+cp_th))');
model.geom('geom1').feature('boxsel12').set('entitydim', 2);
model.geom('geom1').feature('boxsel12').set('zmax', '1.01*((2*m_sr+m_th/sqrt(m_sl^2+m_sr^2)*m_sl+cp_th))');
model.geom('geom1').feature('boxsel12').set('condition', 'inside');
model.geom('geom1').run('boxsel12');
model.geom('geom1').create('boxsel13', 'BoxSelection');
model.geom('geom1').feature('boxsel13').label('Membrane');
model.geom('geom1').feature('boxsel13').set('zmin', '-c_th-me_th*0.99');
model.geom('geom1').feature('boxsel13').set('zmax', '-c_th-me_th*0.01');
model.geom('geom1').run('boxsel13');
model.geom('geom1').feature.duplicate('boxsel14', 'boxsel13');
model.geom('geom1').feature('boxsel14').label('Cathode GDL');
model.geom('geom1').feature('boxsel14').set('zmin', '-c_th*0.99');
model.geom('geom1').feature('boxsel14').set('zmax', '-c_th*0.01');
model.geom('geom1').run('boxsel14');
model.geom('geom1').feature.duplicate('boxsel15', 'boxsel14');
model.geom('geom1').feature('boxsel15').label('Anode GDL');
model.geom('geom1').feature('boxsel15').set('zmin', '-(c_th+me_th)-a_th*0.99');
model.geom('geom1').feature('boxsel15').set('zmax', '-(c_th+me_th)-a_th*0.01');
model.geom('geom1').run('boxsel15');
model.geom('geom1').feature.duplicate('boxsel16', 'boxsel15');
model.geom('geom1').feature('boxsel16').label('Cathode GDE');
model.geom('geom1').feature('boxsel16').set('entitydim', 2);
model.geom('geom1').feature('boxsel16').set('zmin', '-c_th-me_th*0.01');
model.geom('geom1').feature('boxsel16').set('zmax', '-c_th*0.99');
model.geom('geom1').feature('boxsel16').set('condition', 'inside');
model.geom('geom1').run('boxsel16');
model.geom('geom1').feature.duplicate('boxsel17', 'boxsel16');
model.geom('geom1').feature('boxsel17').label('Anode GDE');
model.geom('geom1').feature('boxsel17').set('zmin', '-(c_th+me_th)-a_th*0.01');
model.geom('geom1').feature('boxsel17').set('zmax', '-c_th-me_th*0.99');
model.geom('geom1').run('boxsel17');
model.geom('geom1').create('boxsel18', 'BoxSelection');
model.geom('geom1').feature('boxsel18').label('Bottom Boundaries');
model.geom('geom1').feature('boxsel18').set('entitydim', 2);
model.geom('geom1').feature('boxsel18').set('zmax', '-(c_th+me_th+a_th+m_th+ch_h*0.99)');
model.geom('geom1').feature('boxsel18').set('condition', 'inside');
model.geom('geom1').run('boxsel18');
model.geom('geom1').create('boxsel19', 'BoxSelection');
model.geom('geom1').feature('boxsel19').label('Right Symmetry Boundaries');
model.geom('geom1').feature('boxsel19').set('entitydim', 2);
model.geom('geom1').feature('boxsel19').set('xmin', '2*(m_sw+m_osl)*n_hc-m_th*0.1');
model.geom('geom1').feature('boxsel19').set('xmax', '2*(m_sw+m_osl)*n_hc+m_th*0.1');
model.geom('geom1').feature('boxsel19').set('condition', 'inside');
model.geom('geom1').run('boxsel19');
model.geom('geom1').feature.duplicate('boxsel20', 'boxsel19');
model.geom('geom1').feature('boxsel20').label('Left Symmetry Boundaries');
model.geom('geom1').feature('boxsel20').set('xmin', '-m_th*0.1');
model.geom('geom1').feature('boxsel20').set('xmax', 'm_th*0.1');
model.geom('geom1').run('boxsel20');
model.geom('geom1').create('unisel1', 'UnionSelection');
model.geom('geom1').feature('unisel1').label('Fuel Cell Physics Domains');
model.geom('geom1').feature('unisel1').set('input', {'csel3' 'ext7' 'ext9' 'boxsel6' 'boxsel13' 'boxsel14' 'boxsel15'});
model.geom('geom1').run('unisel1');
model.geom('geom1').create('unisel2', 'UnionSelection');
model.geom('geom1').feature('unisel2').label('Top and Bottom Boundaries');
model.geom('geom1').feature('unisel2').set('entitydim', 2);
model.geom('geom1').feature('unisel2').set('input', {'boxsel12' 'boxsel18'});
model.geom('geom1').run('unisel2');
model.geom('geom1').feature.duplicate('unisel3', 'unisel2');
model.geom('geom1').feature('unisel3').label('Right and Left Symmetry Boundaries');
model.geom('geom1').feature('unisel3').set('input', {'boxsel19' 'boxsel20'});
model.geom('geom1').run('unisel3');
model.geom('geom1').create('unisel4', 'UnionSelection');
model.geom('geom1').feature('unisel4').label('Metal Conductors');
model.geom('geom1').feature('unisel4').set('input', {'csel1' 'ext7' 'ext9'});
model.geom('geom1').run('unisel4');
model.geom('geom1').create('unisel5', 'UnionSelection');
model.geom('geom1').feature('unisel5').label('Free Gas Domains');
model.geom('geom1').feature('unisel5').set('input', {'difsel1' 'boxsel6'});
model.geom('geom1').run('unisel5');
model.geom('geom1').create('unisel6', 'UnionSelection');
model.geom('geom1').feature('unisel6').label('Anode Free Gas and GDL');
model.geom('geom1').feature('unisel6').set('input', {'boxsel6' 'boxsel15'});
model.geom('geom1').feature.duplicate('unisel7', 'unisel6');
model.geom('geom1').feature('unisel7').label('Cathode Free Gas and GDL');
model.geom('geom1').runPre('unisel7');
model.geom('geom1').feature('unisel7').set('input', {'difsel1' 'boxsel14'});
model.geom('geom1').run('unisel7');
model.geom('geom1').create('unisel8', 'UnionSelection');
model.geom('geom1').feature('unisel8').label('GDLs');
model.geom('geom1').feature('unisel8').set('input', {'boxsel14' 'boxsel15'});
model.geom('geom1').run('unisel8');
model.geom('geom1').create('unisel9', 'UnionSelection');
model.geom('geom1').feature('unisel9').label('Inlets');
model.geom('geom1').feature('unisel9').set('entitydim', 2);
model.geom('geom1').feature('unisel9').set('input', {'boxsel1' 'boxsel7' 'boxsel10'});
model.geom('geom1').run('unisel9');
model.geom('geom1').create('unisel10', 'UnionSelection');
model.geom('geom1').feature('unisel10').label('Outlets');
model.geom('geom1').feature('unisel10').set('entitydim', 2);
model.geom('geom1').feature('unisel10').set('input', {'boxsel2' 'boxsel8' 'boxsel11'});
model.geom('geom1').run('unisel10');
model.geom('geom1').create('adjsel1', 'AdjacentSelection');
model.geom('geom1').feature('adjsel1').label('GDL Boundaries');
model.geom('geom1').feature('adjsel1').set('input', {'unisel8'});
model.geom('geom1').run('adjsel1');
model.geom('geom1').run('adjsel1');
model.geom('geom1').create('adjsel2', 'AdjacentSelection');
model.geom('geom1').feature('adjsel2').label('Electronic Conducting Phase Internal Boundaries');
model.geom('geom1').feature('adjsel2').set('input', {'unisel4' 'unisel8'});
model.geom('geom1').feature('adjsel2').set('exterior', false);
model.geom('geom1').feature('adjsel2').set('interior', true);

model.param.set('n_hc', '0.5');
model.param.descr('n_hc', 'Number of horizontal cells');

model.geom('geom1').run('adjsel2');

model.title([]);

model.description('');

model.label('nonisothermal_pem_fuel_cell_geom_sequence.mph');

model.modelNode.label('Components');

out = model;
