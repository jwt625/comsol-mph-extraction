function out = model
%
% optical_ring_resonator_3d.m
%
% Model exported on May 26 2025, 21:34 by COMSOL 6.2.0.339.

import com.comsol.model.*
import com.comsol.model.util.*

model = ModelUtil.create('Model');

model.modelPath('/Applications/COMSOL62/Multiphysics/applications/Wave_Optics_Module/Couplers_Filters_and_Mirrors');

model.modelNode.create('comp1', true);

model.geom.create('geom1', 3);
model.geom('geom1').model('comp1');

model.mesh.create('mesh1', 'geom1');

model.physics.create('ewbe', 'ElectromagneticWavesBeamEnvelopes', 'geom1');
model.physics('ewbe').model('comp1');

model.study.create('std1');
model.study('std1').create('wave', 'Wavelength');
model.study('std1').feature('wave').set('solnum', 'auto');
model.study('std1').feature('wave').set('notsolnum', 'auto');
model.study('std1').feature('wave').set('outputmap', {});
model.study('std1').feature('wave').set('ngenAUX', '1');
model.study('std1').feature('wave').set('goalngenAUX', '1');
model.study('std1').feature('wave').set('ngenAUX', '1');
model.study('std1').feature('wave').set('goalngenAUX', '1');
model.study('std1').feature('wave').setSolveFor('/physics/ewbe', true);

% To import content from file, use:
% model.param.loadFile('FILENAME');
model.param.set('wl0', '1.55[um]', 'Design wavelength');
model.param.set('w_core', 'wl0/5', 'Core width');
model.param.set('h_core', '1.2*w_core', 'Core height');
model.param.set('w_clad', '10*w_core', 'Cladding width');
model.param.set('r0', '3.1*w_clad', 'Radius of curvature');
model.param.set('dx', '2.3*w_core', 'Separation between waveguides');
model.param.set('lda0', 'wl0', 'Wavelength');
model.param.set('f0', 'c_const/lda0', 'Frequency');
model.param.set('n_core', '2.5', 'Core refractive index');
model.param.set('n_clad', '1.5', 'Cladding refractive index');

model.geom('geom1').lengthUnit([native2unicode(hex2dec({'00' 'b5'}), 'unicode') 'm']);
model.geom.load({'part1'}, 'Wave_Optics_Module/Rectangular_Waveguides/rectangular_waveguide_straight_to_ring_coupler.mph', {'part1'});
model.geom('geom1').create('pi1', 'PartInstance');
model.geom('geom1').feature('pi1').set('selkeepnoncontr', false);
model.geom('geom1').feature('pi1').set('part', 'part1');
model.geom('geom1').feature('pi1').setEntry('inputexpr', 'core_width', 'w_core');
model.geom('geom1').feature('pi1').setEntry('inputexpr', 'core_height', 'h_core');
model.geom('geom1').feature('pi1').setEntry('inputexpr', 'cladding_width', 'w_clad');
model.geom('geom1').feature('pi1').setEntry('inputexpr', 'cladding_height', 'w_clad');
model.geom('geom1').feature('pi1').setEntry('inputexpr', 'element_length', '2*r0+w_clad');
model.geom('geom1').feature('pi1').setEntry('inputexpr', 'coupler_core_separation', 'dx');
model.geom('geom1').feature('pi1').setEntry('inputexpr', 'ring_radius', 'r0');
model.geom('geom1').feature('pi1').set('displ', {'0' '-r0-w_clad/2' '0'});

model.view('view1').set('renderwireframe', true);

model.geom('geom1').feature('pi1').setEntry('selkeepdom', 'pi1_boxsel1', false);
model.geom('geom1').feature('pi1').setEntry('selcontributetodom', 'pi1_boxsel1', 'none');
model.geom('geom1').feature('pi1').setEntry('selkeepdom', 'pi1_boxsel2', false);
model.geom('geom1').feature('pi1').setEntry('selcontributetodom', 'pi1_boxsel2', 'none');
model.geom('geom1').feature('pi1').setEntry('selkeepdom', 'pi1_boxsel3', false);
model.geom('geom1').feature('pi1').setEntry('selcontributetodom', 'pi1_boxsel3', 'none');
model.geom('geom1').feature('pi1').setEntry('selkeepdom', 'pi1_unisel1', true);
model.geom('geom1').feature('pi1').setEntry('selshowdom', 'pi1_unisel1', true);
model.geom('geom1').feature('pi1').setEntry('selcontributetodom', 'pi1_unisel1', 'none');
model.geom('geom1').feature('pi1').setEntry('selkeepdom', 'pi1_difsel1', false);
model.geom('geom1').feature('pi1').setEntry('selcontributetodom', 'pi1_difsel1', 'none');
model.geom('geom1').feature('pi1').setEntry('selkeepdom', 'pi1_unisel2', true);
model.geom('geom1').feature('pi1').setEntry('selshowdom', 'pi1_unisel2', true);
model.geom('geom1').feature('pi1').setEntry('selcontributetodom', 'pi1_unisel2', 'none');
model.geom('geom1').feature('pi1').setEntry('selkeepdom', 'pi1_boxsel5', true);
model.geom('geom1').feature('pi1').setEntry('selshowdom', 'pi1_boxsel5', true);
model.geom('geom1').feature('pi1').setEntry('selcontributetodom', 'pi1_boxsel5', 'none');
model.geom('geom1').feature('pi1').setEntry('selkeepdom', 'pi1_boxsel6', true);
model.geom('geom1').feature('pi1').setEntry('selshowdom', 'pi1_boxsel6', true);
model.geom('geom1').feature('pi1').setEntry('selcontributetodom', 'pi1_boxsel6', 'none');
model.geom('geom1').feature('pi1').setEntry('selkeepdom', 'pi1_boxsel7', true);
model.geom('geom1').feature('pi1').setEntry('selshowdom', 'pi1_boxsel7', true);
model.geom('geom1').feature('pi1').setEntry('selcontributetodom', 'pi1_boxsel7', 'none');
model.geom('geom1').feature('pi1').setEntry('selkeepdom', 'pi1_difsel2', true);
model.geom('geom1').feature('pi1').setEntry('selshowdom', 'pi1_difsel2', true);
model.geom('geom1').feature('pi1').setEntry('selcontributetodom', 'pi1_difsel2', 'none');
model.geom('geom1').feature('pi1').setEntry('selkeepdom', 'pi1_difsel4', true);
model.geom('geom1').feature('pi1').setEntry('selshowdom', 'pi1_difsel4', true);
model.geom('geom1').feature('pi1').setEntry('selcontributetodom', 'pi1_difsel4', 'none');
model.geom('geom1').feature('pi1').setEntry('selkeepbnd', 'pi1_adjsel1', false);
model.geom('geom1').feature('pi1').setEntry('selcontributetobnd', 'pi1_adjsel1', 'none');
model.geom('geom1').feature('pi1').setEntry('selkeepbnd', 'pi1_boxsel8', true);
model.geom('geom1').feature('pi1').setEntry('selshowbnd', 'pi1_boxsel8', true);
model.geom('geom1').feature('pi1').setEntry('selcontributetobnd', 'pi1_boxsel8', 'none');
model.geom('geom1').feature('pi1').setEntry('selkeepbnd', 'pi1_intsel1', false);
model.geom('geom1').feature('pi1').setEntry('selcontributetobnd', 'pi1_intsel1', 'none');
model.geom('geom1').feature('pi1').setEntry('selkeepbnd', 'pi1_intsel2', false);
model.geom('geom1').feature('pi1').setEntry('selcontributetobnd', 'pi1_intsel2', 'none');
model.geom('geom1').feature('pi1').setEntry('selkeepbnd', 'pi1_intsel3', false);
model.geom('geom1').feature('pi1').setEntry('selcontributetobnd', 'pi1_intsel3', 'none');
model.geom('geom1').feature('pi1').setEntry('selkeepbnd', 'pi1_intsel4', false);
model.geom('geom1').feature('pi1').setEntry('selcontributetobnd', 'pi1_intsel4', 'none');
model.geom('geom1').feature('pi1').setEntry('selkeepbnd', 'pi1_unisel3', false);
model.geom('geom1').feature('pi1').setEntry('selcontributetobnd', 'pi1_unisel3', 'none');
model.geom('geom1').feature('pi1').setEntry('selkeepbnd', 'pi1_boxsel9', true);
model.geom('geom1').feature('pi1').setEntry('selshowbnd', 'pi1_boxsel9', true);
model.geom('geom1').feature('pi1').setEntry('selcontributetobnd', 'pi1_boxsel9', 'none');
model.geom('geom1').feature('pi1').setEntry('selkeepbnd', 'pi1_intsel5', false);
model.geom('geom1').feature('pi1').setEntry('selcontributetobnd', 'pi1_intsel5', 'none');
model.geom('geom1').feature('pi1').setEntry('selkeepbnd', 'pi1_intsel6', false);
model.geom('geom1').feature('pi1').setEntry('selcontributetobnd', 'pi1_intsel6', 'none');
model.geom('geom1').feature('pi1').setEntry('selkeepbnd', 'pi1_intsel7', false);
model.geom('geom1').feature('pi1').setEntry('selcontributetobnd', 'pi1_intsel7', 'none');
model.geom('geom1').feature('pi1').setEntry('selkeepbnd', 'pi1_intsel8', false);
model.geom('geom1').feature('pi1').setEntry('selcontributetobnd', 'pi1_intsel8', 'none');
model.geom('geom1').feature('pi1').setEntry('selkeepbnd', 'pi1_unisel4', false);
model.geom('geom1').feature('pi1').setEntry('selcontributetobnd', 'pi1_unisel4', 'none');
model.geom('geom1').feature('pi1').setEntry('selkeepbnd', 'pi1_difsel3', true);
model.geom('geom1').feature('pi1').setEntry('selshowbnd', 'pi1_difsel3', true);
model.geom('geom1').feature('pi1').setEntry('selcontributetobnd', 'pi1_difsel3', 'none');
model.geom('geom1').feature('pi1').setEntry('selkeepbnd', 'pi1_csel1.bnd', true);
model.geom('geom1').feature('pi1').setEntry('selshowbnd', 'pi1_csel1.bnd', true);
model.geom('geom1').feature('pi1').setEntry('selcontributetobnd', 'pi1_csel1.bnd', 'none');
model.geom('geom1').feature('pi1').setEntry('selkeepbnd', 'pi1_csel2.bnd', true);
model.geom('geom1').feature('pi1').setEntry('selshowbnd', 'pi1_csel2.bnd', true);
model.geom('geom1').feature('pi1').setEntry('selcontributetobnd', 'pi1_csel2.bnd', 'none');
model.geom('geom1').runPre('fin');

model.selection.create('adj1', 'Adjacent');
model.selection('adj1').model('comp1');

model.geom('geom1').run;

model.selection('adj1').label('Core Boundaries');
model.selection('adj1').set('input', {'geom1_pi1_unisel1'});
model.selection('adj1').set('interior', true);
model.selection.create('int1', 'Intersection');
model.selection('int1').model('comp1');
model.selection('int1').label('Triangular Mesh Core Boundaries');
model.selection('int1').set('entitydim', 2);
model.selection('int1').set('input', {'adj1' 'geom1_pi1_csel1_bnd'});
model.selection.create('adj2', 'Adjacent');
model.selection('adj2').model('comp1');
model.selection('adj2').label('Cladding Boundaries');
model.selection('adj2').set('input', {'geom1_pi1_unisel2'});

model.material.create('mat1', 'Common', 'comp1');
model.material('mat1').label('Cladding');
model.material('mat1').propertyGroup.create('RefractiveIndex', 'Refractive_index');
model.material('mat1').propertyGroup('RefractiveIndex').set('n', {'n_clad'});
model.material.create('mat2', 'Common', 'comp1');
model.material('mat2').label('Core');
model.material('mat2').selection.named('geom1_pi1_unisel1');
model.material('mat2').propertyGroup.create('RefractiveIndex', 'Refractive_index');
model.material('mat2').propertyGroup('RefractiveIndex').set('n', {'n_core'});

model.variable.create('var1');
model.variable('var1').model('comp1');
model.variable('var1').selection.geom('geom1', 3);
model.variable('var1').selection.named('geom1_pi1_boxsel5');
model.variable('var1').set('phi', 'ewbe.beta_1*y');
model.variable('var1').descr('phi', '');
model.variable.duplicate('var2', 'var1');
model.variable('var2').selection.named('geom1_pi1_boxsel6');
model.variable('var2').set('phi', 'ewbe.beta_1*r0*atan2(y,-(x-r0-dx))');
model.variable('var2').descr('phi', '');
model.variable.duplicate('var3', 'var2');
model.variable('var3').selection.named('geom1_pi1_difsel2');
model.variable('var3').set('phi', 'ewbe.beta_1*r0*atan2(-y,(x-r0-dx))');
model.variable('var3').descr('phi', '');

model.physics('ewbe').prop('WaveVector').set('dirCount', 'UniDirectionality');
model.physics('ewbe').prop('WaveVector').set('PhaseSpec', 'UserDefined');
model.physics('ewbe').prop('WaveVector').set('phase1', 'phi');
model.physics('ewbe').prop('ShapeProperty').set('shapeorder', 3);
model.physics('ewbe').create('port1', 'Port', 2);
model.physics('ewbe').feature('port1').selection.named('geom1_pi1_boxsel8');
model.physics('ewbe').feature('port1').set('PortType', 'Numeric');
model.physics('ewbe').create('port2', 'Port', 2);
model.physics('ewbe').feature('port2').selection.named('geom1_pi1_boxsel9');
model.physics('ewbe').feature('port2').set('PortType', 'Numeric');
model.physics('ewbe').create('sctr1', 'Scattering', 2);
model.physics('ewbe').feature('sctr1').selection.named('geom1_pi1_difsel3');
model.physics('ewbe').create('fcont1', 'FieldContinuity', 2);
model.physics('ewbe').feature('fcont1').selection.named('geom1_pi1_csel2_bnd');

model.mesh('mesh1').create('ftri1', 'FreeTri');
model.mesh('mesh1').feature('ftri1').selection.named('geom1_pi1_csel1_bnd');
model.mesh('mesh1').feature('size').set('custom', true);
model.mesh('mesh1').feature('size').set('hmax', 'w_clad/5');
model.mesh('mesh1').feature('size').set('hgrad', 2);
model.mesh('mesh1').feature('ftri1').create('size1', 'Size');
model.mesh('mesh1').feature('ftri1').feature('size1').selection.named('int1');
model.mesh('mesh1').feature('ftri1').feature('size1').set('custom', true);
model.mesh('mesh1').feature('ftri1').feature('size1').set('hmaxactive', true);
model.mesh('mesh1').feature('ftri1').feature('size1').set('hmax', 'w_core/2');
model.mesh('mesh1').create('swe1', 'Sweep');
model.mesh('mesh1').feature('swe1').selection.geom('geom1', 3);
model.mesh('mesh1').feature('swe1').selection.named('geom1_pi1_boxsel7');
model.mesh('mesh1').feature('swe1').create('size1', 'Size');
model.mesh('mesh1').feature('swe1').feature('size1').set('custom', true);
model.mesh('mesh1').feature('swe1').feature('size1').set('hmaxactive', true);
model.mesh('mesh1').feature('swe1').feature('size1').set('hmax', 'wl0/2');
model.mesh('mesh1').create('cpd1', 'CopyDomain');
model.mesh('mesh1').feature('cpd1').selection('source').geom(3);
model.mesh('mesh1').feature('cpd1').selection('destination').geom(3);
model.mesh('mesh1').feature('cpd1').selection('source').named('geom1_pi1_boxsel7');
model.mesh('mesh1').feature('cpd1').selection('destination').named('geom1_pi1_difsel4');
model.mesh('mesh1').run;

model.study('std1').create('bma', 'BoundaryModeAnalysis');
model.study('std1').feature('bma').set('modeFreq', 'f0');
model.study('std1').feature('bma').set('shift', 'n_core');
model.study('std1').feature.duplicate('bma1', 'bma');
model.study('std1').feature('bma1').set('PortName', '2');
model.study('std1').feature('wave').set('plist', 'lda0');
model.study('std1').feature.move('wave', 1);
model.study('std1').feature.move('wave', 2);
model.study('std1').create('param', 'Parametric');
model.study('std1').feature('param').setIndex('pname', 'wl0', 0);
model.study('std1').feature('param').setIndex('plistarr', '', 0);
model.study('std1').feature('param').setIndex('punit', 'm', 0);
model.study('std1').feature('param').setIndex('pname', 'wl0', 0);
model.study('std1').feature('param').setIndex('plistarr', '', 0);
model.study('std1').feature('param').setIndex('punit', 'm', 0);
model.study('std1').feature('param').setIndex('pname', 'lda0', 0);
model.study('std1').feature('param').setIndex('plistarr', 'range(1.55[um],0.002[um],1.57[um])', 0);
model.study('std1').feature('param').setIndex('punit', 'um', 0);

model.sol.create('sol1');
model.sol('sol1').study('std1');
model.sol('sol1').create('st1', 'StudyStep');
model.sol('sol1').feature('st1').set('study', 'std1');
model.sol('sol1').feature('st1').set('studystep', 'bma');
model.sol('sol1').create('v1', 'Variables');
model.sol('sol1').feature('v1').set('control', 'bma');
model.sol('sol1').create('e1', 'Eigenvalue');
model.sol('sol1').feature('e1').set('neigs', 1);
model.sol('sol1').feature('e1').set('shift', '1');
model.sol('sol1').feature('e1').set('eigref', 'n_core');
model.sol('sol1').feature('e1').set('control', 'bma');
model.sol('sol1').feature('e1').feature('aDef').set('complexfun', true);
model.sol('sol1').feature('e1').feature('aDef').set('cachepattern', false);
model.sol('sol1').feature('e1').feature('aDef').set('matherr', true);
model.sol('sol1').feature('e1').feature('aDef').set('blocksizeactive', false);
model.sol('sol1').feature('e1').feature('aDef').set('nullfun', 'auto');
model.sol('sol1').create('su1', 'StoreSolution');
model.sol('sol1').create('st2', 'StudyStep');
model.sol('sol1').feature('st2').set('study', 'std1');
model.sol('sol1').feature('st2').set('studystep', 'bma1');
model.sol('sol1').create('v2', 'Variables');
model.sol('sol1').feature('v2').set('initmethod', 'sol');
model.sol('sol1').feature('v2').set('initsol', 'sol1');
model.sol('sol1').feature('v2').set('notsolmethod', 'sol');
model.sol('sol1').feature('v2').set('notsol', 'sol1');
model.sol('sol1').feature('v2').set('control', 'bma1');
model.sol('sol1').create('e2', 'Eigenvalue');
model.sol('sol1').feature('e2').set('neigs', 1);
model.sol('sol1').feature('e2').set('shift', '1');
model.sol('sol1').feature('e2').set('eigref', 'n_core');
model.sol('sol1').feature('e2').set('control', 'bma1');
model.sol('sol1').feature('e2').set('linpmethod', 'sol');
model.sol('sol1').feature('e2').set('linpsol', 'sol1');
model.sol('sol1').feature('e2').set('control', 'bma1');
model.sol('sol1').feature('e2').feature('aDef').set('complexfun', true);
model.sol('sol1').feature('e2').feature('aDef').set('cachepattern', false);
model.sol('sol1').feature('e2').feature('aDef').set('matherr', true);
model.sol('sol1').feature('e2').feature('aDef').set('blocksizeactive', false);
model.sol('sol1').feature('e2').feature('aDef').set('nullfun', 'auto');
model.sol('sol1').create('su2', 'StoreSolution');
model.sol('sol1').create('st3', 'StudyStep');
model.sol('sol1').feature('st3').set('study', 'std1');
model.sol('sol1').feature('st3').set('studystep', 'wave');
model.sol('sol1').create('v3', 'Variables');
model.sol('sol1').feature('v3').set('initmethod', 'sol');
model.sol('sol1').feature('v3').set('initsol', 'sol1');
model.sol('sol1').feature('v3').set('notsolmethod', 'sol');
model.sol('sol1').feature('v3').set('notsol', 'sol1');
model.sol('sol1').feature('v3').set('control', 'wave');
model.sol('sol1').create('s1', 'Stationary');
model.sol('sol1').feature('s1').create('p1', 'Parametric');
model.sol('sol1').feature('s1').feature.remove('pDef');
model.sol('sol1').feature('s1').feature('p1').set('pname', {'lambda0'});
model.sol('sol1').feature('s1').feature('p1').set('plistarr', {'lda0'});
model.sol('sol1').feature('s1').feature('p1').set('punit', {[native2unicode(hex2dec({'00' 'b5'}), 'unicode') 'm']});
model.sol('sol1').feature('s1').feature('p1').set('pcontinuationmode', 'no');
model.sol('sol1').feature('s1').feature('p1').set('preusesol', 'no');
model.sol('sol1').feature('s1').feature('p1').set('pdistrib', 'off');
model.sol('sol1').feature('s1').feature('p1').set('plot', 'off');
model.sol('sol1').feature('s1').feature('p1').set('plotgroup', 'Default');
model.sol('sol1').feature('s1').feature('p1').set('probesel', 'all');
model.sol('sol1').feature('s1').feature('p1').set('probes', {});
model.sol('sol1').feature('s1').feature('p1').set('control', 'wave');
model.sol('sol1').feature('s1').set('control', 'wave');
model.sol('sol1').feature('s1').feature('aDef').set('complexfun', true);
model.sol('sol1').feature('s1').feature('aDef').set('cachepattern', false);
model.sol('sol1').feature('s1').feature('aDef').set('matherr', true);
model.sol('sol1').feature('s1').feature('aDef').set('blocksizeactive', false);
model.sol('sol1').feature('s1').feature('aDef').set('nullfun', 'auto');
model.sol('sol1').feature('s1').create('fc1', 'FullyCoupled');
model.sol('sol1').feature('s1').feature('fc1').set('linsolver', 'dDef');
model.sol('sol1').feature('s1').feature.remove('fcDef');
model.sol('sol1').feature('v3').set('notsolnum', 'auto');
model.sol('sol1').feature('v3').set('notsolvertype', 'solnum');
model.sol('sol1').feature('v3').set('solnum', 'auto');
model.sol('sol1').feature('v3').set('solvertype', 'solnum');
model.sol('sol1').feature('e2').set('linpsolnum', 'auto');
model.sol('sol1').feature('e2').set('linpsolvertype', 'solnum');
model.sol('sol1').feature('v2').set('notsolnum', 'auto');
model.sol('sol1').feature('v2').set('notsolvertype', 'solnum');
model.sol('sol1').feature('v2').set('solnum', 'auto');
model.sol('sol1').feature('v2').set('solvertype', 'solnum');
model.sol('sol1').attach('std1');

model.batch.create('p1', 'Parametric');
model.batch('p1').study('std1');
model.batch('p1').create('so1', 'Solutionseq');
model.batch('p1').feature('so1').set('seq', 'sol1');
model.batch('p1').feature('so1').set('store', 'on');
model.batch('p1').feature('so1').set('clear', 'on');
model.batch('p1').feature('so1').set('psol', 'none');
model.batch('p1').set('pname', {'lda0'});
model.batch('p1').set('plistarr', {'range(1.55[um],0.002[um],1.57[um])'});
model.batch('p1').set('sweeptype', 'sparse');
model.batch('p1').set('probesel', 'all');
model.batch('p1').set('probes', {});
model.batch('p1').set('plot', 'off');
model.batch('p1').set('err', 'on');
model.batch('p1').attach('std1');
model.batch('p1').set('control', 'param');

model.sol.create('sol4');
model.sol('sol4').study('std1');
model.sol('sol4').label('Parametric Solutions 1');

model.batch('p1').feature('so1').set('psol', 'sol4');
model.batch('p1').run('compute');

model.result.create('pg1', 'PlotGroup3D');
model.result('pg1').label('Electric Field (ewbe)');
model.result('pg1').set('data', 'dset4');
model.result('pg1').setIndex('looplevel', 1, 0);
model.result('pg1').setIndex('looplevel', 11, 1);
model.result('pg1').set('data', 'dset4');
model.result('pg1').setIndex('looplevel', 1, 0);
model.result('pg1').setIndex('looplevel', 11, 1);
model.result('pg1').set('defaultPlotID', 'ElectromagneticWavesBeamEnvelopes/phys1/pdef1/pcond1/pg1');
model.result('pg1').feature.create('mslc1', 'Multislice');
model.result('pg1').feature('mslc1').label('Electric Field');
model.result('pg1').feature('mslc1').set('showsolutionparams', 'on');
model.result('pg1').feature('mslc1').set('smooth', 'internal');
model.result('pg1').feature('mslc1').set('showsolutionparams', 'on');
model.result('pg1').feature('mslc1').set('data', 'parent');
model.result.create('pg2', 'PlotGroup1D');
model.result('pg2').set('data', 'dset4');
model.result('pg2').create('glob1', 'Global');
model.result('pg2').feature('glob1').set('unit', {'' '' '' ''});
model.result('pg2').feature('glob1').set('expr', {'ewbe.Rport_1' 'ewbe.Tport_2' 'ewbe.RTtotal' 'ewbe.Atotal'});
model.result('pg2').feature('glob1').set('descr', {'Reflectance, port 1' 'Transmittance, port 2' 'Total reflectance and transmittance' 'Absorptance'});
model.result('pg2').label('Reflectance, Transmittance, and Absorptance (ewbe)');
model.result('pg2').feature('glob1').set('titletype', 'none');
model.result('pg2').feature('glob1').set('xdata', 'expr');
model.result('pg2').set('ylabelactive', true);
model.result('pg2').set('ylabel', 'Reflectance, transmittance, and absorptance (1)');
model.result('pg2').feature('glob1').set('xdataexpr', 'lda0');
model.result('pg2').feature('glob1').set('xdataunit', 'um');
model.result('pg2').feature('glob1').set('markerpos', 'datapoints');
model.result('pg2').feature('glob1').set('xdatasolnumtype', 'all');
model.result.create('pg3', 'PlotGroup3D');
model.result('pg3').label('Electric Mode Field, Port 1 (ewbe)');
model.result('pg3').set('showlegendsmaxmin', true);
model.result('pg3').set('data', 'dset4');
model.result('pg3').create('surf1', 'Surface');
model.result('pg3').feature('surf1').set('expr', 'root.comp1.ewbe.normEbm_1');
model.result('pg3').feature('surf1').set('colortable', 'RainbowLight');
model.result.create('pg4', 'PlotGroup3D');
model.result('pg4').label('Electric Mode Field, Port 2 (ewbe)');
model.result('pg4').set('showlegendsmaxmin', true);
model.result('pg4').set('data', 'dset4');
model.result('pg4').create('surf1', 'Surface');
model.result('pg4').feature('surf1').set('expr', 'root.comp1.ewbe.normEbm_2');
model.result('pg4').feature('surf1').set('colortable', 'RainbowLight');
model.result('pg1').run;
model.result('pg1').set('looplevel', [1 6]);
model.result('pg1').set('edgecolor', 'gray');
model.result('pg1').set('showlegends', false);

model.view('view1').set('showgrid', false);
model.view('view1').set('showaxisorientation', false);

model.result('pg1').run;
model.result('pg1').feature('mslc1').set('expr', 'ewbe.Ez');
model.result('pg1').feature('mslc1').set('xnumber', '0');
model.result('pg1').feature('mslc1').set('ynumber', '0');
model.result('pg1').feature('mslc1').set('colortable', 'Dipole');
model.result('pg1').feature('mslc1').create('def1', 'Deform');
model.result('pg1').run;
model.result('pg1').feature('mslc1').feature('def1').set('expr', {'' '' 'ewbe.Ez'});
model.result('pg1').feature('mslc1').feature('def1').set('scaleactive', true);
model.result('pg1').feature('mslc1').feature('def1').set('scale', '5E-8');
model.result('pg1').run;
model.result('pg1').feature('mslc1').create('tran1', 'Transparency');
model.result('pg1').run;
model.result('pg1').feature('mslc1').feature('tran1').set('transparency', 0.6);
model.result('pg1').run;
model.result('pg1').create('surf1', 'Surface');
model.result('pg1').feature('surf1').set('expr', 'ewbe.Ez');
model.result('pg1').feature('surf1').set('rangecoloractive', true);
model.result('pg1').feature('surf1').set('rangecolormin', '-2.5E7');
model.result('pg1').feature('surf1').set('rangecolormax', '2.5E7');
model.result('pg1').feature('surf1').set('colortable', 'ThermalWave');
model.result('pg1').feature('surf1').create('sel1', 'Selection');
model.result('pg1').feature('surf1').feature('sel1').selection.named('adj1');
model.result('pg1').run;
model.result('pg1').create('surf2', 'Surface');
model.result('pg1').feature('surf2').set('expr', 'ewbe.Ez');
model.result('pg1').feature('surf2').set('colortable', 'Cyclic');
model.result('pg1').feature('surf2').set('rangecoloractive', true);
model.result('pg1').feature('surf2').set('rangecolormin', -5000);
model.result('pg1').feature('surf2').set('rangecolormax', 5000);
model.result('pg1').feature('surf2').create('sel1', 'Selection');
model.result('pg1').feature('surf2').feature('sel1').selection.named('adj2');
model.result('pg1').run;
model.result('pg1').feature('surf2').create('tran1', 'Transparency');
model.result('pg1').run;
model.result('pg1').feature('surf2').feature('tran1').set('transparency', 0.97);
model.result('pg1').run;
model.result('pg1').feature('mslc1').set('resolution', 'extrafine');
model.result('pg1').run;
model.result('pg2').run;
model.result('pg2').label('Transmittance and Loss (ewbe)');
model.result('pg2').set('ylabel', 'Transmittance and loss (1)');
model.result('pg2').run;
model.result('pg2').feature('glob1').remove('unit', [0 2]);
model.result('pg2').feature('glob1').remove('descr', [0 2]);
model.result('pg2').feature('glob1').remove('expr', [0 2]);
model.result('pg2').feature('glob1').set('legendmethod', 'manual');
model.result('pg2').feature('glob1').setIndex('legends', 'Transmittance', 0);
model.result('pg2').feature('glob1').setIndex('legends', 'Loss', 1);
model.result('pg2').run;
model.result('pg3').run;
model.result('pg3').create('arws1', 'ArrowSurface');
model.result('pg3').feature('arws1').set('expr', {'ewbe.tEmodex_1' 'ewbe.tEmodey_1' 'ewbe.tEmodez_1'});
model.result('pg3').feature('arws1').set('descr', 'Port tangential electric mode field');
model.result('pg3').run;
model.result('pg4').run;
model.result('pg4').create('arws1', 'ArrowSurface');
model.result('pg4').feature('arws1').set('expr', {'ewbe.tEmodex_2' 'ewbe.tEmodey_2' 'ewbe.tEmodez_2'});
model.result('pg4').feature('arws1').set('descr', 'Port tangential electric mode field');
model.result('pg4').run;

model.title('Optical Ring Resonator Notch Filter 3D');

model.description('This example calculates the spectral properties of a 3D optical ring resonator. The model demonstrates how to use parts from the Wave Optics Parts Library and how to set up the Field Continuity boundary condition at boundaries, where there is a jump in the predefined phase approximation.');

model.mesh.clearMeshes;

model.sol('sol1').clearSolutionData;
model.sol('sol2').clearSolutionData;
model.sol('sol3').clearSolutionData;
model.sol('sol4').clearSolutionData;
model.sol('sol5').clearSolutionData;
model.sol('sol6').clearSolutionData;
model.sol('sol7').clearSolutionData;
model.sol('sol8').clearSolutionData;
model.sol('sol9').clearSolutionData;
model.sol('sol10').clearSolutionData;
model.sol('sol11').clearSolutionData;
model.sol('sol12').clearSolutionData;
model.sol('sol13').clearSolutionData;
model.sol('sol14').clearSolutionData;
model.sol('sol15').clearSolutionData;

model.label('optical_ring_resonator_3d.mph');

model.modelNode.label('Components');

out = model;
