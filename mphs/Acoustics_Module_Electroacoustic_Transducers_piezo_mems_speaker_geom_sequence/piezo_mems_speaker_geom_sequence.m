function out = model
%
% piezo_mems_speaker_geom_sequence.m
%
% Model exported on May 26 2025, 21:25 by COMSOL 6.2.0.339.

import com.comsol.model.*
import com.comsol.model.util.*

model = ModelUtil.create('Model');

model.modelPath('/Applications/COMSOL62/Multiphysics/applications/Acoustics_Module/Electroacoustic_Transducers');

model.modelNode.create('comp1', true);

model.geom.create('geom1', 3);
model.geom('geom1').model('comp1');

model.mesh.create('mesh1', 'geom1');

model.geom('geom1').lengthUnit([native2unicode(hex2dec({'00' 'b5'}), 'unicode') 'm']);

model.param.set('l_speaker', '4[mm]');
model.param.descr('l_speaker', 'Side of the speaker');
model.param.set('th_si', '15[um]');
model.param.descr('th_si', 'Thickness of the silicon layer');
model.param.set('th_pzt', '2[um]');
model.param.descr('th_pzt', 'Thickness of the PZT layer');
model.param.set('air_gap', '9[um]');
model.param.descr('air_gap', 'Air gap between the actuators');
model.param.set('d_speaker', '1.5[mm]');
model.param.descr('d_speaker', 'Back cavity depth');

model.view('view1').set('showgrid', false);

model.geom('geom1').create('wp1', 'WorkPlane');
model.geom('geom1').feature('wp1').set('unite', true);
model.geom('geom1').feature('wp1').geom.create('sq1', 'Square');
model.geom('geom1').feature('wp1').geom.feature('sq1').set('size', 'l_speaker/2');
model.geom('geom1').feature('wp1').geom.run('sq1');
model.geom('geom1').feature('wp1').geom.create('r1', 'Rectangle');
model.geom('geom1').feature('wp1').geom.feature('r1').set('size', {'sqrt(2)/2*l_speaker-air_gap' '1'});
model.geom('geom1').feature('wp1').geom.feature('r1').setIndex('size', '12*air_gap', 1);
model.geom('geom1').feature('wp1').geom.feature('r1').set('base', 'center');
model.geom('geom1').feature('wp1').geom.feature('r1').set('pos', {'l_speaker/4' '0'});
model.geom('geom1').feature('wp1').geom.feature('r1').setIndex('pos', 'l_speaker/4', 1);
model.geom('geom1').feature('wp1').geom.feature('r1').set('rot', 45);
model.geom('geom1').feature('wp1').geom.feature('r1').setIndex('layername', 'Layer 1', 0);
model.geom('geom1').feature('wp1').geom.feature('r1').setIndex('layer', '5.5*air_gap', 0);
model.geom('geom1').feature('wp1').geom.feature('r1').set('layertop', true);
model.geom('geom1').feature('wp1').geom.run('r1');
model.geom('geom1').feature('wp1').geom.create('r2', 'Rectangle');
model.geom('geom1').feature('wp1').geom.feature('r2').set('size', {'sqrt(2)/2*l_speaker-16*air_gap' '1'});
model.geom('geom1').feature('wp1').geom.feature('r2').setIndex('size', '12*air_gap', 1);
model.geom('geom1').feature('wp1').geom.feature('r2').set('base', 'center');
model.geom('geom1').feature('wp1').geom.feature('r2').set('pos', {'l_speaker/4' '0'});
model.geom('geom1').feature('wp1').geom.feature('r2').setIndex('pos', 'l_speaker/4', 1);
model.geom('geom1').feature('wp1').geom.feature('r2').set('rot', 45);
model.geom('geom1').feature('wp1').geom.run('r2');
model.geom('geom1').feature('wp1').geom.create('uni1', 'Union');
model.geom('geom1').feature('wp1').geom.feature('uni1').selection('input').set({'r1' 'r2' 'sq1'});
model.geom('geom1').feature('wp1').geom.run('uni1');
model.geom('geom1').feature('wp1').geom.create('del1', 'Delete');
model.geom('geom1').feature('wp1').geom.feature('del1').selection('input').init(2);
model.geom('geom1').feature('wp1').geom.feature('del1').selection('input').set('uni1', [1 6 13 17]);
model.geom('geom1').feature('wp1').geom.run('del1');
model.geom('geom1').run('wp1');
model.geom('geom1').feature.create('ext1', 'Extrude');
model.geom('geom1').feature('ext1').set('workplane', 'wp1');
model.geom('geom1').feature('ext1').selection('input').set({'wp1'});
model.geom('geom1').feature('ext1').setIndex('distance', 'th_si', 0);
model.geom('geom1').feature('ext1').setIndex('distance', 'th_si+th_pzt', 1);
model.geom('geom1').feature('ext1').set('displ', {'0' '0'; '0' '0'});
model.geom('geom1').feature('ext1').set('scale', {'1' '1'; '1' '1'});
model.geom('geom1').feature('ext1').set('twist', {'0' '0'});
model.geom('geom1').feature('ext1').set('reverse', true);
model.geom('geom1').run('ext1');
model.geom('geom1').create('cyl1', 'Cylinder');
model.geom('geom1').feature('cyl1').set('r', '6*air_gap');
model.geom('geom1').feature('cyl1').set('h', 'sqrt(2)/2*l_speaker');
model.geom('geom1').feature('cyl1').set('axistype', 'cartesian');
model.geom('geom1').feature('cyl1').set('ax3', [1 1 0]);
model.geom('geom1').feature('cyl1').setIndex('layername', 'Layer 1', 0);
model.geom('geom1').feature('cyl1').setIndex('layer', '8*air_gap', 0);
model.geom('geom1').feature('cyl1').set('layerside', false);
model.geom('geom1').feature('cyl1').set('layerbottom', true);
model.geom('geom1').feature('cyl1').set('layertop', true);
model.geom('geom1').run('cyl1');
model.geom('geom1').create('par1', 'Partition');
model.geom('geom1').feature('par1').selection('input').set({'cyl1'});
model.geom('geom1').feature('par1').set('partitionwith', 'workplane');
model.geom('geom1').run('par1');
model.geom('geom1').create('mov1', 'Move');
model.geom('geom1').feature('mov1').selection('input').set({'par1'});
model.geom('geom1').feature('mov1').set('displz', '-th_pzt-th_si');
model.geom('geom1').feature('mov1').set('keep', true);
model.geom('geom1').run('mov1');
model.geom('geom1').create('del1', 'Delete');
model.geom('geom1').feature('del1').selection('input').init(3);
model.geom('geom1').feature('del1').selection('input').set('mov1', [2 4 6]);
model.geom('geom1').feature('del1').selection('input').set('par1', [1 3 5]);
model.geom('geom1').run('del1');
model.geom('geom1').create('cyl2', 'Cylinder');
model.geom('geom1').feature('cyl2').set('r', '1.2*l_speaker');
model.geom('geom1').feature('cyl2').set('h', '1.2*l_speaker');
model.geom('geom1').feature('cyl2').set('pos', {'0' '0' '-0.6*l_speaker'});
model.geom('geom1').feature('cyl2').setIndex('layername', 'Layer 1', 0);
model.geom('geom1').feature('cyl2').setIndex('layer', 'l_speaker/4', 0);
model.geom('geom1').feature('cyl2').set('layerbottom', true);
model.geom('geom1').feature('cyl2').set('layertop', true);
model.geom('geom1').run('cyl2');

model.view('view1').set('renderwireframe', true);

model.geom('geom1').create('par2', 'Partition');
model.geom('geom1').feature('par2').selection('input').set({'cyl2'});
model.geom('geom1').feature('par2').set('partitionwith', 'workplane');
model.geom('geom1').run('par2');
model.geom('geom1').create('del2', 'Delete');
model.geom('geom1').feature('del2').selection('input').init(3);
model.geom('geom1').feature('del2').selection('input').set('par2', [1 2 3 4 9 10 13 14 17 18]);
model.geom('geom1').run('del2');
model.geom('geom1').create('blk1', 'Block');
model.geom('geom1').feature('blk1').set('size', {'l_speaker/2' '1' '1'});
model.geom('geom1').feature('blk1').setIndex('size', 'l_speaker/2', 1);
model.geom('geom1').feature('blk1').setIndex('size', 'd_speaker', 2);
model.geom('geom1').feature('blk1').set('pos', {'0' '0' '-th_si-th_pzt-d_speaker'});
model.geom('geom1').run('blk1');
model.geom('geom1').create('wp2', 'WorkPlane');
model.geom('geom1').feature('wp2').set('unite', true);
model.geom('geom1').feature('wp2').set('quickplane', 'yz');
model.geom('geom1').run('wp2');
model.geom('geom1').create('wp3', 'WorkPlane');
model.geom('geom1').feature('wp3').set('unite', true);
model.geom('geom1').feature('wp3').set('quickplane', 'zx');
model.geom('geom1').run('wp3');
model.geom('geom1').create('uni1', 'Union');
model.geom('geom1').feature('uni1').selection('input').set({'blk1' 'del1' 'del2' 'ext1'});
model.geom('geom1').run('uni1');
model.geom('geom1').create('par3', 'Partition');
model.geom('geom1').feature('par3').selection('input').set({'uni1'});
model.geom('geom1').feature('par3').set('partitionwith', 'workplane');
model.geom('geom1').feature('par3').set('workplane', 'wp2');
model.geom('geom1').run('par3');
model.geom('geom1').create('par4', 'Partition');
model.geom('geom1').feature('par4').selection('input').set({'par3'});
model.geom('geom1').feature('par4').set('partitionwith', 'workplane');
model.geom('geom1').run('par4');
model.geom('geom1').create('del3', 'Delete');
model.geom('geom1').feature('del3').selection('input').init(3);
model.geom('geom1').feature('del3').selection('input').set('par4', [1 2 3 4 5 6 7 8 9 10 11 12 13 14 17 21 48 55]);
model.geom('geom1').run('del3');
model.geom('geom1').create('cylsel1', 'CylinderSelection');
model.geom('geom1').feature('cylsel1').label('Thermoviscous Domain 1');
model.geom('geom1').feature('cylsel1').set('r', '6*air_gap');
model.geom('geom1').feature('cylsel1').set('axistype', 'cartesian');
model.geom('geom1').feature('cylsel1').set('ax3', [1 1 0]);
model.geom('geom1').feature('cylsel1').set('condition', 'allvertices');
model.geom('geom1').feature.duplicate('cylsel2', 'cylsel1');
model.geom('geom1').feature('cylsel2').label('Thermoviscous Domain 2');
model.geom('geom1').feature('cylsel2').set('pos', {'0' '0' '-th_si-th_pzt'});
model.geom('geom1').run('cylsel2');
model.geom('geom1').create('unisel1', 'UnionSelection');
model.geom('geom1').feature('unisel1').label('Thermoviscous Domains');
model.geom('geom1').feature('unisel1').set('input', {'cylsel1' 'cylsel2'});
model.geom('geom1').feature('unisel1').set('color', '5');
model.geom('geom1').run('unisel1');
model.geom('geom1').create('boxsel1', 'BoxSelection');
model.geom('geom1').feature('boxsel1').label('Silicon Layer With Air');
model.geom('geom1').feature('boxsel1').set('zmin', '-th_si');
model.geom('geom1').feature('boxsel1').set('zmax', 0);
model.geom('geom1').feature('boxsel1').set('condition', 'inside');
model.geom('geom1').run('boxsel1');
model.geom('geom1').create('boxsel2', 'BoxSelection');
model.geom('geom1').feature('boxsel2').label('PZT Layer With Air');
model.geom('geom1').feature('boxsel2').set('zmin', '-th_si-th_pzt');
model.geom('geom1').feature('boxsel2').set('zmax', '-th_si');
model.geom('geom1').feature('boxsel2').set('condition', 'inside');
model.geom('geom1').run('boxsel2');
model.geom('geom1').create('difsel1', 'DifferenceSelection');
model.geom('geom1').feature('difsel1').label('Silicon Domains');
model.geom('geom1').feature('difsel1').set('add', {'boxsel1'});
model.geom('geom1').feature('difsel1').set('subtract', {'unisel1'});
model.geom('geom1').feature('difsel1').set('color', '8');
model.geom('geom1').run('difsel1');
model.geom('geom1').create('difsel2', 'DifferenceSelection');
model.geom('geom1').feature('difsel2').label('PZT Domains');
model.geom('geom1').feature('difsel2').set('add', {'boxsel2'});
model.geom('geom1').feature('difsel2').set('subtract', {'unisel1'});
model.geom('geom1').feature('difsel2').set('color', '12');
model.geom('geom1').run('difsel2');
model.geom('geom1').create('unisel2', 'UnionSelection');
model.geom('geom1').feature('unisel2').label('Structural Domains');
model.geom('geom1').feature('unisel2').set('input', {'difsel1' 'difsel2'});
model.geom('geom1').run('unisel2');
model.geom('geom1').create('ballsel1', 'BallSelection');
model.geom('geom1').feature('ballsel1').label('All Domains');
model.geom('geom1').feature('ballsel1').set('r', '2*l_speaker');
model.geom('geom1').run('ballsel1');
model.geom('geom1').create('cylsel3', 'CylinderSelection');
model.geom('geom1').feature('cylsel3').label('Inner Domains');
model.geom('geom1').feature('cylsel3').set('r', '0.8*l_speaker');
model.geom('geom1').feature('cylsel3').set('top', '0.3*l_speaker');
model.geom('geom1').run('cylsel3');
model.geom('geom1').create('difsel3', 'DifferenceSelection');
model.geom('geom1').feature('difsel3').label('PML Domains');
model.geom('geom1').feature('difsel3').set('add', {'ballsel1'});
model.geom('geom1').feature('difsel3').set('subtract', {'cylsel3'});
model.geom('geom1').run('difsel3');
model.geom('geom1').run('difsel3');
model.geom('geom1').create('difsel4', 'DifferenceSelection');
model.geom('geom1').feature('difsel4').label('Pressure Acoustics Domains');
model.geom('geom1').feature('difsel4').set('add', {'ballsel1'});
model.geom('geom1').feature('difsel4').set('subtract', {'unisel1' 'unisel2'});
model.geom('geom1').feature('difsel4').set('color', '10');
model.geom('geom1').run('difsel4');
model.geom('geom1').create('unisel3', 'UnionSelection');
model.geom('geom1').feature('unisel3').label('Electrostatics Domains');
model.geom('geom1').feature('unisel3').set('input', {'unisel1' 'unisel2'});
model.geom('geom1').run('unisel3');
model.geom('geom1').create('unisel4', 'UnionSelection');
model.geom('geom1').feature('unisel4').label('Air Domains');
model.geom('geom1').feature('unisel4').set('input', {'unisel1' 'difsel4'});
model.geom('geom1').run('unisel4');
model.geom('geom1').create('boxsel3', 'BoxSelection');
model.geom('geom1').feature('boxsel3').label('All Boundaries');
model.geom('geom1').feature('boxsel3').set('entitydim', 2);
model.geom('geom1').run('boxsel3');
model.geom('geom1').create('boxsel4', 'BoxSelection');
model.geom('geom1').feature('boxsel4').label('Nonsymmetric Boundaries');
model.geom('geom1').feature('boxsel4').set('entitydim', 2);
model.geom('geom1').feature('boxsel4').set('xmin', 0.01);
model.geom('geom1').feature('boxsel4').set('ymin', 0.01);
model.geom('geom1').run('boxsel4');
model.geom('geom1').create('difsel5', 'DifferenceSelection');
model.geom('geom1').feature('difsel5').label('Symmetric Boundaries');
model.geom('geom1').feature('difsel5').set('entitydim', 2);
model.geom('geom1').feature('difsel5').set('add', {'boxsel3'});
model.geom('geom1').feature('difsel5').set('subtract', {'boxsel4'});
model.geom('geom1').run('difsel5');
model.geom('geom1').create('sel1', 'ExplicitSelection');
model.geom('geom1').feature('sel1').label('Exterior Field Boundaries');
model.geom('geom1').feature('sel1').selection('selection').init(2);
model.geom('geom1').feature('sel1').selection('selection').set('del3', [23 49]);
model.geom('geom1').run('sel1');
model.geom('geom1').create('sel2', 'ExplicitSelection');
model.geom('geom1').feature('sel2').label('Ground');
model.geom('geom1').feature('sel2').selection('selection').init(2);
model.geom('geom1').feature('sel2').selection('selection').set('del3', [33 42 62 71 89 96 107 129]);
model.geom('geom1').run('sel2');
model.geom('geom1').create('sel3', 'ExplicitSelection');
model.geom('geom1').feature('sel3').label('Terminal');
model.geom('geom1').feature('sel3').selection('selection').init(2);
model.geom('geom1').feature('sel3').selection('selection').set('del3', [28 39 59 67 86 93 102 126]);
model.geom('geom1').run('sel3');
model.geom('geom1').create('comsel1', 'ComplementSelection');
model.geom('geom1').feature('comsel1').label('All except PML');
model.geom('geom1').feature('comsel1').set('input', {'difsel3'});

model.title([]);

model.description('');

model.label('piezo_mems_speaker_geom_sequence.mph');

model.modelNode.label('Components');

out = model;
