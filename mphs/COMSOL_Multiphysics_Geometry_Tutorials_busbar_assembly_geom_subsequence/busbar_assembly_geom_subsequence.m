function out = model
%
% busbar_assembly_geom_subsequence.m
%
% Model exported on May 26 2025, 21:26 by COMSOL 6.2.0.339.

import com.comsol.model.*
import com.comsol.model.util.*

model = ModelUtil.create('Model');

model.modelPath('/Applications/COMSOL62/Multiphysics/applications/COMSOL_Multiphysics/Geometry_Tutorials');

model.geom.create('part1', 'Part', 3);
model.geom('part1').label('Cell Grid Top');
model.geom('part1').lengthUnit('mm');
model.geom('part1').localParam.set('c_g_w_part', '400[mm]');
model.geom('part1').localParam.descr('c_g_w_part', 'Cell grid top width');
model.geom('part1').localParam.set('c_g_l_part', '800[mm]');
model.geom('part1').localParam.descr('c_g_l_part', 'Cell grid top length');
model.geom('part1').localParam.set('c_g_h_part', '5[mm]');
model.geom('part1').localParam.descr('c_g_h_part', 'Cell grid top height');
model.geom('part1').localParam.set('s_di_part', '10[mm]');
model.geom('part1').localParam.descr('s_di_part', 'Spine to cell grid boundary distance');
model.geom('part1').create('blk1', 'Block');
model.geom('part1').feature('blk1').set('size', {'c_g_w_part' '1' '1'});
model.geom('part1').feature('blk1').setIndex('size', 'c_g_l_part', 1);
model.geom('part1').feature('blk1').setIndex('size', 'c_g_h_part', 2);
model.geom('part1').feature('blk1').set('base', 'center');
model.geom('part1').feature('blk1').set('pos', {'0' '0' 'c_g_h_part/2'});
model.geom('part1').feature('blk1').set('selresult', true);
model.geom('part1').run('blk1');
model.geom('part1').create('wp1', 'WorkPlane');
model.geom('part1').feature('wp1').set('unite', true);
model.geom('part1').feature('wp1').label('Spine Position');
model.geom('part1').feature('wp1').set('planetype', 'faceparallel');
model.geom('part1').feature('wp1').selection('face').set('blk1', 4);
model.geom('part1').feature('wp1').set('displ', {'-c_g_w_part/2+s_di_part' '0'});
model.geom('part1').feature('wp1').setIndex('displ', '-c_g_l_part/2+s_di_part', 1);
model.geom('part1').run('wp1');
model.geom('part1').create('sel1', 'ExplicitSelection');
model.geom('part1').feature('sel1').label('Electrolyte Boundary');
model.geom('part1').feature('sel1').selection('selection').init(2);
model.geom('part1').feature('sel1').selection('selection').set('blk1', 1);
model.geom('part1').run('sel1');
model.geom.create('part2', 'Part', 3);
model.geom('part2').label('Spine');
model.geom('part2').lengthUnit('mm');
model.geom('part2').localParam.set('c_g_w_part', '400[mm]');
model.geom('part2').localParam.descr('c_g_w_part', 'Cell grid top width');
model.geom('part2').localParam.set('c_g_l_part', '800[mm]');
model.geom('part2').localParam.descr('c_g_l_part', 'Cell grid top height');
model.geom('part2').localParam.set('s_l_part', 'c_g_l_part/2-2*s_di_part');
model.geom('part2').localParam.descr('s_l_part', 'Spine length');
model.geom('part2').localParam.set('s_w_part', 'c_g_w_part/2-2*s_di_part');
model.geom('part2').localParam.descr('s_w_part', 'Spine width');
model.geom('part2').localParam.set('s_h_part', '5[mm]');
model.geom('part2').localParam.descr('s_h_part', 'Spine height');
model.geom('part2').localParam.set('s_di_part', '10[mm]');
model.geom('part2').localParam.descr('s_di_part', 'Spine to cell grid boundary distance');
model.geom('part2').localParam.set('s_c_w_part', '65[mm]');
model.geom('part2').localParam.descr('s_c_w_part', 'Spine center width');
model.geom('part2').localParam.set('s_c_l_part', '60[mm]');
model.geom('part2').localParam.descr('s_c_l_part', 'Spine cut out length');
model.geom('part2').create('wp1', 'WorkPlane');
model.geom('part2').feature('wp1').set('unite', true);
model.geom('part2').feature('wp1').set('showworkplane', false);
model.geom('part2').feature('wp1').geom.create('pol1', 'Polygon');
model.geom('part2').feature('wp1').geom.feature('pol1').set('source', 'table');
model.geom('part2').feature('wp1').geom.feature('pol1').setIndex('table', 0, 0, 0);
model.geom('part2').feature('wp1').geom.feature('pol1').setIndex('table', 0, 0, 1);
model.geom('part2').feature('wp1').geom.feature('pol1').setIndex('table', 0, 1, 0);
model.geom('part2').feature('wp1').geom.feature('pol1').setIndex('table', 's_c_l_part', 1, 1);
model.geom('part2').feature('wp1').geom.feature('pol1').setIndex('table', 's_w_part/2-s_c_w_part/2', 2, 0);
model.geom('part2').feature('wp1').geom.feature('pol1').setIndex('table', 's_c_l_part', 2, 1);
model.geom('part2').feature('wp1').geom.feature('pol1').setIndex('table', 's_w_part/2-s_c_w_part/2', 3, 0);
model.geom('part2').feature('wp1').geom.feature('pol1').setIndex('table', 's_l_part-s_c_l_part', 3, 1);
model.geom('part2').feature('wp1').geom.feature('pol1').setIndex('table', 0, 4, 0);
model.geom('part2').feature('wp1').geom.feature('pol1').setIndex('table', 's_l_part-s_c_l_part', 4, 1);
model.geom('part2').feature('wp1').geom.feature('pol1').setIndex('table', 0, 5, 0);
model.geom('part2').feature('wp1').geom.feature('pol1').setIndex('table', 's_l_part', 5, 1);
model.geom('part2').feature('wp1').geom.feature('pol1').setIndex('table', 's_w_part', 6, 0);
model.geom('part2').feature('wp1').geom.feature('pol1').setIndex('table', 's_l_part', 6, 1);
model.geom('part2').feature('wp1').geom.feature('pol1').setIndex('table', 's_w_part', 7, 0);
model.geom('part2').feature('wp1').geom.feature('pol1').setIndex('table', 's_l_part-s_c_l_part', 7, 1);
model.geom('part2').feature('wp1').geom.feature('pol1').setIndex('table', 's_w_part/2+s_c_w_part/2', 8, 0);
model.geom('part2').feature('wp1').geom.feature('pol1').setIndex('table', 's_l_part-s_c_l_part', 8, 1);
model.geom('part2').feature('wp1').geom.feature('pol1').setIndex('table', 's_w_part/2+s_c_w_part/2', 9, 0);
model.geom('part2').feature('wp1').geom.feature('pol1').setIndex('table', 's_c_l_part', 9, 1);
model.geom('part2').feature('wp1').geom.feature('pol1').setIndex('table', 's_w_part', 10, 0);
model.geom('part2').feature('wp1').geom.feature('pol1').setIndex('table', 's_c_l_part', 10, 1);
model.geom('part2').feature('wp1').geom.feature('pol1').setIndex('table', 's_w_part', 11, 0);
model.geom('part2').feature('wp1').geom.feature('pol1').setIndex('table', 0, 11, 1);
model.geom('part2').run('wp1');
model.geom('part2').feature.create('ext1', 'Extrude');
model.geom('part2').feature('ext1').set('workplane', 'wp1');
model.geom('part2').feature('ext1').selection('input').set({'wp1'});
model.geom('part2').feature('ext1').set('selresult', true);
model.geom('part2').feature('ext1').setIndex('distance', 's_h_part', 0);
model.geom('part2').run('ext1');
model.geom('part2').create('wp2', 'WorkPlane');
model.geom('part2').feature('wp2').set('unite', true);
model.geom('part2').feature('wp2').label('Central Column Position');
model.geom('part2').feature('wp2').set('planetype', 'faceparallel');
model.geom('part2').feature('wp2').selection('face').set('ext1', 4);
model.geom('part2').run('wp2');
model.geom.create('part3', 'Part', 3);
model.geom('part3').label('Central Column');
model.geom('part3').inputParam.set('r_d_part', '20[mm]');
model.geom('part3').inputParam.descr('r_d_part', 'Rod diameter');
model.geom('part3').lengthUnit('mm');
model.geom('part3').localParam.set('c_c_r_part', '40[mm]');
model.geom('part3').localParam.descr('c_c_r_part', 'Central column radius');
model.geom('part3').localParam.set('c_c_h_part', '70[mm]');
model.geom('part3').localParam.descr('c_c_h_part', 'Central column height');
model.geom('part3').localParam.set('c_c_d_part', '25[mm]');
model.geom('part3').localParam.descr('c_c_d_part', 'Central column center hole depth');
model.geom('part3').create('wp1', 'WorkPlane');
model.geom('part3').feature('wp1').set('unite', true);
model.geom('part3').feature('wp1').set('quickplane', 'yz');
model.geom('part3').feature('wp1').set('showworkplane', false);
model.geom('part3').feature('wp1').geom.create('pol1', 'Polygon');
model.geom('part3').feature('wp1').geom.feature('pol1').set('source', 'table');
model.geom('part3').feature('wp1').geom.feature('pol1').setIndex('table', 0, 0, 0);
model.geom('part3').feature('wp1').geom.feature('pol1').setIndex('table', 0, 0, 1);
model.geom('part3').feature('wp1').geom.feature('pol1').setIndex('table', 0, 1, 0);
model.geom('part3').feature('wp1').geom.feature('pol1').setIndex('table', 'c_c_h_part-c_c_d_part', 1, 1);
model.geom('part3').feature('wp1').geom.feature('pol1').setIndex('table', 'r_d_part/2', 2, 0);
model.geom('part3').feature('wp1').geom.feature('pol1').setIndex('table', 'c_c_h_part-c_c_d_part', 2, 1);
model.geom('part3').feature('wp1').geom.feature('pol1').setIndex('table', 'r_d_part/2', 3, 0);
model.geom('part3').feature('wp1').geom.feature('pol1').setIndex('table', 'c_c_h_part', 3, 1);
model.geom('part3').feature('wp1').geom.feature('pol1').setIndex('table', '0.7*r_d_part', 4, 0);
model.geom('part3').feature('wp1').geom.feature('pol1').setIndex('table', 'c_c_h_part', 4, 1);
model.geom('part3').feature('wp1').geom.feature('pol1').setIndex('table', '0.7*r_d_part', 5, 0);
model.geom('part3').feature('wp1').geom.feature('pol1').setIndex('table', 'c_c_h_part-0.8*r_d_part', 5, 1);
model.geom('part3').feature('wp1').geom.feature('pol1').setIndex('table', 'c_c_r_part', 6, 0);
model.geom('part3').feature('wp1').geom.feature('pol1').setIndex('table', 'c_c_h_part-0.8*r_d_part', 6, 1);
model.geom('part3').feature('wp1').geom.feature('pol1').setIndex('table', 'c_c_r_part', 7, 0);
model.geom('part3').feature('wp1').geom.feature('pol1').setIndex('table', 'c_c_h_part-1.1*r_d_part', 7, 1);
model.geom('part3').feature('wp1').geom.feature('pol1').setIndex('table', 'c_c_r_part-r_d_part/2', 8, 0);
model.geom('part3').feature('wp1').geom.feature('pol1').setIndex('table', 'c_c_h_part-1.1*r_d_part', 8, 1);
model.geom('part3').feature('wp1').geom.feature('pol1').setIndex('table', 'c_c_r_part-r_d_part/2', 9, 0);
model.geom('part3').feature('wp1').geom.feature('pol1').setIndex('table', 0, 9, 1);
model.geom('part3').feature('wp1').geom.run('pol1');
model.geom('part3').feature('wp1').geom.create('fil1', 'Fillet');
model.geom('part3').feature('wp1').geom.feature('fil1').set('radius', '0.3*r_d_part');
model.geom('part3').feature('wp1').geom.feature('fil1').selection('pointinsketch').set('pol1', [6 9]);
model.geom('part3').feature('wp1').geom.run('fil1');
model.geom('part3').feature('wp1').geom.create('fil2', 'Fillet');
model.geom('part3').feature('wp1').geom.feature('fil2').selection('pointinsketch').set('fil1', [11 12]);
model.geom('part3').feature('wp1').geom.feature('fil2').set('radius', '0.15*r_d_part');
model.geom('part3').run('wp1');
model.geom('part3').feature.create('rev1', 'Revolve');
model.geom('part3').feature('rev1').set('workplane', 'wp1');
model.geom('part3').feature('rev1').selection('input').set({'wp1'});
model.geom('part3').feature('rev1').set('angtype', 'full');
model.geom('part3').feature('rev1').set('origfaces', false);
model.geom('part3').feature('rev1').set('selresult', true);
model.geom('part3').run('rev1');
model.geom('part3').create('wp2', 'WorkPlane');
model.geom('part3').feature('wp2').set('unite', true);
model.geom('part3').feature('wp2').label('Rod Position');
model.geom('part3').feature('wp2').set('quickoffsettype', 'vertex');
model.geom('part3').feature('wp2').selection('offsetvertex').set('rev1', 24);
model.geom('part3').run('wp2');
model.geom.create('part4', 'Part', 3);
model.geom('part4').label('Rod');
model.geom('part4').inputParam.set('r_d_part', '20[mm]');
model.geom('part4').inputParam.descr('r_d_part', 'Rod diameter');
model.geom('part4').inputParam.set('r_l_part', '160[mm]');
model.geom('part4').inputParam.descr('r_l_part', 'Rod length');
model.geom('part4').lengthUnit('mm');
model.geom('part4').create('cyl1', 'Cylinder');
model.geom('part4').feature('cyl1').set('r', 'r_d_part/2');
model.geom('part4').feature('cyl1').set('h', 'r_l_part');
model.geom('part4').feature('cyl1').set('selresult', true);
model.geom('part4').run('cyl1');
model.geom('part4').create('wp1', 'WorkPlane');
model.geom('part4').feature('wp1').set('unite', true);
model.geom('part4').feature('wp1').label('Rod Connector Position');
model.geom('part4').feature('wp1').set('planetype', 'faceparallel');
model.geom('part4').feature('wp1').selection('face').set('cyl1', 4);
model.geom('part4').feature('wp1').set('rot', 90);
model.geom('part4').run('wp1');
model.geom.create('part5', 'Part', 3);
model.geom('part5').label('Rod Connector');
model.geom('part5').inputParam.set('a_c_w_part', '90[mm]');
model.geom('part5').inputParam.descr('a_c_w_part', 'Angle connector width');
model.geom('part5').inputParam.set('r_d_part', '20[mm]');
model.geom('part5').inputParam.descr('r_d_part', 'Rod diameter');
model.geom('part5').inputParam.set('r_c_h_part', '6[mm]');
model.geom('part5').inputParam.descr('r_c_h_part', 'Rod connector height');
model.geom('part5').lengthUnit('mm');
model.geom('part5').localParam.set('r_c_w_part', '150[mm]');
model.geom('part5').localParam.descr('r_c_w_part', 'Rod connector width');
model.geom('part5').localParam.set('s_di_part', '10[mm]');
model.geom('part5').localParam.descr('s_di_part', 'Spine to cell grid boundary distance');
model.geom('part5').localParam.set('b_di_part', '20[mm]');
model.geom('part5').localParam.descr('b_di_part', 'Bolt to boundary distance');
model.geom('part5').localParam.set('b_r_part', '6[mm]');
model.geom('part5').localParam.descr('b_r_part', 'Bolt radius');
model.geom('part5').create('wp1', 'WorkPlane');
model.geom('part5').feature('wp1').set('unite', true);
model.geom('part5').feature('wp1').set('showworkplane', false);
model.geom('part5').feature('wp1').geom.create('r1', 'Rectangle');
model.geom('part5').feature('wp1').geom.feature('r1').set('size', {'a_c_w_part' 'r_c_w_part'});
model.geom('part5').feature('wp1').geom.feature('r1').set('base', 'center');
model.geom('part5').feature('wp1').geom.feature('r1').set('pos', {'0' 'r_c_w_part/2-2*s_di_part'});
model.geom('part5').feature('wp1').geom.run('r1');
model.geom('part5').feature('wp1').geom.create('fil1', 'Fillet');
model.geom('part5').feature('wp1').geom.feature('fil1').selection('pointinsketch').set('r1', [1 2 3 4]);
model.geom('part5').feature('wp1').geom.feature('fil1').set('radius', '5[mm]');
model.geom('part5').feature('wp1').geom.run('fil1');
model.geom('part5').feature('wp1').geom.create('c1', 'Circle');
model.geom('part5').feature('wp1').geom.feature('c1').set('r', 'r_d_part/2');
model.geom('part5').feature('wp1').geom.run('c1');
model.geom('part5').feature('wp1').geom.create('c2', 'Circle');
model.geom('part5').feature('wp1').geom.feature('c2').set('r', 'b_r_part');
model.geom('part5').feature('wp1').geom.feature('c2').set('pos', {'a_c_w_part/4' '0'});
model.geom('part5').feature('wp1').geom.feature('c2').setIndex('pos', '-2*s_di_part+r_c_w_part-b_di_part', 1);
model.geom('part5').feature('wp1').geom.run('c2');
model.geom('part5').feature('wp1').geom.create('mir1', 'Mirror');
model.geom('part5').feature('wp1').geom.feature('mir1').selection('input').set({'c2'});
model.geom('part5').feature('wp1').geom.feature('mir1').set('keep', true);
model.geom('part5').feature('wp1').geom.run('mir1');
model.geom('part5').feature('wp1').geom.create('dif1', 'Difference');
model.geom('part5').feature('wp1').geom.feature('dif1').selection('input').set({'fil1'});
model.geom('part5').feature('wp1').geom.feature('dif1').selection('input2').set({'c1' 'c2' 'mir1'});
model.geom('part5').run('wp1');
model.geom('part5').feature.create('ext1', 'Extrude');
model.geom('part5').feature('ext1').set('workplane', 'wp1');
model.geom('part5').feature('ext1').selection('input').set({'wp1'});
model.geom('part5').feature('ext1').setIndex('distance', 'r_c_h_part', 0);
model.geom('part5').feature('ext1').set('selresult', true);
model.geom('part5').feature('ext1').set('reverse', true);
model.geom('part5').run('ext1');
model.geom('part5').create('wp2', 'WorkPlane');
model.geom('part5').feature('wp2').set('unite', true);
model.geom('part5').feature('wp2').label('Elbow Connector Position');
model.geom('part5').feature('wp2').set('planetype', 'transformed');
model.geom('part5').feature('wp2').set('workplane', 'wp1');
model.geom('part5').feature('wp2').set('transdispl', {'a_c_w_part/4' '0' '0'});
model.geom('part5').feature('wp2').setIndex('transdispl', '-2*s_di_part+r_c_w_part-b_di_part', 1);
model.geom('part5').run('wp2');
model.geom.create('part6', 'Part', 3);
model.geom('part6').label('Elbow Connector');
model.geom('part6').inputParam.set('a_c_w_part', '90[mm]');
model.geom('part6').inputParam.descr('a_c_w_part', 'Angle connector width');
model.geom('part6').lengthUnit('mm');
model.geom('part6').localParam.set('e_c_h_part', '10[mm]');
model.geom('part6').localParam.descr('e_c_h_part', 'Elbow connector height');
model.geom('part6').localParam.set('e_c_lx_part', '60[mm]');
model.geom('part6').localParam.descr('e_c_lx_part', ['Elbow connector length, x' native2unicode(hex2dec({'00' 'a0'}), 'unicode') 'direction']);
model.geom('part6').localParam.set('e_c_lz_part', '80[mm]');
model.geom('part6').localParam.descr('e_c_lz_part', ['Elbow connector length, z' native2unicode(hex2dec({'00' 'a0'}), 'unicode') 'direction']);
model.geom('part6').localParam.set('b_di_part', '20[mm]');
model.geom('part6').localParam.descr('b_di_part', 'Bolt to boundary distance');
model.geom('part6').localParam.set('b_r_part', '6[mm]');
model.geom('part6').localParam.descr('b_r_part', 'Bolt radius');
model.geom('part6').create('wp1', 'WorkPlane');
model.geom('part6').feature('wp1').set('unite', true);
model.geom('part6').feature('wp1').set('showworkplane', false);
model.geom('part6').feature('wp1').geom.create('r1', 'Rectangle');
model.geom('part6').feature('wp1').geom.feature('r1').set('size', {'e_c_lx_part' '1'});
model.geom('part6').feature('wp1').geom.feature('r1').setIndex('size', 'a_c_w_part', 1);
model.geom('part6').feature('wp1').geom.run('r1');
model.geom('part6').feature('wp1').geom.create('fil1', 'Fillet');
model.geom('part6').feature('wp1').geom.feature('fil1').selection('pointinsketch').set('r1', [1 4]);
model.geom('part6').feature('wp1').geom.feature('fil1').set('radius', '5[mm]');
model.geom('part6').feature('wp1').geom.run('fil1');
model.geom('part6').feature('wp1').geom.create('c1', 'Circle');
model.geom('part6').feature('wp1').geom.feature('c1').set('r', 'b_r_part');
model.geom('part6').feature('wp1').geom.feature('c1').set('pos', {'b_di_part' 'a_c_w_part/4'});
model.geom('part6').feature('wp1').geom.run('c1');
model.geom('part6').feature('wp1').geom.create('c2', 'Circle');
model.geom('part6').feature('wp1').geom.feature('c2').set('r', 'b_r_part');
model.geom('part6').feature('wp1').geom.feature('c2').set('pos', {'b_di_part' 'a_c_w_part*3/4'});
model.geom('part6').feature('wp1').geom.run('c2');
model.geom('part6').feature('wp1').geom.create('dif1', 'Difference');
model.geom('part6').feature('wp1').geom.feature('dif1').selection('input').set({'fil1'});
model.geom('part6').feature('wp1').geom.feature('dif1').selection('input2').set({'c1' 'c2'});
model.geom('part6').run('wp1');
model.geom('part6').feature.create('ext1', 'Extrude');
model.geom('part6').feature('ext1').set('workplane', 'wp1');
model.geom('part6').feature('ext1').selection('input').set({'wp1'});
model.geom('part6').feature('ext1').setIndex('distance', 'e_c_h_part', 0);
model.geom('part6').run('ext1');
model.geom('part6').create('wp2', 'WorkPlane');
model.geom('part6').feature('wp2').set('unite', true);
model.geom('part6').feature('wp2').set('quickplane', 'yz');
model.geom('part6').feature('wp2').set('quickx', 'e_c_lx_part+2*e_c_h_part');
model.geom('part6').feature('wp2').set('displ', {'0' '2*e_c_h_part'});
model.geom('part6').feature('wp2').set('showworkplane', false);
model.geom('part6').feature('wp2').geom.create('r1', 'Rectangle');
model.geom('part6').feature('wp2').geom.feature('r1').set('size', {'a_c_w_part' 'e_c_lz_part'});
model.geom('part6').feature('wp2').geom.run('r1');
model.geom('part6').feature('wp2').geom.create('fil1', 'Fillet');
model.geom('part6').feature('wp2').geom.feature('fil1').selection('pointinsketch').set('r1', [3 4]);
model.geom('part6').feature('wp2').geom.feature('fil1').set('radius', '5[mm]');
model.geom('part6').feature('wp2').geom.run('fil1');
model.geom('part6').feature('wp2').geom.create('c1', 'Circle');
model.geom('part6').feature('wp2').geom.feature('c1').set('r', 'b_r_part');
model.geom('part6').feature('wp2').geom.feature('c1').set('pos', {'a_c_w_part/4' '0'});
model.geom('part6').feature('wp2').geom.feature('c1').setIndex('pos', 'b_di_part', 1);
model.geom('part6').feature('wp2').geom.run('c1');
model.geom('part6').feature('wp2').geom.create('arr1', 'Array');
model.geom('part6').feature('wp2').geom.feature('arr1').selection('input').set({'c1'});
model.geom('part6').feature('wp2').geom.feature('arr1').set('fullsize', [2 2]);
model.geom('part6').feature('wp2').geom.feature('arr1').set('displ', {'a_c_w_part/2' '0'});
model.geom('part6').feature('wp2').geom.feature('arr1').setIndex('displ', '40[mm]', 1);
model.geom('part6').feature('wp2').geom.run('arr1');
model.geom('part6').feature('wp2').geom.create('dif1', 'Difference');
model.geom('part6').feature('wp2').geom.feature('dif1').selection('input').set({'fil1'});
model.geom('part6').feature('wp2').geom.feature('dif1').selection('input2').set({'arr1'});
model.geom('part6').run('wp2');
model.geom('part6').feature.create('ext2', 'Extrude');
model.geom('part6').feature('ext2').set('workplane', 'wp2');
model.geom('part6').feature('ext2').selection('input').set({'wp2'});
model.geom('part6').feature('ext2').setIndex('distance', 'e_c_h_part', 0);
model.geom('part6').feature('ext2').set('reverse', true);
model.geom('part6').run('ext2');
model.geom('part6').create('wp3', 'WorkPlane');
model.geom('part6').feature('wp3').set('unite', true);
model.geom('part6').feature('wp3').set('planetype', 'faceparallel');
model.geom('part6').feature('wp3').selection('face').set('ext1', 6);
model.geom('part6').feature('wp3').set('origin', 'vertexproj');
model.geom('part6').feature('wp3').selection('originvertex').set('ext1', 25);
model.geom('part6').feature('wp3').set('displ', {'0' '-2*e_c_h_part'});
model.geom('part6').feature('wp3').set('rot', 180);
model.geom('part6').feature('wp3').set('showworkplane', false);
model.geom('part6').feature('wp3').geom.create('c1', 'Circle');
model.geom('part6').feature('wp3').geom.feature('c1').set('r', 'e_c_h_part');
model.geom('part6').feature('wp3').geom.feature('c1').set('angle', 90);
model.geom('part6').feature('wp3').geom.feature('c1').set('rot', 270);
model.geom('part6').feature('wp3').geom.run('c1');
model.geom('part6').feature('wp3').geom.create('c2', 'Circle');
model.geom('part6').feature('wp3').geom.feature('c2').set('r', '2*e_c_h_part');
model.geom('part6').feature('wp3').geom.feature('c2').set('angle', 90);
model.geom('part6').feature('wp3').geom.feature('c2').set('rot', 270);
model.geom('part6').feature('wp3').geom.run('c2');
model.geom('part6').feature('wp3').geom.create('dif1', 'Difference');
model.geom('part6').feature('wp3').geom.feature('dif1').selection('input').set({'c2'});
model.geom('part6').feature('wp3').geom.feature('dif1').selection('input2').set({'c1'});
model.geom('part6').run('wp3');
model.geom('part6').feature.create('ext3', 'Extrude');
model.geom('part6').feature('ext3').set('workplane', 'wp3');
model.geom('part6').feature('ext3').selection('input').set({'wp3'});
model.geom('part6').feature('ext3').set('specify', 'vertices');
model.geom('part6').feature('ext3').selection('vertex').set('ext1', 28);
model.geom('part6').run('ext3');
model.geom('part6').create('uni1', 'Union');
model.geom('part6').feature('uni1').selection('input').set({'ext1' 'ext2' 'ext3'});
model.geom('part6').feature('uni1').set('intbnd', false);
model.geom('part6').feature('uni1').set('selresult', true);
model.geom('part6').run('uni1');
model.geom('part6').create('wp4', 'WorkPlane');
model.geom('part6').feature('wp4').set('unite', true);
model.geom('part6').feature('wp4').label('Rod Connector Position');
model.geom('part6').feature('wp4').set('planetype', 'transformed');
model.geom('part6').feature('wp4').set('transdispl', {'b_di_part' 'a_c_w_part/4' '0'});
model.geom('part6').run('wp4');
model.geom('part6').create('wp5', 'WorkPlane');
model.geom('part6').feature('wp5').set('unite', true);
model.geom('part6').feature('wp5').label('Intercell Busbar Position');
model.geom('part6').feature('wp5').set('planetype', 'transformed');
model.geom('part6').feature('wp5').set('workplane', 'wp2');
model.geom('part6').feature('wp5').set('transdispl', {'a_c_w_part/4' '0' '0'});
model.geom('part6').feature('wp5').setIndex('transdispl', 'b_di_part', 1);
model.geom('part6').feature('wp5').set('transrot', 90);
model.geom('part6').run('wp5');
model.geom('part6').create('wp6', 'WorkPlane');
model.geom('part6').feature('wp6').set('unite', true);
model.geom('part6').feature('wp6').label('Angle Connector Position');
model.geom('part6').feature('wp6').set('quickz', 'e_c_h_part');
model.geom('part6').feature('wp6').set('displ', {'b_di_part' 'a_c_w_part/4'});
model.geom('part6').run('wp6');
model.geom('part6').create('sel1', 'ExplicitSelection');
model.geom('part6').feature('sel1').label('Bolt Medium Position');
model.geom('part6').feature('sel1').selection('selection').init(0);
model.geom('part6').feature('sel1').selection('selection').set('uni1', [35 37 43 45]);
model.geom('part6').run('sel1');
model.geom.create('part7', 'Part', 3);
model.geom('part7').label('Intercell Busbar');
model.geom('part7').inputParam.set('a_c_w_part', '90[mm]');
model.geom('part7').inputParam.descr('a_c_w_part', 'Angle connector width');
model.geom('part7').lengthUnit('mm');
model.geom('part7').localParam.set('i_b_h_part', '10[mm]');
model.geom('part7').localParam.descr('i_b_h_part', 'Intercell busbar height');
model.geom('part7').localParam.set('i_b_l_part', '820[mm]');
model.geom('part7').localParam.descr('i_b_l_part', 'Intercell busbar length');
model.geom('part7').localParam.set('i_b_w_part', '120[mm]');
model.geom('part7').localParam.descr('i_b_w_part', 'Intercell busbar width');
model.geom('part7').localParam.set('b_r_part', '6[mm]');
model.geom('part7').localParam.descr('b_r_part', 'Bolt radius');
model.geom('part7').localParam.set('b_di_part', '20[mm]');
model.geom('part7').localParam.descr('b_di_part', 'Bolt to boundary distance');
model.geom('part7').localParam.set('c_g_l_part', '800[mm]');
model.geom('part7').localParam.descr('c_g_l_part', 'Cell grid top length');
model.geom('part7').create('blk1', 'Block');
model.geom('part7').feature('blk1').set('size', {'i_b_h_part' '1' '1'});
model.geom('part7').feature('blk1').setIndex('size', 'i_b_l_part', 1);
model.geom('part7').feature('blk1').setIndex('size', 'i_b_w_part', 2);
model.geom('part7').feature('blk1').set('base', 'center');
model.geom('part7').run('blk1');
model.geom('part7').create('wp1', 'WorkPlane');
model.geom('part7').feature('wp1').set('unite', true);
model.geom('part7').feature('wp1').set('showworkplane', false);
model.geom('part7').feature('wp1').set('quickplane', 'yz');
model.geom('part7').feature('wp1').set('quickx', 'i_b_h_part');
model.geom('part7').feature('wp1').geom.create('c1', 'Circle');
model.geom('part7').feature('wp1').geom.feature('c1').set('r', 'b_r_part');
model.geom('part7').feature('wp1').geom.feature('c1').set('pos', {'c_g_l_part/4-a_c_w_part/4' '0'});
model.geom('part7').feature('wp1').geom.feature('c1').setIndex('pos', '-i_b_w_part/2+b_di_part', 1);
model.geom('part7').feature('wp1').geom.run('c1');
model.geom('part7').feature('wp1').geom.create('arr1', 'Array');
model.geom('part7').feature('wp1').geom.feature('arr1').selection('input').set({'c1'});
model.geom('part7').feature('wp1').geom.feature('arr1').set('fullsize', [2 2]);
model.geom('part7').feature('wp1').geom.feature('arr1').set('displ', {'a_c_w_part/2' '0'});
model.geom('part7').feature('wp1').geom.feature('arr1').setIndex('displ', '40[mm]', 1);
model.geom('part7').feature('wp1').geom.run('arr1');
model.geom('part7').feature('wp1').geom.create('mir1', 'Mirror');
model.geom('part7').feature('wp1').geom.feature('mir1').selection('input').set({'arr1'});
model.geom('part7').feature('wp1').geom.feature('mir1').set('keep', true);
model.geom('part7').run('wp1');
model.geom('part7').feature.create('ext1', 'Extrude');
model.geom('part7').feature('ext1').set('workplane', 'wp1');
model.geom('part7').feature('ext1').selection('input').set({'wp1'});
model.geom('part7').feature('ext1').setIndex('distance', 'i_b_h_part*2', 0);
model.geom('part7').feature('ext1').set('reverse', true);
model.geom('part7').run('ext1');
model.geom('part7').create('dif1', 'Difference');
model.geom('part7').feature('dif1').selection('input').set({'blk1'});
model.geom('part7').feature('dif1').selection('input2').set({'ext1'});
model.geom('part7').feature('dif1').set('selresult', true);
model.geom('part7').run('dif1');
model.geom('part7').create('sel1', 'ExplicitSelection');
model.geom('part7').feature('sel1').label('Grounded Boundary');
model.geom('part7').feature('sel1').selection('selection').init(2);
model.geom('part7').feature('sel1').selection('selection').set('dif1', [2 37]);
model.geom('part7').run('sel1');
model.geom('part7').create('wp2', 'WorkPlane');
model.geom('part7').feature('wp2').set('unite', true);
model.geom('part7').feature('wp2').label('Elbow Connector Position');
model.geom('part7').feature('wp2').set('planetype', 'faceparallel');
model.geom('part7').feature('wp2').selection('face').set('dif1', 1);
model.geom('part7').feature('wp2').set('reverse', true);
model.geom('part7').feature('wp2').set('displ', {'c_g_l_part/4-a_c_w_part/4' '0'});
model.geom('part7').feature('wp2').setIndex('displ', '-40[mm]', 1);
model.geom('part7').feature('wp2').set('rot', 90);
model.geom('part7').run('wp2');
model.geom.create('part8', 'Part', 3);
model.geom('part8').label('Bolt');
model.geom('part8').inputParam.set('size', '0');
model.geom('part8').inputParam.descr('size', 'Size selection 0 = small, 1 = medium, 2 = large');
model.geom('part8').lengthUnit('mm');
model.geom('part8').localParam.set('l_part', 'if(size==2,r_c_h_part+a_c_h_part+e_c_h_part,if(size==1,e_c_h_part+i_b_h_part,r_c_h_part+a_c_h_part))');
model.geom('part8').localParam.descr('l_part', 'Bolt length');
model.geom('part8').localParam.set('e_c_h_part', '10[mm]');
model.geom('part8').localParam.descr('e_c_h_part', 'Bolt radius');
model.geom('part8').localParam.set('r_c_h_part', '6[mm]');
model.geom('part8').localParam.descr('r_c_h_part', 'Rod connector height');
model.geom('part8').localParam.set('a_c_h_part', '6[mm]');
model.geom('part8').localParam.descr('a_c_h_part', 'Angle connector height');
model.geom('part8').localParam.set('i_b_h_part', '10[mm]');
model.geom('part8').localParam.descr('i_b_h_part', 'Intercell busbar height');
model.geom('part8').localParam.set('b_r_part', '6[mm]');
model.geom('part8').localParam.descr('b_r_part', 'Bolt radius');
model.geom('part8').localParam.set('b_di_part', '20[mm]');
model.geom('part8').localParam.descr('b_di_part', 'Bolt to boundary distance');
model.geom('part8').create('cyl1', 'Cylinder');
model.geom('part8').feature('cyl1').set('r', 'b_r_part');
model.geom('part8').feature('cyl1').set('h', 'l_part');
model.geom('part8').feature('cyl1').set('selresult', true);
model.geom('part8').run('cyl1');

model.title([]);

model.description('');

model.label('busbar_assembly_geom_subsequence.mph');

model.modelNode.label('Components');

out = model;
