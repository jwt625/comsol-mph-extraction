function out = model
%
% heterojunction_1d.m
%
% Model exported on May 26 2025, 21:33 by COMSOL 6.2.0.339.

import com.comsol.model.*
import com.comsol.model.util.*

model = ModelUtil.create('Model');

model.modelPath('/Applications/COMSOL62/Multiphysics/applications/Semiconductor_Module/Verification_Examples');

model.modelNode.create('comp1', true);

model.geom.create('geom1', 1);
model.geom('geom1').model('comp1');

model.mesh.create('mesh1', 'geom1');

model.physics.create('semi', 'Semiconductor', 'geom1');
model.physics('semi').model('comp1');

model.study.create('std1');
model.study('std1').create('stat', 'Stationary');
model.study('std1').feature('stat').setSolveFor('/physics/semi', true);

model.param.set('sign', '1');
model.param.descr('sign', 'Sign of applied voltage');
model.param.set('Va', '0[V]');
model.param.descr('Va', 'Voltage');
model.param.set('ramp', '1');
model.param.descr('ramp', 'Continuation parameter');
model.param.set('L', '5[um]');
model.param.descr('L', 'Length');
model.param.set('T0', '300[K]');
model.param.descr('T0', 'Temperature');

model.geom('geom1').create('i1', 'Interval');
model.geom('geom1').feature('i1').setIndex('coord', '-L', 0);
model.geom('geom1').feature('i1').setIndex('coord', 0, 1);
model.geom('geom1').feature.duplicate('i2', 'i1');
model.geom('geom1').feature('i2').setIndex('coord', 0, 0);
model.geom('geom1').feature('i2').setIndex('coord', 'L', 1);
model.geom('geom1').lengthUnit([native2unicode(hex2dec({'00' 'b5'}), 'unicode') 'm']);

model.variable.create('var1');
model.variable('var1').model('comp1');

model.geom('geom1').run;

model.variable('var1').label('GaAs');
model.variable('var1').selection.geom('geom1', 1);
model.variable('var1').selection.set([1]);

% To import content from file, use:
% model.variable('var1').loadFile('FILENAME');
model.variable('var1').set('Eg', '1.42[V]');
model.variable('var1').set('chi', '4.06[V]');
model.variable('var1').set('er', '13.1');
model.variable('var1').set('me_star0', '0.067*me_const');
model.variable('var1').set('mh_star0', '0.48*me_const');
model.variable('var1').set('Nc0', '2*(2*pi*me_star0*k_B_const*T0/h_const^2)^(3/2)');
model.variable('var1').set('Nv0', '2*(2*pi*mh_star0*k_B_const*T0/h_const^2)^(3/2)');
model.variable('var1').set('mun0', '7000[cm^2/(V*s)]');
model.variable('var1').set('mup0', '300[cm^2/(V*s)]');
model.variable('var1').set('taun0', '10[ns]');
model.variable('var1').set('taup0', '10[ns]');
model.variable('var1').set('Doping', '1e15[1/cm^3]');
model.variable.create('var2');
model.variable('var2').model('comp1');
model.variable('var2').label('Al_0.25Ga_0.75As');
model.variable('var2').selection.geom('geom1', 1);
model.variable('var2').selection.set([2]);

% To import content from file, use:
% model.variable('var2').loadFile('FILENAME');
model.variable('var2').set('Eg', '1.74[V]');
model.variable('var2').set('chi', '3.80[V]');
model.variable('var2').set('er', '12.4');
model.variable('var2').set('me_star0', '0.088*me_const');
model.variable('var2').set('mh_star0', '0.56*me_const');
model.variable('var2').set('Nc0', '2*(2*pi*me_star0*k_B_const*T0/h_const^2)^(3/2)');
model.variable('var2').set('Nv0', '2*(2*pi*mh_star0*k_B_const*T0/h_const^2)^(3/2)');
model.variable('var2').set('mun0', '2500[cm^2/(V*s)]');
model.variable('var2').set('mup0', '150[cm^2/(V*s)]');
model.variable('var2').set('taun0', '10[ns]');
model.variable('var2').set('taup0', '10[ns]');
model.variable('var2').set('Doping', '1e16[1/cm^3]');

model.physics('semi').prop('LatticeProperties').set('T0', 'T0');
model.physics('semi').feature('smm1').set('minput_temperature', 'T0');
model.physics('semi').create('tar1', 'TrapAssistedRecombination', 1);
model.physics('semi').feature('tar1').selection.all;
model.physics('semi').create('mc1', 'MetalContact', 0);
model.physics('semi').feature('mc1').selection.set([1]);
model.physics('semi').feature('mc1').set('V0', 'sign*Va');
model.physics('semi').create('mc2', 'MetalContact', 0);
model.physics('semi').feature('mc2').selection.set([3]);
model.physics('semi').create('adm1', 'AnalyticDopingModel', 1);
model.physics('semi').feature('adm1').label('Donor doping (left)');
model.physics('semi').feature('adm1').selection.set([1]);
model.physics('semi').feature('adm1').set('impurityType', 'donor');
model.physics('semi').feature('adm1').set('NDc', 'Doping');
model.physics('semi').create('adm2', 'AnalyticDopingModel', 1);
model.physics('semi').feature('adm2').label('Donor doping (right)');
model.physics('semi').feature('adm2').selection.set([2]);
model.physics('semi').feature('adm2').set('impurityType', 'donor');
model.physics('semi').feature('adm2').set('NDc', 'Doping');
model.physics('semi').create('adm3', 'AnalyticDopingModel', 1);
model.physics('semi').feature('adm3').label('Acceptor doping (left)');
model.physics('semi').feature('adm3').selection.set([1]);
model.physics('semi').feature('adm3').set('NAc', 'Doping');
model.physics('semi').create('adm4', 'AnalyticDopingModel', 1);
model.physics('semi').feature('adm4').label('Acceptor doping (right)');
model.physics('semi').feature('adm4').selection.set([2]);
model.physics('semi').feature('adm4').set('NAc', 'Doping');
model.physics('semi').create('cont2', 'Continuity', 0);
model.physics('semi').feature('cont2').selection.set([2]);
model.physics('semi').feature('cont2').set('HeteroModelSelection', 2);

model.material.create('mat1', 'Common', 'comp1');
model.material('mat1').propertyGroup.create('SemicondMaterial', 'Semiconductor_material');
model.material('mat1').propertyGroup('SemicondMaterial').set('mun', {'mun0'});
model.material('mat1').propertyGroup('SemicondMaterial').set('mup', {'mup0'});
model.material('mat1').propertyGroup('def').set('relpermittivity', {'er'});
model.material('mat1').propertyGroup('SemicondMaterial').set('Eg0', {'Eg'});
model.material('mat1').propertyGroup('SemicondMaterial').set('chi0', {'chi'});
model.material('mat1').propertyGroup('SemicondMaterial').set('Nc', {'Nc0'});
model.material('mat1').propertyGroup('SemicondMaterial').set('Nv', {'Nv0'});
model.material('mat1').propertyGroup.create('SRH', 'Shockley-Read-Hall_recombination');
model.material('mat1').propertyGroup('SRH').set('taun', {'taun0'});
model.material('mat1').propertyGroup('SRH').set('taup', {'taup0'});

model.mesh('mesh1').create('edg1', 'Edge');
model.mesh('mesh1').feature('edg1').create('dis1', 'Distribution');
model.mesh('mesh1').feature('edg1').feature('dis1').set('type', 'predefined');
model.mesh('mesh1').feature('edg1').feature('dis1').set('elemcount', 500);
model.mesh('mesh1').feature('edg1').feature('dis1').set('elemratio', 10);
model.mesh('mesh1').feature('edg1').feature('dis1').set('symmetric', true);
model.mesh('mesh1').run;

model.study('std1').label('n-n : Continuous Quasi-Fermi Levels');
model.study('std1').setGenPlots(false);
model.study('std1').feature('stat').set('useadvanceddisable', true);
model.study('std1').feature('stat').set('disabledphysics', {'semi/adm3' 'semi/adm4' 'semi/cont2'});
model.study('std1').feature('stat').set('useparam', true);
model.study('std1').feature('stat').set('sweeptype', 'filled');
model.study('std1').feature('stat').setIndex('pname', 'sign', 0);
model.study('std1').feature('stat').setIndex('plistarr', '', 0);
model.study('std1').feature('stat').setIndex('punit', '', 0);
model.study('std1').feature('stat').setIndex('pname', 'sign', 0);
model.study('std1').feature('stat').setIndex('plistarr', '', 0);
model.study('std1').feature('stat').setIndex('punit', '', 0);
model.study('std1').feature('stat').setIndex('plistarr', '-1 1', 0);
model.study('std1').feature('stat').setIndex('pname', 'Va', 1);
model.study('std1').feature('stat').setIndex('plistarr', '', 1);
model.study('std1').feature('stat').setIndex('punit', 'V', 1);
model.study('std1').feature('stat').setIndex('pname', 'Va', 1);
model.study('std1').feature('stat').setIndex('plistarr', '', 1);
model.study('std1').feature('stat').setIndex('punit', 'V', 1);
model.study('std1').feature('stat').setIndex('plistarr', 'range(0.05,0.05,1)', 1);
model.study('std1').feature('stat').set('preusesol', 'auto');

model.sol.create('sol1');
model.sol('sol1').study('std1');
model.sol('sol1').create('st1', 'StudyStep');
model.sol('sol1').feature('st1').set('study', 'std1');
model.sol('sol1').feature('st1').set('studystep', 'stat');
model.sol('sol1').create('v1', 'Variables');
model.sol('sol1').feature('v1').set('control', 'stat');
model.sol('sol1').create('s1', 'Stationary');
model.sol('sol1').feature('s1').set('stol', 1.0E-6);
model.sol('sol1').feature('s1').create('p1', 'Parametric');
model.sol('sol1').feature('s1').feature.remove('pDef');
model.sol('sol1').feature('s1').feature('p1').set('porder', 'constant');
model.sol('sol1').feature('s1').feature('p1').set('control', 'stat');
model.sol('sol1').feature('s1').set('control', 'stat');
model.sol('sol1').feature('s1').feature('aDef').set('complexfun', false);
model.sol('sol1').feature('s1').feature('aDef').set('cachepattern', true);
model.sol('sol1').feature('s1').feature('aDef').set('matherr', true);
model.sol('sol1').feature('s1').feature('aDef').set('blocksizeactive', false);
model.sol('sol1').feature('s1').feature('aDef').set('nullfun', 'auto');
model.sol('sol1').feature('s1').feature('aDef').set('assemtol', 0);
model.sol('sol1').feature('s1').create('fc1', 'FullyCoupled');
model.sol('sol1').feature('s1').feature('fc1').set('rstep', 10);
model.sol('sol1').feature('s1').feature('fc1').set('useminsteprecovery', 'auto');
model.sol('sol1').feature('s1').feature('fc1').set('maxiter', 50);
model.sol('sol1').feature('s1').feature('fc1').set('minstep', 1.0E-4);
model.sol('sol1').feature('s1').feature('fc1').set('dtech', 'auto');
model.sol('sol1').feature('s1').feature('fc1').set('ntolfact', 1);
model.sol('sol1').feature('s1').feature('fc1').set('ntermauto', 'tol');
model.sol('sol1').feature('s1').feature('fc1').set('initstep', 0.1);
model.sol('sol1').feature('s1').feature('fc1').set('minsteprecovery', 0.001);
model.sol('sol1').feature('s1').create('d1', 'Direct');
model.sol('sol1').feature('s1').feature('d1').set('linsolver', 'mumps');
model.sol('sol1').feature('s1').feature('d1').set('mumpsalloc', 1.2);
model.sol('sol1').feature('s1').feature('d1').set('ooc', 'off');
model.sol('sol1').feature('s1').feature('d1').set('errorchk', 'off');
model.sol('sol1').feature('s1').feature('fc1').set('linsolver', 'd1');
model.sol('sol1').feature('s1').feature('fc1').set('rstep', 10);
model.sol('sol1').feature('s1').feature('fc1').set('useminsteprecovery', 'auto');
model.sol('sol1').feature('s1').feature('fc1').set('maxiter', 50);
model.sol('sol1').feature('s1').feature('fc1').set('minstep', 1.0E-4);
model.sol('sol1').feature('s1').feature('fc1').set('dtech', 'auto');
model.sol('sol1').feature('s1').feature('fc1').set('ntolfact', 1);
model.sol('sol1').feature('s1').feature('fc1').set('ntermauto', 'tol');
model.sol('sol1').feature('s1').feature('fc1').set('initstep', 0.1);
model.sol('sol1').feature('s1').feature('fc1').set('minsteprecovery', 0.001);
model.sol('sol1').feature('s1').feature.remove('fcDef');
model.sol('sol1').attach('std1');
model.sol('sol1').feature('v1').set('scalemethod', 'none');
model.sol('sol1').feature('v1').feature('comp1_Ne').set('scalemethod', 'manual');
model.sol('sol1').feature('v1').feature('comp1_Ne').set('scaleval', '1.0e22');
model.sol('sol1').feature('v1').feature('comp1_Ph').set('scalemethod', 'manual');
model.sol('sol1').feature('v1').feature('comp1_Ph').set('scaleval', '1.0e4');
model.sol('sol1').feature('s1').set('stol', '1E-10');
model.sol('sol1').runAll;

model.study.create('std2');
model.study('std2').create('stat', 'Stationary');
model.study('std2').feature('stat').setSolveFor('/physics/semi', true);
model.study('std2').label('n-n : Thermionic Emission');
model.study('std2').setGenPlots(false);
model.study('std2').feature('stat').set('useadvanceddisable', true);
model.study('std2').feature('stat').set('disabledphysics', {'semi/adm3' 'semi/adm4'});
model.study('std2').feature('stat').set('useinitsol', true);
model.study('std2').feature('stat').set('initmethod', 'sol');
model.study('std2').feature('stat').set('initstudy', 'std1');
model.study('std2').feature('stat').set('solnum', 1);
model.study('std2').feature('stat').set('useparam', true);
model.study('std2').feature('stat').set('sweeptype', 'filled');
model.study('std2').feature('stat').setIndex('pname', 'sign', 0);
model.study('std2').feature('stat').setIndex('plistarr', '', 0);
model.study('std2').feature('stat').setIndex('punit', '', 0);
model.study('std2').feature('stat').setIndex('pname', 'sign', 0);
model.study('std2').feature('stat').setIndex('plistarr', '', 0);
model.study('std2').feature('stat').setIndex('punit', '', 0);
model.study('std2').feature('stat').setIndex('plistarr', '-1 1', 0);
model.study('std2').feature('stat').setIndex('pname', 'Va', 1);
model.study('std2').feature('stat').setIndex('plistarr', '', 1);
model.study('std2').feature('stat').setIndex('punit', 'V', 1);
model.study('std2').feature('stat').setIndex('pname', 'Va', 1);
model.study('std2').feature('stat').setIndex('plistarr', '', 1);
model.study('std2').feature('stat').setIndex('punit', 'V', 1);
model.study('std2').feature('stat').setIndex('plistarr', 'range(0.05,0.05,1)', 1);
model.study('std2').feature('stat').set('preusesol', 'auto');

model.sol.create('sol2');
model.sol('sol2').study('std2');
model.sol('sol2').create('st1', 'StudyStep');
model.sol('sol2').feature('st1').set('study', 'std2');
model.sol('sol2').feature('st1').set('studystep', 'stat');
model.sol('sol2').create('v1', 'Variables');
model.sol('sol2').feature('v1').set('control', 'stat');
model.sol('sol2').create('s1', 'Stationary');
model.sol('sol2').feature('s1').set('stol', 1.0E-6);
model.sol('sol2').feature('s1').create('p1', 'Parametric');
model.sol('sol2').feature('s1').feature.remove('pDef');
model.sol('sol2').feature('s1').feature('p1').set('porder', 'constant');
model.sol('sol2').feature('s1').feature('p1').set('control', 'stat');
model.sol('sol2').feature('s1').set('control', 'stat');
model.sol('sol2').feature('s1').feature('aDef').set('complexfun', false);
model.sol('sol2').feature('s1').feature('aDef').set('cachepattern', true);
model.sol('sol2').feature('s1').feature('aDef').set('matherr', true);
model.sol('sol2').feature('s1').feature('aDef').set('blocksizeactive', false);
model.sol('sol2').feature('s1').feature('aDef').set('nullfun', 'auto');
model.sol('sol2').feature('s1').feature('aDef').set('assemtol', 0);
model.sol('sol2').feature('s1').create('fc1', 'FullyCoupled');
model.sol('sol2').feature('s1').feature('fc1').set('rstep', 10);
model.sol('sol2').feature('s1').feature('fc1').set('useminsteprecovery', 'auto');
model.sol('sol2').feature('s1').feature('fc1').set('maxiter', 50);
model.sol('sol2').feature('s1').feature('fc1').set('minstep', 1.0E-4);
model.sol('sol2').feature('s1').feature('fc1').set('dtech', 'auto');
model.sol('sol2').feature('s1').feature('fc1').set('ntolfact', 1);
model.sol('sol2').feature('s1').feature('fc1').set('ntermauto', 'tol');
model.sol('sol2').feature('s1').feature('fc1').set('initstep', 0.1);
model.sol('sol2').feature('s1').feature('fc1').set('minsteprecovery', 0.001);
model.sol('sol2').feature('s1').create('d1', 'Direct');
model.sol('sol2').feature('s1').feature('d1').set('linsolver', 'mumps');
model.sol('sol2').feature('s1').feature('d1').set('mumpsalloc', 1.2);
model.sol('sol2').feature('s1').feature('d1').set('ooc', 'off');
model.sol('sol2').feature('s1').feature('d1').set('errorchk', 'off');
model.sol('sol2').feature('s1').feature('fc1').set('linsolver', 'd1');
model.sol('sol2').feature('s1').feature('fc1').set('rstep', 10);
model.sol('sol2').feature('s1').feature('fc1').set('useminsteprecovery', 'auto');
model.sol('sol2').feature('s1').feature('fc1').set('maxiter', 50);
model.sol('sol2').feature('s1').feature('fc1').set('minstep', 1.0E-4);
model.sol('sol2').feature('s1').feature('fc1').set('dtech', 'auto');
model.sol('sol2').feature('s1').feature('fc1').set('ntolfact', 1);
model.sol('sol2').feature('s1').feature('fc1').set('ntermauto', 'tol');
model.sol('sol2').feature('s1').feature('fc1').set('initstep', 0.1);
model.sol('sol2').feature('s1').feature('fc1').set('minsteprecovery', 0.001);
model.sol('sol2').feature('s1').feature.remove('fcDef');
model.sol('sol2').attach('std2');
model.sol('sol2').feature('s1').set('stol', '1E-10');
model.sol('sol2').runAll;

model.result.table.create('tbl1', 'Table');
model.result.table('tbl1').label('n-n : Cont.');
model.result.table('tbl1').importData('heterojunction_1d_case1_cont.txt');
model.result.table.create('tbl2', 'Table');
model.result.table('tbl2').label('n-n : TE');
model.result.table('tbl2').importData('heterojunction_1d_case1_te.txt');
model.result.create('pg1', 'PlotGroup1D');
model.result('pg1').run;
model.result('pg1').label('n-n : Jx Comparison');
model.result('pg1').set('data', 'none');
model.result('pg1').set('titletype', 'none');
model.result('pg1').set('xlabelactive', true);
model.result('pg1').set('xlabel', 'Va (V)');
model.result('pg1').set('ylabelactive', true);
model.result('pg1').set('ylabel', 'abs(Jx) (A/cm^2)');
model.result('pg1').set('legendpos', 'upperleft');
model.result('pg1').create('tblp1', 'Table');
model.result('pg1').feature('tblp1').set('markerpos', 'datapoints');
model.result('pg1').feature('tblp1').set('linewidth', 'preference');
model.result('pg1').feature('tblp1').set('linestyle', 'none');
model.result('pg1').feature('tblp1').set('linecolor', 'black');
model.result('pg1').feature('tblp1').set('linemarker', 'asterisk');
model.result('pg1').feature('tblp1').set('legend', true);
model.result('pg1').feature('tblp1').set('legendmethod', 'manual');
model.result('pg1').feature('tblp1').setIndex('legends', 'Reference Cont.', 0);
model.result('pg1').set('ylog', true);
model.result('pg1').feature.duplicate('tblp2', 'tblp1');
model.result('pg1').run;
model.result('pg1').feature('tblp2').set('table', 'tbl2');
model.result('pg1').feature('tblp2').set('linemarker', 'circle');
model.result('pg1').feature('tblp2').setIndex('legends', 'Reference TE', 0);
model.result('pg1').run;
model.result('pg1').create('ptgr1', 'PointGraph');
model.result('pg1').feature('ptgr1').set('markerpos', 'datapoints');
model.result('pg1').feature('ptgr1').set('linewidth', 'preference');
model.result('pg1').feature('ptgr1').set('data', 'dset1');
model.result('pg1').feature('ptgr1').selection.set([2]);
model.result('pg1').feature('ptgr1').set('expr', 'abs(semi.JX)');
model.result('pg1').feature('ptgr1').set('unit', 'A/cm^2');
model.result('pg1').feature('ptgr1').set('xdatasolnumtype', 'level1');
model.result('pg1').feature('ptgr1').set('linecolor', 'green');
model.result('pg1').feature.duplicate('ptgr2', 'ptgr1');
model.result('pg1').run;
model.result('pg1').feature('ptgr2').set('data', 'dset2');
model.result('pg1').feature('ptgr2').set('linecolor', 'blue');
model.result('pg1').run;
model.result('pg1').run;

model.study.create('std3');
model.study('std3').create('semie', 'SemiconductorEquilibrium');
model.study('std3').feature('semie').set('plotgroup', 'Default');
model.study('std3').feature('semie').set('solnum', 'auto');
model.study('std3').feature('semie').set('notsolnum', 'auto');
model.study('std3').feature('semie').set('outputmap', {});
model.study('std3').feature('semie').set('ngenAUX', '1');
model.study('std3').feature('semie').set('goalngenAUX', '1');
model.study('std3').feature('semie').set('ngenAUX', '1');
model.study('std3').feature('semie').set('goalngenAUX', '1');
model.study('std3').feature('semie').setSolveFor('/physics/semi', true);
model.study('std3').feature('semie').set('useadvanceddisable', true);
model.study('std3').feature('semie').set('disabledphysics', {'semi/adm1' 'semi/adm4'});
model.study('std3').label('p-n : Thermionic Emission');
model.study('std3').setGenPlots(false);
model.study('std3').create('stat', 'Stationary');
model.study('std3').feature('stat').set('useadvanceddisable', true);
model.study('std3').feature('stat').set('disabledphysics', {'semi/adm1' 'semi/adm4'});
model.study('std3').feature('stat').set('useparam', true);
model.study('std3').feature('stat').set('sweeptype', 'filled');
model.study('std3').feature('stat').setIndex('pname', 'sign', 0);
model.study('std3').feature('stat').setIndex('plistarr', '', 0);
model.study('std3').feature('stat').setIndex('punit', '', 0);
model.study('std3').feature('stat').setIndex('pname', 'sign', 0);
model.study('std3').feature('stat').setIndex('plistarr', '', 0);
model.study('std3').feature('stat').setIndex('punit', '', 0);
model.study('std3').feature('stat').setIndex('plistarr', '-1 1', 0);
model.study('std3').feature('stat').setIndex('pname', 'Va', 1);
model.study('std3').feature('stat').setIndex('plistarr', '', 1);
model.study('std3').feature('stat').setIndex('punit', 'V', 1);
model.study('std3').feature('stat').setIndex('pname', 'Va', 1);
model.study('std3').feature('stat').setIndex('plistarr', '', 1);
model.study('std3').feature('stat').setIndex('punit', 'V', 1);
model.study('std3').feature('stat').setIndex('plistarr', 'range(0.05,0.05,1.7)', 1);

model.sol.create('sol3');
model.sol('sol3').study('std3');
model.sol('sol3').create('st1', 'StudyStep');
model.sol('sol3').feature('st1').set('study', 'std3');
model.sol('sol3').feature('st1').set('studystep', 'semie');
model.sol('sol3').create('v1', 'Variables');
model.sol('sol3').feature('v1').set('control', 'semie');
model.sol('sol3').create('s1', 'Stationary');
model.sol('sol3').feature('s1').set('stol', 1.0E-6);
model.sol('sol3').feature('s1').feature('aDef').set('complexfun', false);
model.sol('sol3').feature('s1').feature('aDef').set('cachepattern', true);
model.sol('sol3').feature('s1').feature('aDef').set('matherr', true);
model.sol('sol3').feature('s1').feature('aDef').set('blocksizeactive', false);
model.sol('sol3').feature('s1').feature('aDef').set('nullfun', 'auto');
model.sol('sol3').feature('s1').feature('aDef').set('assemtol', 0);
model.sol('sol3').feature('s1').create('fc1', 'FullyCoupled');
model.sol('sol3').feature('s1').feature('fc1').set('rstep', 10);
model.sol('sol3').feature('s1').feature('fc1').set('useminsteprecovery', 'auto');
model.sol('sol3').feature('s1').feature('fc1').set('maxiter', 50);
model.sol('sol3').feature('s1').feature('fc1').set('minstep', 1.0E-4);
model.sol('sol3').feature('s1').feature('fc1').set('dtech', 'auto');
model.sol('sol3').feature('s1').feature('fc1').set('ntolfact', 1);
model.sol('sol3').feature('s1').feature('fc1').set('ntermauto', 'tol');
model.sol('sol3').feature('s1').feature('fc1').set('initstep', 0.1);
model.sol('sol3').feature('s1').feature('fc1').set('minsteprecovery', 0.001);
model.sol('sol3').feature('s1').create('d1', 'Direct');
model.sol('sol3').feature('s1').feature('d1').set('linsolver', 'mumps');
model.sol('sol3').feature('s1').feature('d1').set('mumpsalloc', 1.2);
model.sol('sol3').feature('s1').feature('d1').set('ooc', 'off');
model.sol('sol3').feature('s1').feature('d1').set('errorchk', 'off');
model.sol('sol3').feature('s1').feature('fc1').set('linsolver', 'd1');
model.sol('sol3').feature('s1').feature('fc1').set('rstep', 10);
model.sol('sol3').feature('s1').feature('fc1').set('useminsteprecovery', 'auto');
model.sol('sol3').feature('s1').feature('fc1').set('maxiter', 50);
model.sol('sol3').feature('s1').feature('fc1').set('minstep', 1.0E-4);
model.sol('sol3').feature('s1').feature('fc1').set('dtech', 'auto');
model.sol('sol3').feature('s1').feature('fc1').set('ntolfact', 1);
model.sol('sol3').feature('s1').feature('fc1').set('ntermauto', 'tol');
model.sol('sol3').feature('s1').feature('fc1').set('initstep', 0.1);
model.sol('sol3').feature('s1').feature('fc1').set('minsteprecovery', 0.001);
model.sol('sol3').feature('s1').feature.remove('fcDef');
model.sol('sol3').create('su1', 'StoreSolution');
model.sol('sol3').create('st2', 'StudyStep');
model.sol('sol3').feature('st2').set('study', 'std3');
model.sol('sol3').feature('st2').set('studystep', 'stat');
model.sol('sol3').create('v2', 'Variables');
model.sol('sol3').feature('v2').set('initmethod', 'sol');
model.sol('sol3').feature('v2').set('initsol', 'sol3');
model.sol('sol3').feature('v2').set('initsoluse', 'sol4');
model.sol('sol3').feature('v2').set('notsolmethod', 'sol');
model.sol('sol3').feature('v2').set('notsol', 'sol3');
model.sol('sol3').feature('v2').set('control', 'stat');
model.sol('sol3').create('s2', 'Stationary');
model.sol('sol3').feature('s2').set('stol', 1.0E-6);
model.sol('sol3').feature('s2').create('p1', 'Parametric');
model.sol('sol3').feature('s2').feature.remove('pDef');
model.sol('sol3').feature('s2').feature('p1').set('porder', 'constant');
model.sol('sol3').feature('s2').feature('p1').set('control', 'stat');
model.sol('sol3').feature('s2').set('control', 'stat');
model.sol('sol3').feature('s2').feature('aDef').set('complexfun', false);
model.sol('sol3').feature('s2').feature('aDef').set('cachepattern', true);
model.sol('sol3').feature('s2').feature('aDef').set('matherr', true);
model.sol('sol3').feature('s2').feature('aDef').set('blocksizeactive', false);
model.sol('sol3').feature('s2').feature('aDef').set('nullfun', 'auto');
model.sol('sol3').feature('s2').feature('aDef').set('assemtol', 0);
model.sol('sol3').feature('s2').create('fc1', 'FullyCoupled');
model.sol('sol3').feature('s2').feature('fc1').set('rstep', 10);
model.sol('sol3').feature('s2').feature('fc1').set('useminsteprecovery', 'auto');
model.sol('sol3').feature('s2').feature('fc1').set('maxiter', 50);
model.sol('sol3').feature('s2').feature('fc1').set('minstep', 1.0E-4);
model.sol('sol3').feature('s2').feature('fc1').set('dtech', 'auto');
model.sol('sol3').feature('s2').feature('fc1').set('ntolfact', 1);
model.sol('sol3').feature('s2').feature('fc1').set('ntermauto', 'tol');
model.sol('sol3').feature('s2').feature('fc1').set('initstep', 0.1);
model.sol('sol3').feature('s2').feature('fc1').set('minsteprecovery', 0.001);
model.sol('sol3').feature('s2').create('d1', 'Direct');
model.sol('sol3').feature('s2').feature('d1').set('linsolver', 'mumps');
model.sol('sol3').feature('s2').feature('d1').set('mumpsalloc', 1.2);
model.sol('sol3').feature('s2').feature('d1').set('ooc', 'off');
model.sol('sol3').feature('s2').feature('d1').set('errorchk', 'off');
model.sol('sol3').feature('s2').feature('fc1').set('linsolver', 'd1');
model.sol('sol3').feature('s2').feature('fc1').set('rstep', 10);
model.sol('sol3').feature('s2').feature('fc1').set('useminsteprecovery', 'auto');
model.sol('sol3').feature('s2').feature('fc1').set('maxiter', 50);
model.sol('sol3').feature('s2').feature('fc1').set('minstep', 1.0E-4);
model.sol('sol3').feature('s2').feature('fc1').set('dtech', 'auto');
model.sol('sol3').feature('s2').feature('fc1').set('ntolfact', 1);
model.sol('sol3').feature('s2').feature('fc1').set('ntermauto', 'tol');
model.sol('sol3').feature('s2').feature('fc1').set('initstep', 0.1);
model.sol('sol3').feature('s2').feature('fc1').set('minsteprecovery', 0.001);
model.sol('sol3').feature('s2').feature.remove('fcDef');
model.sol('sol3').feature('v2').set('notsolnum', 'auto');
model.sol('sol3').feature('v2').set('notsolvertype', 'solnum');
model.sol('sol3').attach('std3');
model.sol('sol3').feature('s2').set('stol', '1E-10');
model.sol('sol3').runAll;

model.result.table.create('tbl3', 'Table');
model.result.table('tbl3').label('p-n : TE');
model.result.table('tbl3').importData('heterojunction_1d_case2_te.txt');
model.result.create('pg2', 'PlotGroup1D');
model.result('pg2').run;
model.result('pg2').label('p-n : Jx Comparison');
model.result('pg2').set('titletype', 'none');
model.result('pg2').set('xlabelactive', true);
model.result('pg2').set('xlabel', 'Va (V)');
model.result('pg2').set('ylabelactive', true);
model.result('pg2').set('ylabel', 'abs(Jx) (A/cm^2)');
model.result('pg2').set('legendpos', 'upperleft');
model.result('pg2').create('tblp1', 'Table');
model.result('pg2').feature('tblp1').set('markerpos', 'datapoints');
model.result('pg2').feature('tblp1').set('linewidth', 'preference');
model.result('pg2').feature('tblp1').set('table', 'tbl3');
model.result('pg2').feature('tblp1').set('linestyle', 'none');
model.result('pg2').feature('tblp1').set('linecolor', 'black');
model.result('pg2').feature('tblp1').set('linemarker', 'circle');
model.result('pg2').feature('tblp1').set('legend', true);
model.result('pg2').feature('tblp1').set('legendmethod', 'manual');
model.result('pg2').feature('tblp1').setIndex('legends', 'Reference TE', 0);
model.result('pg2').set('ylog', true);
model.result('pg2').run;
model.result('pg2').create('ptgr1', 'PointGraph');
model.result('pg2').feature('ptgr1').set('markerpos', 'datapoints');
model.result('pg2').feature('ptgr1').set('linewidth', 'preference');
model.result('pg2').feature('ptgr1').set('data', 'dset3');
model.result('pg2').feature('ptgr1').selection.set([2]);
model.result('pg2').feature('ptgr1').set('expr', 'abs(semi.JX)');
model.result('pg2').feature('ptgr1').set('unit', 'A/cm^2');
model.result('pg2').feature('ptgr1').set('linecolor', 'blue');
model.result('pg2').run;
model.result('pg2').run;

model.physics('semi').prop('Continuation').set('cp', 'ramp');
model.physics('semi').prop('Continuation').set('DopingTrapDensityContinuation', 'Interface');
model.physics('semi').feature('cont2').set('ContinuationType', 'Interface');

model.study.create('std4');
model.study('std4').create('stat', 'Stationary');
model.study('std4').feature('stat').setSolveFor('/physics/semi', true);
model.study('std4').label('n-p : Thermionic Emission');
model.study('std4').setGenPlots(false);
model.study('std4').feature('stat').set('useadvanceddisable', true);
model.study('std4').feature('stat').set('disabledphysics', {'semi/adm2' 'semi/adm3'});
model.study('std4').feature('stat').set('useparam', true);
model.study('std4').feature('stat').setIndex('pname', 'sign', 0);
model.study('std4').feature('stat').setIndex('plistarr', '', 0);
model.study('std4').feature('stat').setIndex('punit', '', 0);
model.study('std4').feature('stat').setIndex('pname', 'sign', 0);
model.study('std4').feature('stat').setIndex('plistarr', '', 0);
model.study('std4').feature('stat').setIndex('punit', '', 0);
model.study('std4').feature('stat').setIndex('pname', 'ramp', 0);
model.study('std4').feature('stat').setIndex('plistarr', '1e-8 1e-6 1e-4 1e-2  0.1 0.25 0.5 0.75 1', 0);
model.study('std4').create('stat2', 'Stationary');
model.study('std4').feature('stat2').set('useadvanceddisable', true);
model.study('std4').feature('stat2').set('disabledphysics', {'semi/adm2' 'semi/adm3'});
model.study('std4').feature('stat2').set('useparam', true);
model.study('std4').feature('stat2').set('sweeptype', 'filled');
model.study('std4').feature('stat2').setIndex('pname', 'sign', 0);
model.study('std4').feature('stat2').setIndex('plistarr', '', 0);
model.study('std4').feature('stat2').setIndex('punit', '', 0);
model.study('std4').feature('stat2').setIndex('pname', 'sign', 0);
model.study('std4').feature('stat2').setIndex('plistarr', '', 0);
model.study('std4').feature('stat2').setIndex('punit', '', 0);
model.study('std4').feature('stat2').setIndex('plistarr', '1 -1', 0);
model.study('std4').feature('stat2').setIndex('pname', 'Va', 1);
model.study('std4').feature('stat2').setIndex('plistarr', '', 1);
model.study('std4').feature('stat2').setIndex('punit', 'V', 1);
model.study('std4').feature('stat2').setIndex('pname', 'Va', 1);
model.study('std4').feature('stat2').setIndex('plistarr', '', 1);
model.study('std4').feature('stat2').setIndex('punit', 'V', 1);
model.study('std4').feature('stat2').setIndex('plistarr', 'range(0.05,0.05,1.7)', 1);
model.study('std4').feature('stat2').set('preusesol', 'auto');

model.sol.create('sol5');
model.sol('sol5').study('std4');
model.sol('sol5').create('st1', 'StudyStep');
model.sol('sol5').feature('st1').set('study', 'std4');
model.sol('sol5').feature('st1').set('studystep', 'stat');
model.sol('sol5').create('v1', 'Variables');
model.sol('sol5').feature('v1').set('control', 'stat');
model.sol('sol5').create('s1', 'Stationary');
model.sol('sol5').feature('s1').set('stol', 1.0E-6);
model.sol('sol5').feature('s1').create('p1', 'Parametric');
model.sol('sol5').feature('s1').feature.remove('pDef');
model.sol('sol5').feature('s1').feature('p1').set('porder', 'constant');
model.sol('sol5').feature('s1').feature('p1').set('control', 'stat');
model.sol('sol5').feature('s1').set('control', 'stat');
model.sol('sol5').feature('s1').feature('aDef').set('complexfun', false);
model.sol('sol5').feature('s1').feature('aDef').set('cachepattern', true);
model.sol('sol5').feature('s1').feature('aDef').set('matherr', true);
model.sol('sol5').feature('s1').feature('aDef').set('blocksizeactive', false);
model.sol('sol5').feature('s1').feature('aDef').set('nullfun', 'auto');
model.sol('sol5').feature('s1').feature('aDef').set('assemtol', 0);
model.sol('sol5').feature('s1').create('fc1', 'FullyCoupled');
model.sol('sol5').feature('s1').feature('fc1').set('rstep', 10);
model.sol('sol5').feature('s1').feature('fc1').set('useminsteprecovery', 'auto');
model.sol('sol5').feature('s1').feature('fc1').set('maxiter', 50);
model.sol('sol5').feature('s1').feature('fc1').set('minstep', 1.0E-4);
model.sol('sol5').feature('s1').feature('fc1').set('dtech', 'auto');
model.sol('sol5').feature('s1').feature('fc1').set('ntolfact', 1);
model.sol('sol5').feature('s1').feature('fc1').set('ntermauto', 'tol');
model.sol('sol5').feature('s1').feature('fc1').set('initstep', 0.1);
model.sol('sol5').feature('s1').feature('fc1').set('minsteprecovery', 0.001);
model.sol('sol5').feature('s1').create('d1', 'Direct');
model.sol('sol5').feature('s1').feature('d1').set('linsolver', 'mumps');
model.sol('sol5').feature('s1').feature('d1').set('mumpsalloc', 1.2);
model.sol('sol5').feature('s1').feature('d1').set('ooc', 'off');
model.sol('sol5').feature('s1').feature('d1').set('errorchk', 'off');
model.sol('sol5').feature('s1').feature('fc1').set('linsolver', 'd1');
model.sol('sol5').feature('s1').feature('fc1').set('rstep', 10);
model.sol('sol5').feature('s1').feature('fc1').set('useminsteprecovery', 'auto');
model.sol('sol5').feature('s1').feature('fc1').set('maxiter', 50);
model.sol('sol5').feature('s1').feature('fc1').set('minstep', 1.0E-4);
model.sol('sol5').feature('s1').feature('fc1').set('dtech', 'auto');
model.sol('sol5').feature('s1').feature('fc1').set('ntolfact', 1);
model.sol('sol5').feature('s1').feature('fc1').set('ntermauto', 'tol');
model.sol('sol5').feature('s1').feature('fc1').set('initstep', 0.1);
model.sol('sol5').feature('s1').feature('fc1').set('minsteprecovery', 0.001);
model.sol('sol5').feature('s1').feature.remove('fcDef');
model.sol('sol5').create('su1', 'StoreSolution');
model.sol('sol5').create('st2', 'StudyStep');
model.sol('sol5').feature('st2').set('study', 'std4');
model.sol('sol5').feature('st2').set('studystep', 'stat2');
model.sol('sol5').create('v2', 'Variables');
model.sol('sol5').feature('v2').set('initmethod', 'sol');
model.sol('sol5').feature('v2').set('initsol', 'sol5');
model.sol('sol5').feature('v2').set('initsoluse', 'sol6');
model.sol('sol5').feature('v2').set('notsolmethod', 'sol');
model.sol('sol5').feature('v2').set('notsol', 'sol5');
model.sol('sol5').feature('v2').set('control', 'stat2');
model.sol('sol5').create('s2', 'Stationary');
model.sol('sol5').feature('s2').set('stol', 1.0E-6);
model.sol('sol5').feature('s2').create('p1', 'Parametric');
model.sol('sol5').feature('s2').feature.remove('pDef');
model.sol('sol5').feature('s2').feature('p1').set('porder', 'constant');
model.sol('sol5').feature('s2').feature('p1').set('control', 'stat2');
model.sol('sol5').feature('s2').set('control', 'stat2');
model.sol('sol5').feature('s2').feature('aDef').set('complexfun', false);
model.sol('sol5').feature('s2').feature('aDef').set('cachepattern', true);
model.sol('sol5').feature('s2').feature('aDef').set('matherr', true);
model.sol('sol5').feature('s2').feature('aDef').set('blocksizeactive', false);
model.sol('sol5').feature('s2').feature('aDef').set('nullfun', 'auto');
model.sol('sol5').feature('s2').feature('aDef').set('assemtol', 0);
model.sol('sol5').feature('s2').create('fc1', 'FullyCoupled');
model.sol('sol5').feature('s2').feature('fc1').set('rstep', 10);
model.sol('sol5').feature('s2').feature('fc1').set('useminsteprecovery', 'auto');
model.sol('sol5').feature('s2').feature('fc1').set('maxiter', 50);
model.sol('sol5').feature('s2').feature('fc1').set('minstep', 1.0E-4);
model.sol('sol5').feature('s2').feature('fc1').set('dtech', 'auto');
model.sol('sol5').feature('s2').feature('fc1').set('ntolfact', 1);
model.sol('sol5').feature('s2').feature('fc1').set('ntermauto', 'tol');
model.sol('sol5').feature('s2').feature('fc1').set('initstep', 0.1);
model.sol('sol5').feature('s2').feature('fc1').set('minsteprecovery', 0.001);
model.sol('sol5').feature('s2').create('d1', 'Direct');
model.sol('sol5').feature('s2').feature('d1').set('linsolver', 'mumps');
model.sol('sol5').feature('s2').feature('d1').set('mumpsalloc', 1.2);
model.sol('sol5').feature('s2').feature('d1').set('ooc', 'off');
model.sol('sol5').feature('s2').feature('d1').set('errorchk', 'off');
model.sol('sol5').feature('s2').feature('fc1').set('linsolver', 'd1');
model.sol('sol5').feature('s2').feature('fc1').set('rstep', 10);
model.sol('sol5').feature('s2').feature('fc1').set('useminsteprecovery', 'auto');
model.sol('sol5').feature('s2').feature('fc1').set('maxiter', 50);
model.sol('sol5').feature('s2').feature('fc1').set('minstep', 1.0E-4);
model.sol('sol5').feature('s2').feature('fc1').set('dtech', 'auto');
model.sol('sol5').feature('s2').feature('fc1').set('ntolfact', 1);
model.sol('sol5').feature('s2').feature('fc1').set('ntermauto', 'tol');
model.sol('sol5').feature('s2').feature('fc1').set('initstep', 0.1);
model.sol('sol5').feature('s2').feature('fc1').set('minsteprecovery', 0.001);
model.sol('sol5').feature('s2').feature.remove('fcDef');
model.sol('sol5').feature('v2').set('notsolnum', 'auto');
model.sol('sol5').feature('v2').set('notsolvertype', 'solnum');
model.sol('sol5').attach('std4');
model.sol('sol5').feature('s2').set('stol', '1E-10');
model.sol('sol5').runAll;

model.result.table.create('tbl4', 'Table');
model.result.table('tbl4').label('n-p : TE');
model.result.table('tbl4').importData('heterojunction_1d_case3_te.txt');
model.result.create('pg3', 'PlotGroup1D');
model.result('pg3').run;
model.result('pg3').label('n-p : Jx Comparison');
model.result('pg3').set('titletype', 'none');
model.result('pg3').set('xlabelactive', true);
model.result('pg3').set('xlabel', 'Va (V)');
model.result('pg3').set('ylabelactive', true);
model.result('pg3').set('ylabel', 'abs(Jx) (A/cm^2)');
model.result('pg3').set('legendpos', 'upperleft');
model.result('pg3').create('tblp1', 'Table');
model.result('pg3').feature('tblp1').set('markerpos', 'datapoints');
model.result('pg3').feature('tblp1').set('linewidth', 'preference');
model.result('pg3').feature('tblp1').set('table', 'tbl4');
model.result('pg3').feature('tblp1').set('linestyle', 'none');
model.result('pg3').feature('tblp1').set('linecolor', 'black');
model.result('pg3').feature('tblp1').set('linemarker', 'circle');
model.result('pg3').feature('tblp1').set('legend', true);
model.result('pg3').feature('tblp1').set('legendmethod', 'manual');
model.result('pg3').feature('tblp1').setIndex('legends', 'Reference TE', 0);
model.result('pg3').set('ylog', true);
model.result('pg3').run;
model.result('pg3').create('ptgr1', 'PointGraph');
model.result('pg3').feature('ptgr1').set('markerpos', 'datapoints');
model.result('pg3').feature('ptgr1').set('linewidth', 'preference');
model.result('pg3').feature('ptgr1').set('data', 'dset5');
model.result('pg3').feature('ptgr1').selection.set([2]);
model.result('pg3').feature('ptgr1').set('expr', 'abs(semi.JX)');
model.result('pg3').feature('ptgr1').set('unit', 'A/cm^2');
model.result('pg3').feature('ptgr1').set('linecolor', 'blue');
model.result('pg3').run;
model.result('pg3').run;
model.result.create('pg4', 'PlotGroup1D');
model.result('pg4').run;
model.result('pg4').label('n-n : Energy Diagram');
model.result('pg4').set('data', 'dset2');
model.result('pg4').setIndex('looplevelinput', 'last', 1);
model.result('pg4').setIndex('looplevelinput', 'first', 0);
model.result('pg4').set('titletype', 'none');
model.result('pg4').set('legendpos', 'lowerright');
model.result('pg4').create('lngr1', 'LineGraph');
model.result('pg4').feature('lngr1').set('markerpos', 'datapoints');
model.result('pg4').feature('lngr1').set('linewidth', 'preference');
model.result('pg4').feature('lngr1').selection.all;
model.result('pg4').feature('lngr1').set('expr', 'semi.Ec_e');
model.result('pg4').feature('lngr1').set('descr', 'Conduction band energy level');
model.result('pg4').feature('lngr1').set('unit', 'eV');
model.result('pg4').feature('lngr1').set('xdata', 'expr');
model.result('pg4').feature('lngr1').set('xdataexpr', 'x');
model.result('pg4').feature('lngr1').set('linecolor', 'blue');
model.result('pg4').feature('lngr1').set('legend', true);
model.result('pg4').feature('lngr1').set('legendmethod', 'manual');
model.result('pg4').feature('lngr1').setIndex('legends', 'Ec', 0);
model.result('pg4').feature.duplicate('lngr2', 'lngr1');
model.result('pg4').run;
model.result('pg4').feature('lngr2').set('expr', 'semi.Efn_e');
model.result('pg4').feature('lngr2').set('descr', 'Electron quasi-Fermi energy level');
model.result('pg4').feature('lngr2').set('linestyle', 'dashed');
model.result('pg4').feature('lngr2').set('linecolor', 'black');
model.result('pg4').feature('lngr2').setIndex('legends', 'Efn', 0);
model.result('pg4').feature.duplicate('lngr3', 'lngr2');
model.result('pg4').run;
model.result('pg4').feature('lngr3').set('expr', 'semi.Efp_e');
model.result('pg4').feature('lngr3').set('descr', 'Hole quasi-Fermi energy level');
model.result('pg4').feature('lngr3').set('linestyle', 'dotted');
model.result('pg4').feature('lngr3').setIndex('legends', 'Efp', 0);
model.result('pg4').feature.duplicate('lngr4', 'lngr3');
model.result('pg4').run;
model.result('pg4').feature('lngr4').set('expr', 'semi.Ev_e');
model.result('pg4').feature('lngr4').set('descr', 'Valence band energy level');
model.result('pg4').feature('lngr4').set('linestyle', 'solid');
model.result('pg4').feature('lngr4').set('linecolor', 'green');
model.result('pg4').feature('lngr4').setIndex('legends', 'Ev', 0);
model.result('pg4').run;
model.result('pg4').set('ylabelactive', true);
model.result('pg4').set('ylabel', 'Energy (eV)');
model.result('pg4').set('xlabelactive', true);
model.result('pg4').run;
model.result.duplicate('pg5', 'pg4');
model.result('pg5').run;
model.result('pg5').label('p-n : Energy Diagram');
model.result('pg5').set('data', 'dset3');
model.result('pg5').setIndex('looplevelinput', 'manual', 0);
model.result('pg5').setIndex('looplevel', [21], 0);
model.result('pg5').run;
model.result.duplicate('pg6', 'pg5');
model.result('pg6').run;
model.result('pg6').label('n-p : Energy Diagram');
model.result('pg6').set('data', 'dset5');
model.result('pg6').run;

model.title('Heterojunction 1D');

model.description('This benchmark model simulates three different heterojunction configurations under forward and reverse bias. It shows the difference in using the continuous quasi-Fermi level formulation versus the thermionic emission formulation for the charge transfer across the heterojunction. The simulated energy levels are compared between each configuration in order to illustrate the origin of the charge transfer, that is, whether it is primarily from holes in the valence band or from electrons in the conduction band. The computed I-V curves for each configuration are compared with results from the literature. Several methods for better convergence are demonstrated in the setup of the various study steps.');

model.label('heterojunction_1d.mph');

model.modelNode.label('Components');

out = model;
