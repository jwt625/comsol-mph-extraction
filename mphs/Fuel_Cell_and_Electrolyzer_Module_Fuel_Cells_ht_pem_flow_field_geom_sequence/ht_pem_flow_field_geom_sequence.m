function out = model
%
% ht_pem_flow_field_geom_sequence.m
%
% Model exported on May 26 2025, 21:28 by COMSOL 6.2.0.339.

import com.comsol.model.*
import com.comsol.model.util.*

model = ModelUtil.create('Model');

model.modelPath('/Applications/COMSOL62/Multiphysics/applications/Fuel_Cell_and_Electrolyzer_Module/Fuel_Cells');

model.modelNode.create('comp1', true);

model.geom.create('geom1', 3);
model.geom('geom1').model('comp1');

model.mesh.create('mesh1', 'geom1');

% To import content from file, use:
% model.param.loadFile('FILENAME');
model.param.set('W_rib', '0.7[mm]', 'Rib width');
model.param.set('W_ch', '0.8[mm]', 'Channel width');
model.param.set('W_plate', '50[mm]', 'Plate width');
model.param.set('H_ch', 'W_ch', 'Channel height');
model.param.set('H_gdl', '0.38[mm]', 'Gdl height');
model.param.set('H_mem', '100[um]', 'Membrane thickness');
model.param.set('W_ribch', 'W_rib+W_ch', 'Channel-to-channel distance');
model.param.set('N_ch', '3', 'Number of channels');
model.param.set('r_ch', '0.25[mm]', 'Inner radius of channel corners');

model.geom('geom1').create('wp1', 'WorkPlane');
model.geom('geom1').feature('wp1').set('unite', true);
model.geom('geom1').feature('wp1').set('quickz', 'H_gdl+H_mem/2');
model.geom('geom1').feature('wp1').geom.create('r1', 'Rectangle');
model.geom('geom1').feature('wp1').geom.feature('r1').set('size', {'W_ch' 'W_plate-W_rib'});
model.geom('geom1').feature('wp1').geom.feature('r1').set('pos', {'W_rib/2-N_ch*W_ribch' '0'});
model.geom('geom1').feature('wp1').geom.feature('r1').setIndex('pos', 'W_rib/2', 1);
model.geom('geom1').feature('wp1').geom.run('r1');
model.geom('geom1').feature('wp1').geom.create('arr1', 'Array');
model.geom('geom1').feature('wp1').geom.feature('arr1').selection('input').set({'r1'});
model.geom('geom1').feature('wp1').geom.feature('arr1').set('fullsize', {'N_ch*2' '1'});
model.geom('geom1').feature('wp1').geom.feature('arr1').set('displ', {'W_ribch' '0'});
model.geom('geom1').feature('wp1').geom.run('arr1');
model.geom('geom1').feature('wp1').geom.create('r2', 'Rectangle');
model.geom('geom1').feature('wp1').geom.feature('r2').set('size', {'2*N_ch*W_ribch' '1'});
model.geom('geom1').feature('wp1').geom.feature('r2').setIndex('size', 'W_ch', 1);
model.geom('geom1').feature('wp1').geom.feature('r2').set('pos', {'-N_ch*W_ribch' '0'});
model.geom('geom1').feature('wp1').geom.feature('r2').setIndex('pos', 'W_rib/2', 1);
model.geom('geom1').feature('wp1').geom.run('r2');
model.geom('geom1').feature('wp1').geom.create('arr2', 'Array');
model.geom('geom1').feature('wp1').geom.feature('arr2').selection('input').set({'r2'});
model.geom('geom1').feature('wp1').geom.feature('arr2').set('fullsize', {'1' 'N_ch'});
model.geom('geom1').feature('wp1').geom.feature('arr2').set('displ', {'0' 'W_ribch'});
model.geom('geom1').feature('wp1').geom.run('arr2');
model.geom('geom1').feature('wp1').geom.create('mir1', 'Mirror');
model.geom('geom1').feature('wp1').geom.feature('mir1').selection('input').set({'arr2'});
model.geom('geom1').feature('wp1').geom.feature('mir1').set('keep', true);
model.geom('geom1').feature('wp1').geom.feature('mir1').set('pos', {'0' 'W_plate/2'});
model.geom('geom1').feature('wp1').geom.feature('mir1').set('axis', [0 1]);
model.geom('geom1').feature('wp1').geom.run('mir1');
model.geom('geom1').feature('wp1').geom.create('sq1', 'Square');
model.geom('geom1').feature('wp1').geom.feature('sq1').set('size', 'sqrt(2)*W_ribch*(N_ch+1)');
model.geom('geom1').feature('wp1').geom.feature('sq1').set('rot', 45);
model.geom('geom1').feature('wp1').geom.run('sq1');
model.geom('geom1').feature('wp1').geom.feature.duplicate('sq2', 'sq1');
model.geom('geom1').feature('wp1').geom.feature('sq2').set('rot', '45+90');
model.geom('geom1').feature('wp1').geom.run('sq2');
model.geom('geom1').feature('wp1').geom.feature.duplicate('sq3', 'sq2');
model.geom('geom1').feature('wp1').geom.feature('sq3').set('rot', '45-90');
model.geom('geom1').feature('wp1').geom.run('sq3');
model.geom('geom1').feature('wp1').geom.create('copy1', 'Copy');
model.geom('geom1').feature('wp1').geom.feature('copy1').selection('input').set({'sq1' 'sq2' 'sq3'});
model.geom('geom1').feature('wp1').geom.feature('copy1').set('disply', 'W_plate-(+W_ribch*(N_ch))');
model.geom('geom1').feature('wp1').geom.run('copy1');
model.geom('geom1').feature('wp1').geom.create('dif1', 'Difference');
model.geom('geom1').feature('wp1').geom.feature('dif1').selection('input').set({'arr2'});
model.geom('geom1').feature('wp1').geom.feature('dif1').selection('input2').set({'sq1'});
model.geom('geom1').feature('wp1').geom.run('dif1');
model.geom('geom1').feature('wp1').geom.create('dif2', 'Difference');
model.geom('geom1').feature('wp1').geom.feature('dif2').selection('input').set({'mir1'});
model.geom('geom1').feature('wp1').geom.feature('dif2').selection('input2').set({'copy1(2)' 'copy1(3)'});
model.geom('geom1').feature('wp1').geom.run('dif2');
model.geom('geom1').feature('wp1').geom.create('dif3', 'Difference');
model.geom('geom1').feature('wp1').geom.feature('dif3').selection('input').set({'arr1'});
model.geom('geom1').feature('wp1').geom.feature('dif3').selection('input2').set({'copy1(1)' 'sq2' 'sq3'});
model.geom('geom1').feature('wp1').geom.run('dif3');
model.geom('geom1').feature('wp1').geom.create('uni1', 'Union');
model.geom('geom1').feature('wp1').geom.feature('uni1').selection('input').set({'dif1' 'dif2' 'dif3'});
model.geom('geom1').feature('wp1').geom.feature('uni1').set('intbnd', false);
model.geom('geom1').feature('wp1').geom.run('uni1');
model.geom('geom1').feature('wp1').geom.create('fil1', 'Fillet');
model.geom('geom1').feature('wp1').geom.feature('fil1').selection('point').set('uni1', [7 10 11 14 15 18 20 21 24 25 28 29]);
model.geom('geom1').feature('wp1').geom.feature('fil1').set('radius', 'r_ch');
model.geom('geom1').feature('wp1').geom.run('fil1');
model.geom('geom1').feature('wp1').geom.create('fil2', 'Fillet');
model.geom('geom1').feature('wp1').geom.feature('fil2').selection('point').set('fil1', [9 10 15 16 21 22 26 29 32 35 38 41]);
model.geom('geom1').feature('wp1').geom.feature('fil2').set('radius', 'W_ch+r_ch');
model.geom('geom1').feature('wp1').geom.run('fil2');
model.geom('geom1').run('wp1');
model.geom('geom1').feature.create('ext1', 'Extrude');
model.geom('geom1').feature('ext1').label('Channels');
model.geom('geom1').feature('ext1').setIndex('distance', 'H_ch', 0);
model.geom('geom1').feature('ext1').set('selresult', true);
model.geom('geom1').feature('ext1').set('selresultshow', 'all');
model.geom('geom1').run('ext1');
model.geom('geom1').create('wp2', 'WorkPlane');
model.geom('geom1').feature('wp2').set('unite', true);
model.geom('geom1').feature('wp2').set('quickplane', 'zx');
model.geom('geom1').feature('wp2').set('quicky', 'N_ch*W_ribch+W_ch');
model.geom('geom1').run('wp2');
model.geom('geom1').create('pard1', 'PartitionDomains');
model.geom('geom1').feature('pard1').selection('domain').named('ext1');
model.geom('geom1').run('pard1');
model.geom('geom1').create('wp3', 'WorkPlane');
model.geom('geom1').feature('wp3').set('unite', true);
model.geom('geom1').feature('wp3').set('quickplane', 'zx');
model.geom('geom1').feature('wp3').set('quicky', 'W_plate-N_ch*W_ribch-W_ch');
model.geom('geom1').run('wp3');
model.geom('geom1').create('pard2', 'PartitionDomains');
model.geom('geom1').feature('pard2').selection('domain').named('ext1');
model.geom('geom1').run('pard2');
model.geom('geom1').create('boxsel1', 'BoxSelection');
model.geom('geom1').feature('boxsel1').label('Channel Sweep Mesh Domains');
model.geom('geom1').feature('boxsel1').set('ymin', 'N_ch*W_ribch-W_ch');
model.geom('geom1').feature('boxsel1').set('ymax', 'W_plate-N_ch*W_ribch+W_ch');
model.geom('geom1').feature('boxsel1').set('condition', 'inside');
model.geom('geom1').run('boxsel1');
model.geom('geom1').create('difsel1', 'DifferenceSelection');
model.geom('geom1').feature('difsel1').label('Channel Tet Mesh Domains');
model.geom('geom1').feature('difsel1').set('add', {'ext1'});
model.geom('geom1').feature('difsel1').set('subtract', {'boxsel1'});
model.geom('geom1').run('difsel1');
model.geom('geom1').create('blk1', 'Block');
model.geom('geom1').feature('blk1').label('GDL');
model.geom('geom1').feature('blk1').set('size', {'2*N_ch*W_ribch' '1' '1'});
model.geom('geom1').feature('blk1').setIndex('size', 'W_plate', 1);
model.geom('geom1').feature('blk1').setIndex('size', 'H_gdl', 2);
model.geom('geom1').feature('blk1').set('pos', {'-N_ch*W_ribch' '0' '0'});
model.geom('geom1').feature('blk1').setIndex('pos', 'H_mem/2', 2);
model.geom('geom1').feature('blk1').set('selresult', true);
model.geom('geom1').run('blk1');
model.geom('geom1').feature.create('ext2', 'Extrude');
model.geom('geom1').feature('ext2').label('Membrane');
model.geom('geom1').feature('ext2').set('extrudefrom', 'faces');
model.geom('geom1').feature('ext2').selection('inputface').set('blk1', 1);
model.geom('geom1').feature('ext2').set('inputhandling', 'keep');
model.geom('geom1').feature('ext2').setIndex('distance', 'H_mem/2', 0);
model.geom('geom1').feature('ext2').set('selresult', true);
model.geom('geom1').run('ext2');
model.geom('geom1').create('uni1', 'Union');
model.geom('geom1').feature('uni1').selection('input').set({'blk1' 'ext2' 'pard2'});
model.geom('geom1').run('uni1');
model.geom('geom1').create('rot1', 'Rotate');
model.geom('geom1').feature('rot1').selection('input').set({'uni1'});
model.geom('geom1').feature('rot1').set('keep', true);
model.geom('geom1').feature('rot1').set('axistype', 'x');
model.geom('geom1').feature('rot1').set('rot', 180);
model.geom('geom1').feature('rot1').set('pos', {'0' 'W_plate/2' '0'});
model.geom('geom1').run('rot1');
model.geom('geom1').create('boxsel2', 'BoxSelection');
model.geom('geom1').feature('boxsel2').label('H2 Side Domains');
model.geom('geom1').feature('boxsel2').set('zmax', '-H_mem/4');
model.geom('geom1').run('boxsel2');
model.geom('geom1').create('intsel1', 'IntersectionSelection');
model.geom('geom1').feature('intsel1').label('H2 Flow Channels');
model.geom('geom1').feature('intsel1').set('input', {'ext1' 'boxsel2'});
model.geom('geom1').run('intsel1');
model.geom('geom1').create('del1', 'Delete');
model.geom('geom1').feature('del1').selection('input').init(3);
model.geom('geom1').feature('del1').selection('input').named('intsel1');
model.geom('geom1').run('del1');
model.geom('geom1').create('boxsel3', 'BoxSelection');
model.geom('geom1').feature('boxsel3').label('Upper GDL Boundary');
model.geom('geom1').feature('boxsel3').set('entitydim', 2);
model.geom('geom1').feature('boxsel3').set('zmin', 'H_gdl/2+H_mem/2');
model.geom('geom1').feature('boxsel3').set('zmax', 'H_gdl*3/2+H_mem');
model.geom('geom1').feature('boxsel3').set('condition', 'inside');
model.geom('geom1').run('boxsel3');
model.geom('geom1').create('difsel2', 'DifferenceSelection');
model.geom('geom1').feature('difsel2').label('O2 Current Collector');
model.geom('geom1').feature('difsel2').set('entitydim', 2);
model.geom('geom1').feature('difsel2').set('add', {'boxsel3'});
model.geom('geom1').feature('difsel2').set('subtract', {'ext1'});
model.geom('geom1').run('difsel2');
model.geom('geom1').create('parf1', 'PartitionFaces');
model.geom('geom1').feature('parf1').selection('face').named('difsel2');
model.geom('geom1').feature('parf1').set('partitionwith', 'workplane');
model.geom('geom1').run('parf1');
model.geom('geom1').feature.duplicate('parf2', 'parf1');
model.geom('geom1').feature('parf2').set('workplane', 'wp2');
model.geom('geom1').run('parf2');
model.geom('geom1').feature('fin').set('action', 'assembly');
model.geom('geom1').run('fin');
model.geom('geom1').create('boxsel4', 'BoxSelection');
model.geom('geom1').feature('boxsel4').label('Inlets, O2 side');
model.geom('geom1').feature('boxsel4').set('entitydim', 2);
model.geom('geom1').feature('boxsel4').set('xmax', '-W_ribch*3+W_ch/10');
model.geom('geom1').feature('boxsel4').set('zmin', 'H_mem/2+H_gdl/2');
model.geom('geom1').feature('boxsel4').set('condition', 'inside');
model.geom('geom1').run('boxsel4');
model.geom('geom1').feature.duplicate('boxsel5', 'boxsel4');
model.geom('geom1').feature('boxsel5').label('Outlets, O2 side');
model.geom('geom1').feature('boxsel5').set('xmin', 'W_ribch*3-W_ch/10');
model.geom('geom1').feature('boxsel5').set('xmax', Inf);
model.geom('geom1').run('boxsel5');
model.geom('geom1').create('difsel3', 'DifferenceSelection');
model.geom('geom1').feature('difsel3').label('Slip Walls');
model.geom('geom1').feature('difsel3').set('entitydim', 2);
model.geom('geom1').feature('difsel3').set('add', {'blk1'});
model.geom('geom1').feature('difsel3').set('subtract', {'ext1'});
model.geom('geom1').run('difsel3');
model.geom('geom1').create('difsel4', 'DifferenceSelection');
model.geom('geom1').feature('difsel4').label('Boundary Layer Walls');
model.geom('geom1').feature('difsel4').set('entitydim', 2);
model.geom('geom1').feature('difsel4').set('add', {'ext1'});
model.geom('geom1').feature('difsel4').set('subtract', {'boxsel4' 'boxsel5'});
model.geom('geom1').run('difsel4');
model.geom('geom1').create('boxsel6', 'BoxSelection');
model.geom('geom1').feature('boxsel6').label('O2 Side Domains');
model.geom('geom1').feature('boxsel6').set('zmin', 'H_mem/4');
model.geom('geom1').run('boxsel6');
model.geom('geom1').create('boxsel7', 'BoxSelection');
model.geom('geom1').feature('boxsel7').label('GDE, O2 Side');
model.geom('geom1').feature('boxsel7').set('zmin', 'H_mem/4');
model.geom('geom1').feature('boxsel7').set('zmax', 'H_mem/2+H_gdl/2');
model.geom('geom1').feature('boxsel7').set('condition', 'inside');
model.geom('geom1').feature('boxsel7').set('entitydim', 2);
model.geom('geom1').feature.duplicate('boxsel8', 'boxsel7');
model.geom('geom1').feature('boxsel8').label('GDE, H2 Side');
model.geom('geom1').feature('boxsel8').set('zmin', '-H_mem/2-H_gdl/2');
model.geom('geom1').feature('boxsel8').set('zmax', '-H_mem/4');
model.geom('geom1').run('boxsel8');
model.geom('geom1').create('intsel2', 'IntersectionSelection');
model.geom('geom1').feature('intsel2').label('O2 Flow Channel');
model.geom('geom1').feature('intsel2').set('input', {'ext1' 'boxsel6'});
model.geom('geom1').run('intsel2');
model.geom('geom1').create('intsel3', 'IntersectionSelection');
model.geom('geom1').feature('intsel3').label('H2 GDL');
model.geom('geom1').feature('intsel3').set('input', {'boxsel2' 'blk1'});
model.geom('geom1').run('intsel3');
model.geom('geom1').feature.duplicate('intsel4', 'intsel3');
model.geom('geom1').feature('intsel4').label('O2 GDL');
model.geom('geom1').feature('intsel4').set('input', {'blk1' 'boxsel6'});
model.geom('geom1').run('intsel4');
model.geom('geom1').create('unisel1', 'UnionSelection');
model.geom('geom1').feature('unisel1').label('O2 Flow Domains');
model.geom('geom1').feature('unisel1').set('input', {'intsel2' 'intsel4'});
model.geom('geom1').run('unisel1');
model.geom('geom1').create('boxsel9', 'BoxSelection');
model.geom('geom1').feature('boxsel9').label('Lower GDL Boundary');
model.geom('geom1').feature('boxsel9').set('entitydim', 2);
model.geom('geom1').feature('boxsel9').set('zmin', '-H_gdl*3/2-H_mem');
model.geom('geom1').feature('boxsel9').set('zmax', '-H_gdl/2-H_mem/2');
model.geom('geom1').feature('boxsel9').set('condition', 'inside');
model.geom('geom1').run('boxsel9');
model.geom('geom1').create('difsel5', 'DifferenceSelection');
model.geom('geom1').feature('difsel5').label('H2 Current Collector');
model.geom('geom1').feature('difsel5').set('entitydim', 2);
model.geom('geom1').feature('difsel5').set('add', {'boxsel9'});
model.geom('geom1').feature('difsel5').set('subtract', {'ext1'});
model.geom('geom1').run('difsel5');
model.geom('geom1').create('adjsel1', 'AdjacentSelection');
model.geom('geom1').feature('adjsel1').label('Channel Sweep Mesh Boundaries');
model.geom('geom1').feature('adjsel1').set('input', {'boxsel1'});
model.geom('geom1').feature.duplicate('adjsel2', 'adjsel1');
model.geom('geom1').feature('adjsel2').label('Channel Tet Mesh Boundaries');
model.geom('geom1').runPre('adjsel2');
model.geom('geom1').feature('adjsel2').set('input', {'difsel1'});
model.geom('geom1').run('adjsel2');
model.geom('geom1').create('intsel5', 'IntersectionSelection');
model.geom('geom1').feature('intsel5').set('entitydim', 2);
model.geom('geom1').feature('intsel5').label('Channel Mesh Sweep Faces');
model.geom('geom1').feature('intsel5').set('input', {'adjsel1' 'adjsel2'});
model.geom('geom1').run('intsel5');
model.geom('geom1').create('boxsel10', 'BoxSelection');
model.geom('geom1').feature('boxsel10').label('GDL Upper Boundary Mesh Sweep Area');
model.geom('geom1').feature('boxsel10').set('entitydim', 2);
model.geom('geom1').feature('boxsel10').set('ymin', 'N_ch*W_ribch+W_ch-W_ch/2');
model.geom('geom1').feature('boxsel10').set('ymax', 'W_plate-N_ch*W_ribch-W_ch+W_ch/2');
model.geom('geom1').feature('boxsel10').set('zmin', 'H_gdl/2+H_mem/2');
model.geom('geom1').feature('boxsel10').set('zmax', 'H_gdl*3/2+H_mem/2');
model.geom('geom1').feature('boxsel10').set('condition', 'inside');
model.geom('geom1').run('boxsel10');
model.geom('geom1').create('intsel6', 'IntersectionSelection');
model.geom('geom1').feature('intsel6').label('O2 Current Collector Mapped Mesh Boundaries');
model.geom('geom1').feature('intsel6').set('entitydim', 2);
model.geom('geom1').feature('intsel6').set('input', {'difsel2' 'boxsel10'});
model.geom('geom1').run('intsel6');
model.geom('geom1').create('difsel6', 'DifferenceSelection');
model.geom('geom1').feature('difsel6').label('O2 Current Collector Triangular Mesh Boundaries');
model.geom('geom1').feature('difsel6').set('entitydim', 2);
model.geom('geom1').feature('difsel6').set('add', {'difsel2'});
model.geom('geom1').feature('difsel6').set('subtract', {'intsel6'});

model.title([]);

model.description('');

model.label('ht_pem_flow_field_geom_sequence.mph');

model.modelNode.label('Components');

out = model;
