function out = model
%
% angle_crack_plate.m
%
% Model exported on May 26 2025, 21:33 by COMSOL 6.2.0.339.

import com.comsol.model.*
import com.comsol.model.util.*

model = ModelUtil.create('Model');

model.modelPath('/Applications/COMSOL62/Multiphysics/applications/Structural_Mechanics_Module/Fracture_Mechanics');

model.modelNode.create('comp1', true);

model.geom.create('geom1', 2);
model.geom('geom1').model('comp1');

model.mesh.create('mesh1', 'geom1');

model.physics.create('solid', 'SolidMechanics', 'geom1');
model.physics('solid').model('comp1');

model.study.create('std1');
model.study('std1').create('stat', 'Stationary');
model.study('std1').feature('stat').setSolveFor('/physics/solid', true);

model.param.set('b', '50[mm]');
model.param.descr('b', 'Half width');
model.param.set('h0', '1.25*b');
model.param.descr('h0', 'Half height');
model.param.set('a', 'b*0.5');
model.param.descr('a', 'Half crack length');
model.param.set('beta', '90[deg]');
model.param.descr('beta', 'Crack angle');
model.param.set('load', '100[MPa]');
model.param.descr('load', 'Applied load');
model.param.set('K0', 'load/1[N/m^2]*sqrt(pi*a/1[m])');
model.param.descr('K0', 'Target stress intensity factor');

model.geom('geom1').create('r1', 'Rectangle');
model.geom('geom1').feature('r1').set('size', {'2*b' '2*h0'});
model.geom('geom1').feature('r1').set('base', 'center');
model.geom('geom1').run('r1');
model.geom('geom1').create('ls1', 'LineSegment');
model.geom('geom1').feature('ls1').set('specify1', 'coord');
model.geom('geom1').feature('ls1').set('coord1', {'-a' '0'});
model.geom('geom1').feature('ls1').set('specify2', 'coord');
model.geom('geom1').feature('ls1').set('coord2', {'a' '0'});
model.geom('geom1').run('ls1');
model.geom('geom1').create('rot1', 'Rotate');
model.geom('geom1').feature('rot1').selection('input').set({'ls1'});
model.geom('geom1').feature('rot1').set('rot', '90-beta');
model.geom('geom1').runPre('fin');
model.geom('geom1').run;

model.material.create('mat1', 'Common', 'comp1');
model.material('mat1').propertyGroup.create('Enu', 'Young''s_modulus_and_Poisson''s_ratio');
model.material('mat1').propertyGroup('Enu').set('E', {'207[GPa]'});
model.material('mat1').propertyGroup('Enu').set('nu', {'0.3'});
model.material('mat1').propertyGroup('def').set('density', {'8000'});

model.physics('solid').create('crack1', 'Crack', 1);
model.physics('solid').feature('crack1').selection.set([4]);
model.physics('solid').feature('crack1').create('jint1', 'JIntegral', 0);
model.physics('solid').feature('crack1').create('jint2', 'JIntegral', 0);
model.physics('solid').feature('crack1').feature('jint2').selection.set([4]);
model.physics('solid').create('roll1', 'Roller', 1);
model.physics('solid').feature('roll1').selection.set([2]);
model.physics('solid').create('disp1', 'Displacement0', 0);
model.physics('solid').feature('disp1').selection.set([5]);
model.physics('solid').feature('disp1').setIndex('Direction', 'prescribed', 0);
model.physics('solid').create('bndl1', 'BoundaryLoad', 1);
model.physics('solid').feature('bndl1').selection.set([3]);
model.physics('solid').feature('bndl1').set('FperArea', {'0' 'load' '0'});

model.mesh('mesh1').automatic(false);
model.mesh('mesh1').feature('size1').set('custom', true);
model.mesh('mesh1').feature('size1').set('hmaxactive', true);
model.mesh('mesh1').feature('size1').set('hmax', 'a/20');
model.mesh('mesh1').run;

model.study('std1').create('param', 'Parametric');
model.study('std1').feature('param').setIndex('pname', 'b', 0);
model.study('std1').feature('param').setIndex('plistarr', '', 0);
model.study('std1').feature('param').setIndex('punit', 'm', 0);
model.study('std1').feature('param').setIndex('pname', 'b', 0);
model.study('std1').feature('param').setIndex('plistarr', '', 0);
model.study('std1').feature('param').setIndex('punit', 'm', 0);
model.study('std1').feature('param').setIndex('pname', 'beta', 0);
model.study('std1').feature('param').setIndex('plistarr', '90 67.5 22.5', 0);
model.study('std1').feature('param').setIndex('punit', 'deg', 0);

model.sol.create('sol1');
model.sol('sol1').study('std1');
model.sol('sol1').create('st1', 'StudyStep');
model.sol('sol1').feature('st1').set('study', 'std1');
model.sol('sol1').feature('st1').set('studystep', 'stat');
model.sol('sol1').create('v1', 'Variables');
model.sol('sol1').feature('v1').set('control', 'stat');
model.sol('sol1').create('s1', 'Stationary');
model.sol('sol1').feature('s1').feature('aDef').set('cachepattern', true);
model.sol('sol1').feature('s1').create('fc1', 'FullyCoupled');
model.sol('sol1').feature('s1').feature('fc1').set('termonres', 'auto');
model.sol('sol1').feature('s1').feature('fc1').set('reserrfact', 1000);
model.sol('sol1').feature('s1').feature('fc1').set('linsolver', 'dDef');
model.sol('sol1').feature('s1').feature('fc1').set('termonres', 'auto');
model.sol('sol1').feature('s1').feature('fc1').set('reserrfact', 1000);
model.sol('sol1').feature('s1').feature.remove('fcDef');
model.sol('sol1').attach('std1');

model.batch.create('p1', 'Parametric');
model.batch('p1').study('std1');
model.batch('p1').create('so1', 'Solutionseq');
model.batch('p1').feature('so1').set('seq', 'sol1');
model.batch('p1').feature('so1').set('store', 'on');
model.batch('p1').feature('so1').set('clear', 'on');
model.batch('p1').feature('so1').set('psol', 'none');
model.batch('p1').set('pname', {'beta'});
model.batch('p1').set('plistarr', {'90 67.5 22.5'});
model.batch('p1').set('sweeptype', 'sparse');
model.batch('p1').set('probesel', 'all');
model.batch('p1').set('probes', {});
model.batch('p1').set('plot', 'off');
model.batch('p1').set('err', 'on');
model.batch('p1').attach('std1');
model.batch('p1').set('control', 'param');

model.sol.create('sol2');
model.sol('sol2').study('std1');
model.sol('sol2').label('Parametric Solutions 1');

model.batch('p1').feature('so1').set('psol', 'sol2');
model.batch('p1').run('compute');

model.result.create('pg1', 'PlotGroup2D');
model.result('pg1').set('data', 'dset2');
model.result('pg1').setIndex('looplevel', 3, 0);
model.result('pg1').set('defaultPlotID', 'stress');
model.result('pg1').label('Stress (solid)');
model.result('pg1').set('frametype', 'spatial');
model.result('pg1').create('surf1', 'Surface');
model.result('pg1').feature('surf1').set('expr', {'solid.misesGp'});
model.result('pg1').feature('surf1').set('threshold', 'manual');
model.result('pg1').feature('surf1').set('thresholdvalue', 0.2);
model.result('pg1').feature('surf1').set('colortable', 'Rainbow');
model.result('pg1').feature('surf1').set('colortabletrans', 'none');
model.result('pg1').feature('surf1').set('colorscalemode', 'linear');
model.result('pg1').feature('surf1').set('resolution', 'normal');
model.result('pg1').feature('surf1').set('colortable', 'Prism');
model.result('pg1').feature('surf1').set('smooth', 'none');
model.result('pg1').feature('surf1').set('colortabletrans', 'nonlinear');
model.result('pg1').feature('surf1').set('colorcalibration', -1);
model.result('pg1').feature('surf1').create('def', 'Deform');
model.result('pg1').feature('surf1').feature('def').set('expr', {'u' 'v'});
model.result('pg1').feature('surf1').feature('def').set('descr', 'Displacement field');
model.result('pg1').run;
model.result('pg1').run;
model.result('pg1').feature('surf1').set('unit', 'MPa');
model.result('pg1').run;
model.result('pg1').feature('surf1').stepFirst(0);
model.result('pg1').run;
model.result('pg1').feature('surf1').stepNext(0);
model.result('pg1').run;
model.result('pg1').feature('surf1').stepNext(0);
model.result('pg1').run;
model.result.create('pg2', 'PlotGroup2D');
model.result('pg2').set('data', 'dset2');
model.result('pg2').setIndex('looplevel', 3, 0);
model.result('pg2').set('defaultPlotID', 'cracks');
model.result('pg2').label('Cracks (solid)');
model.result('pg2').set('showlegends', true);
model.result('pg2').set('titletype', 'label');
model.result('pg2').set('frametype', 'material');
model.result('pg2').set('showlegendsunit', true);
model.result('pg2').create('arpt1', 'ArrowPoint');
model.result('pg2').feature('arpt1').set('expr', {'solid.crack1.e1X*solid.crack1.crackSize ' 'solid.crack1.e1Y*solid.crack1.crackSize '});
model.result('pg2').feature('arpt1').set('scaleactive', true);
model.result('pg2').feature('arpt1').set('scale', '1');
model.result('pg2').feature('arpt1').label('Crack Growth Direction (Crack 1)');
model.result('pg2').create('arpt2', 'ArrowPoint');
model.result('pg2').feature('arpt2').set('expr', {'solid.crack1.e1X*solid.crack1.crackSize ' 'solid.crack1.e1Y*solid.crack1.crackSize '});
model.result('pg2').feature('arpt2').set('scaleactive', true);
model.result('pg2').feature('arpt2').set('scale', '1');
model.result('pg2').feature('arpt2').label('Crack Growth Direction (Crack 1) 1');
model.result('pg2').create('con1', 'Contour');
model.result('pg2').feature('con1').set('expr', 'sqrt((X-solid.crack1.jint1.Xp)^2+(Y-solid.crack1.jint1.Yp)^2)');
model.result('pg2').feature('con1').set('levelmethod', 'levels');
model.result('pg2').feature('con1').set('levels', {'solid.crack1.jint1.r'});
model.result('pg2').feature('con1').set('coloring', 'uniform');
model.result('pg2').feature('con1').set('color', 'magenta');
model.result('pg2').feature('con1').set('colorlegend', false);
model.result('pg2').feature('con1').label('J-Integral 1, Integration Path');
model.result('pg2').create('ann1', 'Annotation');
model.result('pg2').feature('ann1').set('text', 'J=eval(solid.crack1.jint1.J)');
model.result('pg2').feature('ann1').set('posxexpr', 'solid.crack1.jint1.Xp');
model.result('pg2').feature('ann1').set('posyexpr', 'solid.crack1.jint1.Yp');
model.result('pg2').feature('ann1').label('J-Integral 1, Evaluation');
model.result('pg2').create('con2', 'Contour');
model.result('pg2').feature('con2').set('expr', 'sqrt((X-solid.crack1.jint2.Xp)^2+(Y-solid.crack1.jint2.Yp)^2)');
model.result('pg2').feature('con2').set('levelmethod', 'levels');
model.result('pg2').feature('con2').set('levels', {'solid.crack1.jint2.r'});
model.result('pg2').feature('con2').set('coloring', 'uniform');
model.result('pg2').feature('con2').set('color', 'magenta');
model.result('pg2').feature('con2').set('colorlegend', false);
model.result('pg2').feature('con2').label('J-Integral 2, Integration Path');
model.result('pg2').create('ann2', 'Annotation');
model.result('pg2').feature('ann2').set('text', 'J=eval(solid.crack1.jint2.J)');
model.result('pg2').feature('ann2').set('posxexpr', 'solid.crack1.jint2.Xp');
model.result('pg2').feature('ann2').set('posyexpr', 'solid.crack1.jint2.Yp');
model.result('pg2').feature('ann2').label('J-Integral 2, Evaluation');
model.result('pg2').label('Cracks (solid)');
model.result('pg2').run;
model.result.evaluationGroup.create('eg_dset2solid', 'EvaluationGroup');
model.result.evaluationGroup('eg_dset2solid').set('defaultPlotID', 'crackTable');
model.result.evaluationGroup('eg_dset2solid').label('Fracture Mechanics Results (solid)');
model.result.evaluationGroup('eg_dset2solid').set('data', 'dset2');
model.result.evaluationGroup('eg_dset2solid').set('transpose', true);
model.result.evaluationGroup('eg_dset2solid').create('jint', 'EvalGlobal');
model.result.evaluationGroup('eg_dset2solid').feature('jint').label('J-Integrals');
model.result.evaluationGroup('eg_dset2solid').feature('jint').setIndex('expr', 'solid.crack1.jint1.J', 0);
model.result.evaluationGroup('eg_dset2solid').feature('jint').setIndex('descr', 'J-integral [crack1/jint1]', 0);
model.result.evaluationGroup('eg_dset2solid').feature('jint').setIndex('expr', 'solid.crack1.jint2.J', 1);
model.result.evaluationGroup('eg_dset2solid').feature('jint').setIndex('descr', 'J-integral [crack1/jint2]', 1);
model.result.evaluationGroup('eg_dset2solid').create('sif1', 'EvalGlobal');
model.result.evaluationGroup('eg_dset2solid').feature('sif1').label('Stress Intensity Factors, Mode 1');
model.result.evaluationGroup('eg_dset2solid').feature('sif1').setIndex('expr', 'solid.crack1.jint1.KI', 0);
model.result.evaluationGroup('eg_dset2solid').feature('sif1').setIndex('descr', 'Stress intensity factor, mode I [crack1/jint1]', 0);
model.result.evaluationGroup('eg_dset2solid').feature('sif1').setIndex('expr', 'solid.crack1.jint2.KI', 1);
model.result.evaluationGroup('eg_dset2solid').feature('sif1').setIndex('descr', 'Stress intensity factor, mode I [crack1/jint2]', 1);
model.result.evaluationGroup('eg_dset2solid').create('sif2', 'EvalGlobal');
model.result.evaluationGroup('eg_dset2solid').feature('sif2').label('Stress Intensity Factors, Mode 2');
model.result.evaluationGroup('eg_dset2solid').feature('sif2').setIndex('expr', 'solid.crack1.jint1.KII', 0);
model.result.evaluationGroup('eg_dset2solid').feature('sif2').setIndex('descr', 'Stress intensity factor, mode II [crack1/jint1]', 0);
model.result.evaluationGroup('eg_dset2solid').feature('sif2').setIndex('expr', 'solid.crack1.jint2.KII', 1);
model.result.evaluationGroup('eg_dset2solid').feature('sif2').setIndex('descr', 'Stress intensity factor, mode II [crack1/jint2]', 1);
model.result.evaluationGroup('eg_dset2solid').label('Fracture Mechanics Results (solid)');
model.result('pg2').run;
model.result('pg2').stepFirst(0);
model.result('pg2').run;
model.result('pg2').stepNext(0);
model.result('pg2').run;
model.result('pg2').stepNext(0);
model.result('pg2').run;
model.result.evaluationGroup('eg_dset2solid').feature('sif1').setIndex('expr', 'solid.crack1.jint1.KI/K0', 0);
model.result.evaluationGroup('eg_dset2solid').feature('sif1').setIndex('unit', 1, 0);
model.result.evaluationGroup('eg_dset2solid').feature('sif1').setIndex('expr', 'solid.crack1.jint2.KI/K0', 1);
model.result.evaluationGroup('eg_dset2solid').feature('sif1').setIndex('unit', 1, 1);
model.result.evaluationGroup('eg_dset2solid').feature('sif2').setIndex('expr', 'solid.crack1.jint1.KII/K0', 0);
model.result.evaluationGroup('eg_dset2solid').feature('sif2').setIndex('unit', 1, 0);
model.result.evaluationGroup('eg_dset2solid').feature('sif2').setIndex('expr', 'solid.crack1.jint2.KII/K0', 1);
model.result.evaluationGroup('eg_dset2solid').feature('sif2').setIndex('unit', 1, 1);
model.result.evaluationGroup('eg_dset2solid').run;
model.result('pg1').run;
model.result.duplicate('pg3', 'pg1');
model.result('pg3').run;
model.result('pg3').label('Stress, Multiple Angles');
model.result('pg3').set('edges', false);
model.result('pg3').set('showlegends', false);
model.result('pg3').set('plotarrayenable', true);
model.result('pg3').feature('surf1').set('arraydim', '1');
model.result('pg3').run;
model.result('pg3').feature('surf1').set('data', 'dset2');
model.result('pg3').feature('surf1').setIndex('looplevel', 1, 0);
model.result('pg3').run;
model.result('pg3').create('line1', 'Line');
model.result('pg3').feature('line1').set('arraydim', '1');
model.result('pg3').feature('line1').set('expr', '1');
model.result('pg3').feature('line1').set('coloring', 'uniform');
model.result('pg3').feature('line1').set('color', 'black');
model.result('pg3').feature('line1').set('data', 'dset2');
model.result('pg3').feature('line1').setIndex('looplevel', 1, 0);
model.result('pg3').feature('line1').set('titletype', 'none');
model.result('pg3').feature('line1').set('belongstoplotarray', false);
model.result('pg3').feature('line1').set('inheritplot', 'surf1');
model.result('pg3').feature('line1').set('inheritcolor', false);
model.result('pg3').feature('line1').set('inheritrange', false);
model.result('pg3').feature('line1').set('inheritheightscale', false);
model.result('pg3').feature('line1').set('inherittubescale', false);
model.result('pg3').feature('line1').create('def1', 'Deform');
model.result('pg3').run;
model.result('pg3').feature('line1').set('arraydim', '1');
model.result('pg3').run;
model.result('pg3').feature('line1').create('sel1', 'Selection');
model.result('pg3').feature('line1').feature('sel1').selection.set([1 2 3 5]);
model.result('pg3').run;
model.result('pg3').feature('surf1').set('arraydim', '1');
model.result('pg3').run;
model.result('pg3').feature.duplicate('surf2', 'surf1');
model.result('pg3').feature.duplicate('line2', 'line1');
model.result('pg3').feature('surf2').set('arraydim', '1');
model.result('pg3').run;
model.result('pg3').feature('surf2').setIndex('looplevel', 2, 0);
model.result('pg3').feature('surf2').set('titletype', 'none');
model.result('pg3').feature('surf2').set('inheritplot', 'surf1');
model.result('pg3').feature('line2').set('arraydim', '1');
model.result('pg3').run;
model.result('pg3').feature('line2').setIndex('looplevel', 2, 0);
model.result('pg3').feature('line2').set('belongstoplotarray', true);
model.result('pg3').feature('line2').set('manualindexing', true);
model.result('pg3').feature('line2').set('arrayindex', 1);
model.result('pg3').feature('surf2').set('arraydim', '1');
model.result('pg3').run;
model.result('pg3').feature.duplicate('surf3', 'surf2');
model.result('pg3').feature.duplicate('line3', 'line2');
model.result('pg3').feature('surf3').set('arraydim', '1');
model.result('pg3').run;
model.result('pg3').feature('surf3').setIndex('looplevel', 3, 0);
model.result('pg3').feature('surf3').set('manualindexing', true);
model.result('pg3').feature('surf3').set('arrayindex', 2);
model.result('pg3').feature('line3').set('arraydim', '1');
model.result('pg3').run;
model.result('pg3').feature('line3').setIndex('looplevel', 3, 0);
model.result('pg3').feature('line3').set('arrayindex', 2);
model.result('pg3').run;
model.result('pg3').set('view', 'new');
model.result('pg3').run;
model.result.create('pg4', 'PlotGroup1D');
model.result('pg4').run;
model.result('pg4').label('Crack Displacement');
model.result('pg4').set('data', 'dset2');
model.result('pg4').create('lngr1', 'LineGraph');
model.result('pg4').feature('lngr1').set('markerpos', 'datapoints');
model.result('pg4').feature('lngr1').set('linewidth', 'preference');
model.result('pg4').feature('lngr1').selection.set([4]);
model.result('pg4').feature('lngr1').set('expr', 'solid.crack1.jint1.delta_u1');
model.result('pg4').feature('lngr1').set('descr', 'Crack opening displacement');
model.result('pg4').feature('lngr1').set('legend', true);
model.result('pg4').feature('lngr1').set('legendprefix', 'Opening, \beta =');
model.result('pg4').run;
model.result('pg4').create('lngr2', 'LineGraph');
model.result('pg4').feature('lngr2').set('markerpos', 'datapoints');
model.result('pg4').feature('lngr2').set('linewidth', 'preference');
model.result('pg4').feature('lngr2').selection.set([4]);
model.result('pg4').feature('lngr2').set('expr', 'solid.crack1.jint1.delta_u2');
model.result('pg4').feature('lngr2').set('descr', 'Crack sliding displacement');
model.result('pg4').feature('lngr2').set('linestyle', 'dashed');
model.result('pg4').feature('lngr2').set('linecolor', 'cyclereset');
model.result('pg4').feature('lngr2').set('legend', true);
model.result('pg4').feature('lngr2').set('legendprefix', 'Sliding, \beta=');
model.result('pg4').run;
model.result('pg3').run;

model.title('Angle Crack Embedded in a Plate');

model.description('This model reproduces a NAFEMS benchmark in which a plate with an angle crack is subjected to tensile loading. The J-integral is calculated and the stress intensity factors for Mode I and Mode II are compared to the benchmark for several values of the angle.');

model.label('angle_crack_plate.mph');

model.modelNode.label('Components');

out = model;
