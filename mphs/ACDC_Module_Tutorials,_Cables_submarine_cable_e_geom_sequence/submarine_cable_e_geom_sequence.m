function out = model
%
% submarine_cable_e_geom_sequence.m
%
% Model exported on May 26 2025, 21:25 by COMSOL 6.2.0.339.

import com.comsol.model.*
import com.comsol.model.util.*

model = ModelUtil.create('Model');

model.modelPath('/Applications/COMSOL62/Multiphysics/applications/ACDC_Module/Tutorials,_Cables');

model.modelNode.create('comp1', true);

model.geom.create('geom1', 2);
model.geom('geom1').model('comp1');

model.mesh.create('mesh1', 'geom1');

model.param.label('Geometric Parameters 1');

% To import content from file, use:
% model.param.loadFile('FILENAME');
model.param.set('Dcon', '26.2[mm]', 'Diameter of main conductors (phase)');
model.param.set('Tins', '24.0[mm]', 'Insulation thickness (XLPE)');
model.param.set('Dins', '77.6[mm]', 'Diameter over insulation (XLPE and SCC)');
model.param.set('Tscc', '(Dins/2-Dcon/2-Tins)/2', 'Semi-conductive compound thickness');
model.param.set('Tpbs', '2.9[mm]', 'Lead sheath thickness');
model.param.set('Tpe', '2.9[mm]', 'Polyethylene sheath thickness');
model.param.set('Dpha', 'Dins+2*Tpbs+2*Tpe', 'Diameter over phase (including sheath and PE)');
model.param.set('Dpha3', 'Dpha*(2/sqrt(3)+1)', 'Diameter over three phases combined');
model.param.set('Dfic', '2.5[mm]', 'Diameter of fiber optic core');
model.param.set('Tfih', '0.5[mm]', 'Steel helix thickness (fiber)');
model.param.set('Dfib', '9.2[mm]', 'Diameter over fiber optic cable');
model.param.set('Dcab', '219.0[mm]', 'Outer diameter of submarine cable');
model.param.set('Darm', '(Dcab+Dpha3)/2', 'Central diameter of armor ring');
model.param.set('Tarm', '5.6[mm]', 'Armor thickness (wire diameter)');
model.param.set('Narm', '110', 'Number of armor wires in ring');
model.param.set('mfil', '0.5[mm]', 'Filler margin');
model.param.set('marm', 'pi*Darm/Narm-Tarm', 'Armor margin');

model.geom('geom1').create('c1', 'Circle');
model.geom('geom1').feature('c1').label('Phase 1');
model.geom('geom1').feature('c1').set('r', 'Dcon/2');
model.geom('geom1').feature('c1').set('pos', {'-(Dpha/2)/sqrt(3)' '0'});
model.geom('geom1').feature('c1').setIndex('pos', 'Dpha/2', 1);
model.geom('geom1').feature('c1').set('rot', 120);
model.geom('geom1').feature('c1').set('selresult', true);
model.geom('geom1').run('c1');
model.geom('geom1').create('c2', 'Circle');
model.geom('geom1').feature('c2').label('Phase 2');
model.geom('geom1').feature('c2').set('r', 'Dcon/2');
model.geom('geom1').feature('c2').set('pos', {'Dpha/sqrt(3)' '0'});
model.geom('geom1').feature('c2').set('selresult', true);
model.geom('geom1').run('c2');
model.geom('geom1').create('c3', 'Circle');
model.geom('geom1').feature('c3').label('Phase 3');
model.geom('geom1').feature('c3').set('r', 'Dcon/2');
model.geom('geom1').feature('c3').set('pos', {'-(Dpha/2)/sqrt(3)' '0'});
model.geom('geom1').feature('c3').setIndex('pos', '-Dpha/2', 1);
model.geom('geom1').feature('c3').set('rot', -120);
model.geom('geom1').feature('c3').set('selresult', true);
model.geom('geom1').run('c3');
model.geom('geom1').create('c4', 'Circle');
model.geom('geom1').feature('c4').set('type', 'curve');
model.geom('geom1').feature('c4').set('r', 'Dcon/2+Tscc');
model.geom('geom1').feature('c4').set('pos', {'Dpha/sqrt(3)' '0'});
model.geom('geom1').feature('c4').setIndex('layer', 'Tscc', 0);
model.geom('geom1').run('c4');
model.geom('geom1').create('c5', 'Circle');
model.geom('geom1').feature('c5').set('type', 'curve');
model.geom('geom1').feature('c5').set('r', 'Dins/2-Tscc');
model.geom('geom1').feature('c5').set('pos', {'Dpha/sqrt(3)' '0'});
model.geom('geom1').feature('c5').setIndex('layer', 'Tins', 0);
model.geom('geom1').run('c5');
model.geom('geom1').create('c6', 'Circle');
model.geom('geom1').feature('c6').set('type', 'curve');
model.geom('geom1').feature('c6').set('r', 'Dins/2');
model.geom('geom1').feature('c6').set('pos', {'Dpha/sqrt(3)' '0'});
model.geom('geom1').feature('c6').setIndex('layer', 'Tscc', 0);
model.geom('geom1').run('c6');
model.geom('geom1').create('c7', 'Circle');
model.geom('geom1').feature('c7').set('type', 'curve');
model.geom('geom1').feature('c7').set('r', 'Dins/2+Tpbs');
model.geom('geom1').feature('c7').set('pos', {'Dpha/sqrt(3)' '0'});
model.geom('geom1').feature('c7').setIndex('layer', 'Tpbs', 0);
model.geom('geom1').run('c7');
model.geom('geom1').create('uni1', 'Union');
model.geom('geom1').feature('uni1').label('Semiconductive Compound');
model.geom('geom1').feature('uni1').selection('input').set({'c4' 'c6'});
model.geom('geom1').feature('uni1').set('intbnd', false);
model.geom('geom1').feature('uni1').set('selresult', true);
model.geom('geom1').run('uni1');
model.geom('geom1').create('uni2', 'Union');
model.geom('geom1').feature('uni2').label('Cross-Linked Polyethylene (XLPE)');
model.geom('geom1').feature('uni2').selection('input').set({'c5'});
model.geom('geom1').feature('uni2').set('intbnd', false);
model.geom('geom1').feature('uni2').set('selresult', true);
model.geom('geom1').run('uni2');
model.geom('geom1').create('uni3', 'Union');
model.geom('geom1').feature('uni3').label('Screens');
model.geom('geom1').feature('uni3').selection('input').set({'c7'});
model.geom('geom1').feature('uni3').set('intbnd', false);
model.geom('geom1').feature('uni3').set('selresult', true);
model.geom('geom1').run('uni3');
model.geom('geom1').create('c8', 'Circle');
model.geom('geom1').feature('c8').set('type', 'curve');
model.geom('geom1').feature('c8').set('r', 'Dpha/2+mfil');
model.geom('geom1').feature('c8').set('pos', {'Dpha/sqrt(3)' '0'});
model.geom('geom1').feature('c8').setIndex('layer', 'Tpe+mfil', 0);
model.geom('geom1').run('c8');
model.geom('geom1').create('ca1', 'CircularArc');
model.geom('geom1').feature('ca1').set('r', 'Dpha3/2-mfil');
model.geom('geom1').feature('ca1').set('angle1', -60);
model.geom('geom1').feature('ca1').set('angle2', 60);
model.geom('geom1').run('ca1');
model.geom('geom1').create('rot1', 'Rotate');
model.geom('geom1').feature('rot1').selection('input').set({'c8' 'ca1' 'uni1' 'uni2' 'uni3'});
model.geom('geom1').feature('rot1').set('rot', '0[deg], 120[deg], 240[deg]');
model.geom('geom1').run('rot1');
model.geom('geom1').create('c9', 'Circle');
model.geom('geom1').feature('c9').set('type', 'curve');
model.geom('geom1').feature('c9').set('r', 'Dcab/2');
model.geom('geom1').feature('c9').setIndex('layer', 'Dcab/2-(Dpha3/2-mfil)', 0);
model.geom('geom1').run('c9');
model.geom('geom1').create('c10', 'Circle');
model.geom('geom1').feature('c10').set('type', 'curve');
model.geom('geom1').feature('c10').set('r', 'Darm/2+Tarm/2+marm');
model.geom('geom1').feature('c10').setIndex('layer', 'Tarm+2*marm', 0);
model.geom('geom1').run('c10');
model.geom('geom1').create('dif1', 'Difference');
model.geom('geom1').feature('dif1').label('Polyethylene');
model.geom('geom1').feature('dif1').selection('input').set({'c9' 'rot1(1)' 'rot1(2)' 'rot1(3)'});
model.geom('geom1').feature('dif1').selection('input2').set({'c10'});
model.geom('geom1').feature('dif1').set('intbnd', false);
model.geom('geom1').feature('dif1').set('selresult', true);
model.geom('geom1').run('dif1');
model.geom('geom1').create('c11', 'Circle');
model.geom('geom1').feature('c11').set('r', 'Dpha*0.241335+mfil');
model.geom('geom1').feature('c11').set('pos', {'Dpha*-0.836015' '0'});
model.geom('geom1').run('c11');
model.geom('geom1').create('c12', 'Circle');
model.geom('geom1').feature('c12').set('r', 'Dpha*0.118595+mfil');
model.geom('geom1').feature('c12').set('pos', {'Dpha*-0.890205' '0'});
model.geom('geom1').feature('c12').setIndex('pos', 'Dpha*-0.355815', 1);
model.geom('geom1').run('c12');
model.geom('geom1').feature.duplicate('c13', 'c12');
model.geom('geom1').feature('c13').setIndex('pos', 'Dpha*0.355815', 1);
model.geom('geom1').run('c13');
model.geom('geom1').create('rot2', 'Rotate');
model.geom('geom1').feature('rot2').selection('input').set({'c11' 'c12' 'c13'});
model.geom('geom1').feature('rot2').set('rot', '0[deg], 120[deg], 240[deg]');
model.geom('geom1').feature('rot2').set('selresult', true);
model.geom('geom1').feature('rot2').set('selresultshow', false);
model.geom('geom1').run('rot2');
model.geom('geom1').create('c14', 'Circle');
model.geom('geom1').feature('c14').set('r', 'Dpha*(1/sqrt(3)-1/2)+mfil');
model.geom('geom1').run('c14');
model.geom('geom1').create('c15', 'Circle');
model.geom('geom1').feature('c15').set('r', 'Dfic/2+Tfih');
model.geom('geom1').feature('c15').set('pos', {'Dpha*-0.836015' '0'});
model.geom('geom1').run('c15');
model.geom('geom1').create('copy1', 'Copy');
model.geom('geom1').feature('copy1').selection('input').named('dif1');
model.geom('geom1').feature('copy1').set('selresult', true);
model.geom('geom1').feature('copy1').set('selresultshow', false);
model.geom('geom1').run('copy1');
model.geom('geom1').create('dif2', 'Difference');
model.geom('geom1').feature('dif2').label('Polypropylene');
model.geom('geom1').feature('dif2').selection('input').named('rot2');
model.geom('geom1').feature('dif2').selection('input').set({'c14' 'rot2'});
model.geom('geom1').feature('dif2').selection('input2').named('copy1');
model.geom('geom1').feature('dif2').selection('input2').set({'c15' 'copy1'});
model.geom('geom1').feature('dif2').set('intbnd', false);
model.geom('geom1').feature('dif2').set('selresult', true);
model.geom('geom1').run('dif2');
model.geom('geom1').create('c16', 'Circle');
model.geom('geom1').feature('c16').set('type', 'curve');
model.geom('geom1').feature('c16').set('r', 'Dfib/2');
model.geom('geom1').feature('c16').set('pos', {'Dpha*-0.836015' '0'});
model.geom('geom1').run('c16');
model.geom('geom1').create('c17', 'Circle');
model.geom('geom1').feature('c17').label('Steel Helix (Fiber)');
model.geom('geom1').feature('c17').set('type', 'curve');
model.geom('geom1').feature('c17').set('r', 'Dfic/2+Tfih');
model.geom('geom1').feature('c17').set('pos', {'Dpha*-0.836015' '0'});
model.geom('geom1').feature('c17').setIndex('layer', 'Tfih', 0);
model.geom('geom1').feature('c17').set('selresult', true);
model.geom('geom1').run('c17');
model.geom('geom1').create('c18', 'Circle');
model.geom('geom1').feature('c18').label('Fiber Optic Core');
model.geom('geom1').feature('c18').set('r', 'Dfic/2');
model.geom('geom1').feature('c18').set('pos', {'Dpha*-0.836015' '0'});
model.geom('geom1').feature('c18').set('selresult', true);
model.geom('geom1').run('c18');
model.geom('geom1').create('c19', 'Circle');
model.geom('geom1').feature('c19').label('Cable Armor');
model.geom('geom1').feature('c19').set('r', 'Tarm/2');
model.geom('geom1').feature('c19').set('pos', {'Darm/2' '0'});
model.geom('geom1').feature('c19').set('selresult', true);
model.geom('geom1').run('c19');
model.geom('geom1').create('rot3', 'Rotate');
model.geom('geom1').feature('rot3').selection('input').named('c19');
model.geom('geom1').feature('rot3').set('rot', '360[deg]*range(1/Narm,1/Narm,1)');
model.geom('geom1').run('rot3');
model.geom('geom1').feature.duplicate('c20', 'c10');
model.geom('geom1').feature('c20').set('selresult', true);
model.geom('geom1').feature('c20').set('selresultshow', false);
model.geom('geom1').run('c20');
model.geom('geom1').create('copy2', 'Copy');
model.geom('geom1').feature('copy2').selection('input').named('c19');
model.geom('geom1').feature('copy2').set('selresult', true);
model.geom('geom1').feature('copy2').set('selresultshow', false);
model.geom('geom1').run('copy2');
model.geom('geom1').create('dif3', 'Difference');
model.geom('geom1').feature('dif3').label('Bitumen Compound');
model.geom('geom1').feature('dif3').selection('input').named('c20');
model.geom('geom1').feature('dif3').selection('input2').named('copy2');
model.geom('geom1').feature('dif3').set('intbnd', false);
model.geom('geom1').feature('dif3').set('selresult', true);
model.geom('geom1').run('dif3');
model.geom('geom1').create('c21', 'Circle');
model.geom('geom1').feature('c21').label('Cable Domains');
model.geom('geom1').feature('c21').set('r', 'Dcab/2');
model.geom('geom1').feature('c21').set('selresult', true);
model.geom('geom1').run('c21');
model.geom('geom1').create('c22', 'Circle');
model.geom('geom1').feature('c22').label('Electromagnetic Domains');
model.geom('geom1').feature('c22').set('r', '5*Dcab/2');
model.geom('geom1').feature('c22').set('selresult', true);
model.geom('geom1').run('c22');
model.geom('geom1').create('r1', 'Rectangle');
model.geom('geom1').feature('r1').label('Thermal Domains');
model.geom('geom1').feature('r1').set('size', {'10[m]' '8[m]'});
model.geom('geom1').feature('r1').set('pos', {'-5[m]' '-4[m]'});
model.geom('geom1').feature('r1').setIndex('layer', '5[m]', 0);
model.geom('geom1').feature('r1').set('selresult', true);
model.geom('geom1').run('r1');
model.geom('geom1').run;

model.material.create('mat1', 'Common', 'comp1');
model.material('mat1').selection.named('geom1_r1_dom');
model.material('mat1').selection.named('geom1_c22_dom');
model.material('mat1').selection.named('geom1_c21_dom');
model.material('mat1').selection.named('geom1_dif3_dom');
model.material('mat1').selection.named('geom1_c19_dom');
model.material('mat1').selection.named('geom1_c18_dom');
model.material('mat1').selection.named('geom1_c17_dom');
model.material('mat1').selection.named('geom1_dif2_dom');
model.material('mat1').selection.named('geom1_dif1_dom');
model.material('mat1').selection.named('geom1_uni3_dom');
model.material('mat1').selection.named('geom1_uni2_dom');
model.material('mat1').selection.named('geom1_uni1_dom');
model.material('mat1').selection.named('geom1_c3_dom');
model.material('mat1').selection.named('geom1_c2_dom');
model.material('mat1').selection.named('geom1_c1_dom');
model.material.remove('mat1');

model.geom('geom1').run('fin');

model.title([]);

model.description('');

model.label('submarine_cable_e_geom_sequence.mph');

model.modelNode.label('Components');

out = model;
