function out = model
%
% aec_shunt_currents_geom_sequence.m
%
% Model exported on May 26 2025, 21:28 by COMSOL 6.2.0.339.

import com.comsol.model.*
import com.comsol.model.util.*

model = ModelUtil.create('Model');

model.modelPath('/Applications/COMSOL62/Multiphysics/applications/Fuel_Cell_and_Electrolyzer_Module/Electrolyzers');

% To import content from file, use:
% model.param.loadFile('FILENAME');
model.param.set('R_cell', '0.8[m]', 'Cell radius (including gasket)');
model.param.set('S_gasket', '50[mm]', 'Gasket width');
model.param.set('H_manifold', '100[mm]', 'Manifold height');
model.param.set('H_holes', '100[mm]', 'Channel hole height');
model.param.set('H_active', '2*(R_cell-S_gasket-H_holes-H_manifold)', 'Height of active area');
model.param.set('D_endplate', '30[mm]', 'Endplate thickness');
model.param.set('D_h2', '4[mm]', 'Hydrogen electrolyte compartment thickness');
model.param.set('D_sep', '3[mm]', 'Separator thickness');
model.param.set('D_o2', '4[mm]', 'Oxygen electrolyte compartment thickness');
model.param.set('D_bpp', '5[mm]', 'Bipolar plate thickness');
model.param.set('D_cell', 'D_h2+D_sep+D_o2+D_bpp', 'Cell thickness');
model.param.set('N_cells', '20', 'Number of cells');

model.geom.create('part1', 'Part', 2);
model.geom('part1').label('Cross Section Profile');
model.geom('part1').create('c1', 'Circle');
model.geom('part1').feature('c1').set('r', 'R_cell-S_gasket');
model.geom('part1').run('c1');
model.geom('part1').create('r1', 'Rectangle');
model.geom('part1').feature('r1').set('size', {'2*R_cell' 'H_active'});
model.geom('part1').feature('r1').set('base', 'center');
model.geom('part1').run('r1');
model.geom('part1').create('int1', 'Intersection');
model.geom('part1').feature('int1').selection('input').set({'c1' 'r1'});
model.geom('part1').feature('int1').set('keep', true);
model.geom('part1').run('int1');
model.geom('part1').create('del1', 'Delete');
model.geom('part1').feature('del1').selection('input').init;
model.geom('part1').feature('del1').selection('input').set({'r1'});
model.geom('part1').run('del1');
model.geom('part1').create('r2', 'Rectangle');
model.geom('part1').feature('r2').set('size', {'R_cell' 'H_manifold'});
model.geom('part1').feature('r2').set('pos', {'S_gasket/2' 'H_active/2'});
model.geom('part1').run('r2');
model.geom('part1').create('int2', 'Intersection');
model.geom('part1').feature('int2').selection('input').set({'c1' 'r2'});
model.geom('part1').feature('int2').set('keep', true);
model.geom('part1').run('int2');
model.geom('part1').create('del2', 'Delete');
model.geom('part1').feature('del2').selection('input').init;
model.geom('part1').feature('del2').selection('input').set({'r2'});
model.geom('part1').run('del2');
model.geom('part1').create('r3', 'Rectangle');
model.geom('part1').feature('r3').set('size', {'R_cell' 'H_holes'});
model.geom('part1').feature('r3').set('pos', {'S_gasket/2' 'H_active/2+H_manifold'});
model.geom('part1').run('r3');
model.geom('part1').create('int3', 'Intersection');
model.geom('part1').feature('int3').selection('input').set({'c1' 'r3'});
model.geom('part1').run('int3');
model.geom('part1').create('mir1', 'Mirror');
model.geom('part1').feature('mir1').selection('input').set({'int2' 'int3'});
model.geom('part1').feature('mir1').set('keep', true);
model.geom('part1').run('mir1');
model.geom('part1').create('mir2', 'Mirror');
model.geom('part1').feature('mir2').selection('input').set({'int2' 'int3' 'mir1'});
model.geom('part1').feature('mir2').set('keep', true);
model.geom('part1').feature('mir2').set('axis', [0 1]);
model.geom('part1').run('mir2');
model.geom.create('part2', 'Part', 2);
model.geom('part2').label('Active Cell Area');
model.geom('part2').create('pi1', 'PartInstance');
model.geom('part2').feature('pi1').set('selkeepnoncontr', false);
model.geom('part2').feature('pi1').set('part', 'part1');
model.geom('part2').run('pi1');
model.geom('part2').create('del1', 'Delete');
model.geom('part2').feature('del1').selection('input').init;
model.geom('part2').feature('del1').selection('input').set({'pi1(2)' 'pi1(3)' 'pi1(4)' 'pi1(5)' 'pi1(6)' 'pi1(7)' 'pi1(8)' 'pi1(9)'});
model.geom('part2').run('del1');
model.geom.create('part3', 'Part', 2);
model.geom('part3').label('Hydrogen Inlet Channel');
model.geom('part3').create('pi1', 'PartInstance');
model.geom('part3').feature('pi1').set('selkeepnoncontr', false);
model.geom('part3').feature('pi1').set('part', 'part1');
model.geom('part3').run('pi1');
model.geom('part3').create('del1', 'Delete');
model.geom('part3').feature('del1').selection('input').init;
model.geom('part3').feature('del1').selection('input').set({'pi1(1)' 'pi1(2)' 'pi1(3)' 'pi1(4)' 'pi1(5)' 'pi1(6)' 'pi1(8)' 'pi1(9)'});
model.geom('part3').run('del1');
model.geom.create('part4', 'Part', 2);
model.geom('part4').label('Hydrogen Outlet Channel');
model.geom('part4').create('pi1', 'PartInstance');
model.geom('part4').feature('pi1').set('selkeepnoncontr', false);
model.geom('part4').feature('pi1').set('part', 'part1');
model.geom('part4').run('pi1');
model.geom('part4').create('del1', 'Delete');
model.geom('part4').feature('del1').selection('input').init;
model.geom('part4').feature('del1').selection('input').set({'pi1(1)' 'pi1(2)' 'pi1(3)' 'pi1(4)' 'pi1(6)' 'pi1(7)' 'pi1(8)' 'pi1(9)'});
model.geom('part4').run('del1');
model.geom.create('part5', 'Part', 2);
model.geom('part5').label('Hydrogen Manifolds');
model.geom('part5').create('pi1', 'PartInstance');
model.geom('part5').feature('pi1').set('selkeepnoncontr', false);
model.geom('part5').feature('pi1').set('part', 'part1');
model.geom('part5').run('pi1');
model.geom('part5').create('del1', 'Delete');
model.geom('part5').feature('del1').selection('input').init;
model.geom('part5').feature('del1').selection('input').set({'pi1(1)' 'pi1(2)' 'pi1(3)' 'pi1(5)' 'pi1(7)' 'pi1(8)' 'pi1(9)'});
model.geom('part5').run('del1');
model.geom.create('part6', 'Part', 2);
model.geom('part6').label('Oxygen Inlet Channel');
model.geom('part6').create('pi1', 'PartInstance');
model.geom('part6').feature('pi1').set('selkeepnoncontr', false);
model.geom('part6').feature('pi1').set('part', 'part1');
model.geom('part6').run('pi1');
model.geom('part6').create('del1', 'Delete');
model.geom('part6').feature('del1').selection('input').init;
model.geom('part6').feature('del1').selection('input').set({'pi1(1)' 'pi1(2)' 'pi1(3)' 'pi1(4)' 'pi1(5)' 'pi1(6)' 'pi1(7)' 'pi1(8)'});
model.geom('part6').run('del1');
model.geom.create('part7', 'Part', 2);
model.geom('part7').label('Oxygen Outlet Channel');
model.geom('part7').create('pi1', 'PartInstance');
model.geom('part7').feature('pi1').set('selkeepnoncontr', false);
model.geom('part7').feature('pi1').set('part', 'part1');
model.geom('part7').run('pi1');
model.geom('part7').create('del1', 'Delete');
model.geom('part7').feature('del1').selection('input').init;
model.geom('part7').feature('del1').selection('input').set({'pi1(1)' 'pi1(2)' 'pi1(4)' 'pi1(5)' 'pi1(6)' 'pi1(7)' 'pi1(8)' 'pi1(9)'});
model.geom('part7').run('del1');
model.geom.create('part8', 'Part', 2);
model.geom('part8').label('Oxygen Manifolds');
model.geom('part8').create('pi1', 'PartInstance');
model.geom('part8').feature('pi1').set('selkeepnoncontr', false);
model.geom('part8').feature('pi1').set('part', 'part1');
model.geom('part8').run('pi1');
model.geom('part8').create('del1', 'Delete');
model.geom('part8').feature('del1').selection('input').init;
model.geom('part8').feature('del1').selection('input').set({'pi1(1)' 'pi1(3)' 'pi1(4)' 'pi1(5)' 'pi1(6)' 'pi1(7)' 'pi1(9)'});
model.geom('part8').run('del1');

model.modelNode.create('comp1', true);

model.geom.create('geom1', 3);
model.geom('geom1').model('comp1');

model.mesh.create('mesh1', 'geom1');

model.geom('geom1').create('wp1', 'WorkPlane');
model.geom('geom1').feature('wp1').set('unite', true);
model.geom('geom1').feature('wp1').set('quickplane', 'yz');
model.geom('geom1').feature('wp1').geom.create('pi1', 'PartInstance');
model.geom('geom1').feature('wp1').geom.feature('pi1').set('selkeepnoncontr', false);
model.geom('geom1').feature('wp1').geom.feature('pi1').set('part', 'part2');
model.geom('geom1').feature('wp1').geom.run('pi1');
model.geom('geom1').run('wp1');
model.geom('geom1').feature.create('ext1', 'Extrude');
model.geom('geom1').feature('ext1').setIndex('distance', 'D_endplate', 0);
model.geom('geom1').selection.create('csel1', 'CumulativeSelection');
model.geom('geom1').selection('csel1').label('Current Conductors');
model.geom('geom1').feature('ext1').set('contributeto', 'csel1');
model.geom('geom1').run('ext1');
model.geom('geom1').create('wp2', 'WorkPlane');
model.geom('geom1').feature('wp2').set('unite', true);
model.geom('geom1').feature('wp2').set('quickplane', 'yz');
model.geom('geom1').feature('wp2').set('quickx', 'D_endplate');
model.geom('geom1').feature('wp2').geom.create('pi1', 'PartInstance');
model.geom('geom1').feature('wp2').geom.feature('pi1').set('selkeepnoncontr', false);
model.geom('geom1').feature('wp2').geom.feature('pi1').set('part', 'part2');
model.geom('geom1').feature('wp2').geom.run('pi1');
model.geom('geom1').feature('wp2').geom.create('pi2', 'PartInstance');
model.geom('geom1').feature('wp2').geom.feature('pi2').set('selkeepnoncontr', false);
model.geom('geom1').feature('wp2').geom.feature('pi2').set('part', 'part5');
model.geom('geom1').feature('wp2').geom.run('pi2');
model.geom('geom1').feature('wp2').geom.create('pi3', 'PartInstance');
model.geom('geom1').feature('wp2').geom.feature('pi3').set('selkeepnoncontr', false);
model.geom('geom1').feature('wp2').geom.feature('pi3').set('part', 'part3');
model.geom('geom1').feature('wp2').geom.run('pi3');
model.geom('geom1').feature('wp2').geom.create('pi4', 'PartInstance');
model.geom('geom1').feature('wp2').geom.feature('pi4').set('selkeepnoncontr', false);
model.geom('geom1').feature('wp2').geom.feature('pi4').set('part', 'part4');
model.geom('geom1').feature('wp2').geom.run('pi4');
model.geom('geom1').run('wp2');
model.geom('geom1').feature.create('ext2', 'Extrude');
model.geom('geom1').feature('ext2').setIndex('distance', 'D_h2', 0);
model.geom('geom1').selection.create('csel2', 'CumulativeSelection');
model.geom('geom1').selection('csel2').label('H2 Gas Electrolyte Compartments');
model.geom('geom1').feature('ext2').set('contributeto', 'csel2');
model.geom('geom1').run('ext2');
model.geom('geom1').create('wp3', 'WorkPlane');
model.geom('geom1').feature('wp3').set('unite', true);
model.geom('geom1').feature('wp3').set('quickplane', 'yz');
model.geom('geom1').feature('wp3').set('quickx', 'D_endplate+D_h2');
model.geom('geom1').feature('wp3').geom.create('pi1', 'PartInstance');
model.geom('geom1').feature('wp3').geom.feature('pi1').set('selkeepnoncontr', false);
model.geom('geom1').feature('wp3').geom.feature('pi1').set('part', 'part2');
model.geom('geom1').run('wp3');
model.geom('geom1').feature.create('ext3', 'Extrude');
model.geom('geom1').feature('ext3').setIndex('distance', 'D_sep', 0);
model.geom('geom1').selection.create('csel3', 'CumulativeSelection');
model.geom('geom1').selection('csel3').label('Separators');
model.geom('geom1').feature('ext3').set('contributeto', 'csel3');
model.geom('geom1').run('ext3');
model.geom('geom1').create('wp4', 'WorkPlane');
model.geom('geom1').feature('wp4').set('unite', true);
model.geom('geom1').feature('wp4').set('quickplane', 'yz');
model.geom('geom1').feature('wp4').set('quickx', 'D_endplate+D_h2+D_sep');
model.geom('geom1').feature('wp4').geom.create('pi1', 'PartInstance');
model.geom('geom1').feature('wp4').geom.feature('pi1').set('selkeepnoncontr', false);
model.geom('geom1').feature('wp4').geom.feature('pi1').set('part', 'part2');
model.geom('geom1').feature('wp4').geom.run('pi1');
model.geom('geom1').feature('wp4').geom.create('pi2', 'PartInstance');
model.geom('geom1').feature('wp4').geom.feature('pi2').set('selkeepnoncontr', false);
model.geom('geom1').feature('wp4').geom.feature('pi2').set('part', 'part6');
model.geom('geom1').feature('wp4').geom.run('pi2');
model.geom('geom1').feature('wp4').geom.create('pi3', 'PartInstance');
model.geom('geom1').feature('wp4').geom.feature('pi3').set('selkeepnoncontr', false);
model.geom('geom1').feature('wp4').geom.feature('pi3').set('part', 'part7');
model.geom('geom1').feature('wp4').geom.run('pi3');
model.geom('geom1').feature('wp4').geom.create('pi4', 'PartInstance');
model.geom('geom1').feature('wp4').geom.feature('pi4').set('selkeepnoncontr', false);
model.geom('geom1').feature('wp4').geom.feature('pi4').set('part', 'part8');
model.geom('geom1').feature('wp4').geom.run('pi4');
model.geom('geom1').run('wp4');
model.geom('geom1').feature.create('ext4', 'Extrude');
model.geom('geom1').feature('ext4').setIndex('distance', 'D_o2', 0);
model.geom('geom1').selection.create('csel4', 'CumulativeSelection');
model.geom('geom1').selection('csel4').label('Oxygen Gas Electrolyte Compartments');
model.geom('geom1').feature('ext4').set('contributeto', 'csel4');
model.geom('geom1').run('ext4');
model.geom('geom1').create('if1', 'If');
model.geom('geom1').feature.createAfter('endif1', 'EndIf', 'if1');
model.geom('geom1').feature('if1').label('If N_cells>1');
model.geom('geom1').feature('if1').set('condition', 'N_cells>1');
model.geom('geom1').run('if1');
model.geom('geom1').create('wp5', 'WorkPlane');
model.geom('geom1').feature('wp5').set('unite', true);
model.geom('geom1').feature('wp5').set('quickplane', 'yz');
model.geom('geom1').feature('wp5').set('quickx', 'D_endplate+D_cell-D_bpp');
model.geom('geom1').feature('wp5').geom.create('pi1', 'PartInstance');
model.geom('geom1').feature('wp5').geom.feature('pi1').set('selkeepnoncontr', false);
model.geom('geom1').feature('wp5').geom.feature('pi1').set('part', 'part2');
model.geom('geom1').feature('wp5').geom.run('pi1');
model.geom('geom1').run('wp5');
model.geom('geom1').feature.create('ext5', 'Extrude');
model.geom('geom1').feature('ext5').setIndex('distance', 'D_bpp', 0);
model.geom('geom1').feature('ext5').set('contributeto', 'csel1');
model.geom('geom1').run('ext5');
model.geom('geom1').create('arr1', 'Array');
model.geom('geom1').feature('arr1').selection('input').set({'ext2' 'ext3' 'ext4'});
model.geom('geom1').feature('arr1').set('fullsize', {'N_cells' '1' '1'});
model.geom('geom1').feature('arr1').set('displ', {'D_cell' '0' '0'});
model.geom('geom1').run('arr1');
model.geom('geom1').create('if2', 'If');
model.geom('geom1').feature.createAfter('endif2', 'EndIf', 'if2');
model.geom('geom1').feature('if2').label('If N_cells>2');
model.geom('geom1').feature('if2').set('condition', 'N_cells>2');
model.geom('geom1').run('if2');
model.geom('geom1').create('arr2', 'Array');
model.geom('geom1').feature('arr2').selection('input').set({'ext5'});
model.geom('geom1').feature('arr2').set('fullsize', {'N_cells-1' '1' '1'});
model.geom('geom1').feature('arr2').set('displ', {'D_cell' '0' '0'});
model.geom('geom1').run('arr2');
model.geom('geom1').feature('endif2').label('End If N_cells>2');
model.geom('geom1').run('endif2');
model.geom('geom1').feature('endif1').label('End If N_cells>1');
model.geom('geom1').run('endif1');
model.geom('geom1').create('wp6', 'WorkPlane');
model.geom('geom1').feature('wp6').set('unite', true);
model.geom('geom1').feature('wp6').set('quickplane', 'yz');
model.geom('geom1').feature('wp6').set('quickx', 'D_endplate+N_cells*D_cell-D_bpp');
model.geom('geom1').feature('wp6').geom.create('pi1', 'PartInstance');
model.geom('geom1').feature('wp6').geom.feature('pi1').set('selkeepnoncontr', false);
model.geom('geom1').feature('wp6').geom.feature('pi1').set('part', 'part2');
model.geom('geom1').feature('wp6').geom.run('pi1');
model.geom('geom1').run('wp6');
model.geom('geom1').feature.create('ext6', 'Extrude');
model.geom('geom1').feature('ext6').setIndex('distance', 'D_endplate', 0);
model.geom('geom1').feature('ext6').set('contributeto', 'csel1');
model.geom('geom1').run('ext6');
model.geom('geom1').create('wp7', 'WorkPlane');
model.geom('geom1').feature('wp7').set('unite', true);
model.geom('geom1').feature('wp7').set('quickplane', 'yz');
model.geom('geom1').feature('wp7').geom.create('pi1', 'PartInstance');
model.geom('geom1').feature('wp7').geom.feature('pi1').set('selkeepnoncontr', false);
model.geom('geom1').feature('wp7').geom.feature('pi1').set('part', 'part3');
model.geom('geom1').run('wp7');
model.geom('geom1').feature.create('ext7', 'Extrude');
model.geom('geom1').feature('ext7').label('Hydrogen Inlet Channel');
model.geom('geom1').feature('ext7').setIndex('distance', 'D_endplate+D_h2+(N_cells-1)*D_cell', 0);
model.geom('geom1').feature('ext7').set('selresult', true);
model.geom('geom1').feature('ext7').set('contributeto', 'csel2');
model.geom('geom1').run('ext7');
model.geom('geom1').create('wp8', 'WorkPlane');
model.geom('geom1').feature('wp8').set('unite', true);
model.geom('geom1').feature('wp8').set('quickplane', 'yz');
model.geom('geom1').feature('wp8').set('quickx', 'D_endplate');
model.geom('geom1').feature('wp8').geom.create('pi1', 'PartInstance');
model.geom('geom1').feature('wp8').geom.feature('pi1').set('selkeepnoncontr', false);
model.geom('geom1').feature('wp8').geom.feature('pi1').set('part', 'part4');
model.geom('geom1').run('wp8');
model.geom('geom1').feature.create('ext8', 'Extrude');
model.geom('geom1').feature('ext8').label('Hydrogen Outlet Channel');
model.geom('geom1').feature('ext8').setIndex('distance', 'N_cells*D_cell-D_bpp+D_endplate', 0);
model.geom('geom1').feature('ext8').set('selresult', true);
model.geom('geom1').feature('ext8').set('contributeto', 'csel2');
model.geom('geom1').run('ext8');
model.geom('geom1').create('wp9', 'WorkPlane');
model.geom('geom1').feature('wp9').set('unite', true);
model.geom('geom1').feature('wp9').set('quickplane', 'yz');
model.geom('geom1').feature('wp9').geom.create('pi1', 'PartInstance');
model.geom('geom1').feature('wp9').geom.feature('pi1').set('selkeepnoncontr', false);
model.geom('geom1').feature('wp9').geom.feature('pi1').set('part', 'part6');
model.geom('geom1').run('wp9');
model.geom('geom1').feature.create('ext9', 'Extrude');
model.geom('geom1').feature('ext9').label('Oxygen Inlet Channel');
model.geom('geom1').feature('ext9').setIndex('distance', 'D_endplate+D_h2+D_sep+D_o2+(N_cells-1)*D_cell', 0);
model.geom('geom1').feature('ext9').set('selresult', true);
model.geom('geom1').feature('ext9').set('contributeto', 'csel4');
model.geom('geom1').run('ext9');
model.geom('geom1').create('wp10', 'WorkPlane');
model.geom('geom1').feature('wp10').set('unite', true);
model.geom('geom1').feature('wp10').set('quickplane', 'yz');
model.geom('geom1').feature('wp10').set('quickx', 'D_endplate+D_cell-D_bpp-D_o2');
model.geom('geom1').feature('wp10').geom.create('pi1', 'PartInstance');
model.geom('geom1').feature('wp10').geom.feature('pi1').set('selkeepnoncontr', false);
model.geom('geom1').feature('wp10').geom.feature('pi1').set('part', 'part7');
model.geom('geom1').run('wp10');
model.geom('geom1').feature.create('ext10', 'Extrude');
model.geom('geom1').feature('ext10').label('Oxygen Outlet Channel');
model.geom('geom1').feature('ext10').setIndex('distance', '(N_cells-1)*D_cell+D_endplate+D_o2', 0);
model.geom('geom1').feature('ext10').set('selresult', true);
model.geom('geom1').feature('ext10').set('contributeto', 'csel4');
model.geom('geom1').run('ext10');
model.geom('geom1').run('fin');
model.geom('geom1').create('boxsel1', 'BoxSelection');
model.geom('geom1').feature('boxsel1').label('Upper Manifolds');
model.geom('geom1').feature('boxsel1').set('zmin', 'H_active/2');
model.geom('geom1').feature('boxsel1').set('zmax', 'H_active/2+H_manifold+H_holes/2');
model.geom('geom1').feature('boxsel1').set('condition', 'inside');
model.geom('geom1').run('boxsel1');
model.geom('geom1').create('boxsel2', 'BoxSelection');
model.geom('geom1').feature('boxsel2').label('Lower Manifolds');
model.geom('geom1').feature('boxsel2').set('zmin', '-H_active/2-H_manifold-H_holes/2');
model.geom('geom1').feature('boxsel2').set('zmax', 'H_active/2');
model.geom('geom1').feature('boxsel2').set('condition', 'inside');
model.geom('geom1').run('boxsel2');
model.geom('geom1').create('unisel1', 'UnionSelection');
model.geom('geom1').feature('unisel1').label('Manifolds');
model.geom('geom1').feature('unisel1').set('input', {'boxsel1' 'boxsel2'});
model.geom('geom1').run('unisel1');
model.geom('geom1').create('unisel2', 'UnionSelection');
model.geom('geom1').feature('unisel2').label('Channels');
model.geom('geom1').feature('unisel2').set('input', {'ext7' 'ext8' 'ext9' 'ext10'});
model.geom('geom1').run('unisel2');
model.geom('geom1').create('comsel1', 'ComplementSelection');
model.geom('geom1').feature('comsel1').label('Active Cell Volume');
model.geom('geom1').feature('comsel1').set('input', {'unisel1' 'unisel2'});
model.geom('geom1').run('comsel1');
model.geom('geom1').create('adjsel1', 'AdjacentSelection');
model.geom('geom1').feature('adjsel1').set('input', {'boxsel1'});
model.geom('geom1').feature('adjsel1').label('Upper Manifold Boundaries');
model.geom('geom1').run('adjsel1');
model.geom('geom1').create('adjsel2', 'AdjacentSelection');
model.geom('geom1').feature('adjsel2').label('Lower Manifold Boundaries');
model.geom('geom1').feature('adjsel2').set('input', {'boxsel2'});
model.geom('geom1').run('adjsel2');
model.geom('geom1').create('adjsel3', 'AdjacentSelection');
model.geom('geom1').feature('adjsel3').label('Active Cell Volume Boundaries');
model.geom('geom1').feature('adjsel3').set('input', {'comsel1'});
model.geom('geom1').feature('adjsel3').set('interior', true);
model.geom('geom1').run('adjsel3');
model.geom('geom1').create('unisel3', 'UnionSelection');
model.geom('geom1').feature('unisel3').label('Electrolyte Compartments');
model.geom('geom1').feature('unisel3').set('input', {'csel2' 'csel3' 'csel4'});
model.geom('geom1').run('unisel3');
model.geom('geom1').create('intsel1', 'IntersectionSelection');
model.geom('geom1').feature('intsel1').label('H2 Electrodes');
model.geom('geom1').feature('intsel1').set('entitydim', 2);
model.geom('geom1').feature('intsel1').set('input', {'csel1' 'csel2' 'adjsel3'});
model.geom('geom1').run('intsel1');
model.geom('geom1').create('intsel2', 'IntersectionSelection');
model.geom('geom1').feature('intsel2').label('O2 Electrodes');
model.geom('geom1').feature('intsel2').set('entitydim', 2);
model.geom('geom1').feature('intsel2').set('input', {'csel1' 'csel4' 'adjsel3'});
model.geom('geom1').run('intsel2');
model.geom('geom1').create('intsel3', 'IntersectionSelection');
model.geom('geom1').feature('intsel3').label('Upper Manifold - Active Cell Boundaries');
model.geom('geom1').feature('intsel3').set('entitydim', 2);
model.geom('geom1').feature('intsel3').set('input', {'adjsel1' 'adjsel3'});
model.geom('geom1').run('intsel3');
model.geom('geom1').create('intsel4', 'IntersectionSelection');
model.geom('geom1').feature('intsel4').label('Lower Manifold - Active Cell Boundaries');
model.geom('geom1').feature('intsel4').set('entitydim', 2);
model.geom('geom1').feature('intsel4').set('input', {'adjsel2' 'adjsel3'});
model.geom('geom1').run('intsel4');
model.geom('geom1').create('unisel4', 'UnionSelection');
model.geom('geom1').feature('unisel4').label('Manifold - Active Cell Boundaries');
model.geom('geom1').feature('unisel4').set('entitydim', 2);
model.geom('geom1').feature('unisel4').set('input', {'intsel3' 'intsel4'});
model.geom('geom1').run('unisel4');
model.geom('geom1').create('boxsel3', 'BoxSelection');
model.geom('geom1').feature('boxsel3').label('Upper Active Area Boundaries');
model.geom('geom1').feature('boxsel3').set('entitydim', 2);
model.geom('geom1').feature('boxsel3').set('zmin', 'H_active/2-H_manifold/2');
model.geom('geom1').feature('boxsel3').set('zmax', 'H_active/2+H_manifold/2');
model.geom('geom1').feature('boxsel3').set('condition', 'inside');
model.geom('geom1').run('boxsel3');
model.geom('geom1').create('boxsel4', 'BoxSelection');
model.geom('geom1').feature('boxsel4').label('Lower Active Area Boundaries');
model.geom('geom1').feature('boxsel4').set('entitydim', 2);
model.geom('geom1').feature('boxsel4').set('zmin', '-(H_active/2+H_manifold/2)');
model.geom('geom1').feature('boxsel4').set('zmax', '-(H_active/2-H_manifold/2)');
model.geom('geom1').feature('boxsel4').set('condition', 'inside');
model.geom('geom1').run('boxsel4');
model.geom('geom1').create('unisel5', 'UnionSelection');
model.geom('geom1').feature('unisel5').label('Upper/Lower Manifold and Active Area Boundaries (for Meshing)');
model.geom('geom1').feature('unisel5').set('entitydim', 2);
model.geom('geom1').feature('unisel5').set('input', {'adjsel1' 'adjsel2' 'boxsel3' 'boxsel4'});
model.geom('geom1').run('unisel5');
model.geom('geom1').create('unisel6', 'UnionSelection');
model.geom('geom1').feature('unisel6').label('Upper/Lower Active Area Boundaries (for Meshing)');
model.geom('geom1').feature('unisel6').set('entitydim', 2);
model.geom('geom1').feature('unisel6').set('input', {'boxsel3' 'boxsel4'});
model.geom('geom1').run('unisel6');
model.geom('geom1').create('unisel7', 'UnionSelection');
model.geom('geom1').feature('unisel7').label('Channels and Manifolds');
model.geom('geom1').feature('unisel7').set('input', {'unisel1' 'unisel2'});

model.title([]);

model.description('');

model.label('aec_shunt_currents_geom_sequence.mph');

model.modelNode.label('Components');

out = model;
