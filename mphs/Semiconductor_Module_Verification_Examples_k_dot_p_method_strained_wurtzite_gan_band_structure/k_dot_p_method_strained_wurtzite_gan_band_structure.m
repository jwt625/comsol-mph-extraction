function out = model
%
% k_dot_p_method_strained_wurtzite_gan_band_structure.m
%
% Model exported on May 26 2025, 21:33 by COMSOL 6.2.0.339.

import com.comsol.model.*
import com.comsol.model.util.*

model = ModelUtil.create('Model');

model.modelPath('/Applications/COMSOL62/Multiphysics/applications/Semiconductor_Module/Verification_Examples');

model.modelNode.create('comp1', true);

model.geom.create('geom1', 2);
model.geom('geom1').model('comp1');

model.mesh.create('mesh1', 'geom1');

model.physics.create('schr', 'SchrodingerEquation', 'geom1', {'psi1' 'psi2' 'psi3'});

model.study.create('std1');
model.study('std1').create('eigv', 'Eigenvalue');
model.study('std1').feature('eigv').set('neigs', '3');
model.study('std1').feature('eigv').set('eigunit', '');
model.study('std1').feature('eigv').set('shift', '0.1');
model.study('std1').feature('eigv').set('conrad', '1');
model.study('std1').feature('eigv').set('conradynhm', '1');
model.study('std1').feature('eigv').set('conlbdy', '0');
model.study('std1').feature('eigv').set('conubdy', '1');
model.study('std1').feature('eigv').set('linpsolnum', 'auto');
model.study('std1').feature('eigv').set('solnum', 'auto');
model.study('std1').feature('eigv').set('notsolnum', 'auto');
model.study('std1').feature('eigv').set('outputmap', {});
model.study('std1').feature('eigv').set('ngenAUX', '1');
model.study('std1').feature('eigv').set('goalngenAUX', '1');
model.study('std1').feature('eigv').set('ngenAUX', '1');
model.study('std1').feature('eigv').set('goalngenAUX', '1');
model.study('std1').feature('eigv').setSolveFor('/physics/schr', true);

model.geom('geom1').lengthUnit([native2unicode(hex2dec({'00' 'c5'}), 'unicode') ]);
model.geom('geom1').create('sq1', 'Square');
model.geom('geom1').runPre('fin');

model.modelNode('comp1').spatialCoord({'x' 'z' 'z'});
model.modelNode('comp1').spatialCoord({'x' 'z' 'y'});
model.modelNode('comp1').materialCoord({'X' 'Z' 'Z'});
model.modelNode('comp1').materialCoord({'X' 'Z' 'Y'});

model.param.label('Parameters 1 - GaN');
model.param.set('Del1', '16[meV]');
model.param.descr('Del1', 'Energy parameters');
model.param.set('Delso', '12[meV]');
model.param.set('Del2', 'Delso/3');
model.param.set('Del3', '4[meV]');
model.param.set('Del', 'sqrt(2)*Del3');
model.param.set('A1', '-6.56');
model.param.descr('A1', 'Valence band effective mass parameters');
model.param.set('A2', '-0.91');
model.param.set('A3', '5.65');
model.param.set('A4', '-2.83');
model.param.set('A5', '-3.13');
model.param.set('A6', '-4.86');
model.param.set('D1', '0.7[eV]');
model.param.descr('D1', 'Deformation potentials');
model.param.set('D2', '2.1[eV]');
model.param.set('D3', '1.4[eV]');
model.param.set('D4', '-0.7[eV]');
model.param.set('C13', '15.8e11[dyn/cm^2]');
model.param.descr('C13', 'Elastic stiffness constants');
model.param.set('C33', '26.7e11[dyn/cm^2]');
model.param('default').setShowInParamSel(false);
model.param.create('par2');
model.param('par2').label('Parameters 2 - Sweeps');
model.param('par2').set('epsxx', '-0.01');
model.param('par2').descr('epsxx', 'Strain,xx');
model.param('par2').set('epsyy', 'epsxx');
model.param('par2').descr('epsyy', 'Strain,yy');
model.param('par2').set('epszz', '-2*C13/C33*epsxx');
model.param('par2').descr('epszz', 'Strain,zz');
model.param('par2').set('kp', '0[rad/nm]');
model.param('par2').descr('kp', 'Positive axis: kx, negative axis: kz');
model.param('par2').set('kx', 'if(kp>0,kp,0[rad/nm])');
model.param('par2').set('ky', '0[rad/nm]');
model.param('par2').set('kz', 'if(kp<0,-kp,0[rad/nm])');
model.param.create('par3');
model.param('par3').label('Parameters 3 - Analytic formula');
model.param('par3').setShowInParamSel(false);
model.param('par3').set('F', 'Del1+Del2+lm+th');
model.param('par3').descr('F', 'Eq. (34)');
model.param('par3').set('G', 'Del1-Del2+lm+th');
model.param('par3').set('lm', 'hbar_const^2/2/me_const*(A1*kz^2+A2*(kx^2+ky^2))+lmeps');
model.param('par3').set('lmeps', 'D1*epszz+D2*(epsxx+epsyy)');
model.param('par3').set('th', 'hbar_const^2/2/me_const*(A3*kz^2+A4*(kx^2+ky^2))+theps');
model.param('par3').set('theps', 'D3*epszz+D4*(epsxx+epsyy)');
model.param('par3').set('Kt', 'hbar_const^2/2/me_const*A5*kt^2');
model.param('par3').descr('Kt', 'Eq. (42)');
model.param('par3').set('Ht', 'hbar_const^2/2/me_const*A6*kt*kz');
model.param('par3').set('kt', 'sqrt(kx^2+ky^2)');

model.physics.create('ge', 'GlobalEquations', 'geom1');
model.physics('ge').model('comp1');

model.study('std1').feature('eigv').setSolveFor('/physics/ge', true);

model.physics('ge').prop('EquationForm').set('form', 'Automatic');

model.geom('geom1').run;

model.physics('ge').feature('ge1').setIndex('name', 'u1', 0, 0);
model.physics('ge').feature('ge1').setIndex('equation', '(F     *u1+Kt              *u2-i*Ht          *u3)/1[meV]-lambda*u1', 0, 0);
model.physics('ge').feature('ge1').setIndex('name', 'u2', 1, 0);
model.physics('ge').feature('ge1').setIndex('equation', '', 1, 0);
model.physics('ge').feature('ge1').setIndex('initialValueU', 0, 1, 0);
model.physics('ge').feature('ge1').setIndex('initialValueUt', 0, 1, 0);
model.physics('ge').feature('ge1').setIndex('description', '', 1, 0);
model.physics('ge').feature('ge1').setIndex('equation', '(Kt   *u1+G               *u2+(Del-i*Ht)*u3)/1[meV]-lambda*u2', 1, 0);
model.physics('ge').feature('ge1').setIndex('name', 'u3', 2, 0);
model.physics('ge').feature('ge1').setIndex('equation', '', 2, 0);
model.physics('ge').feature('ge1').setIndex('initialValueU', 0, 2, 0);
model.physics('ge').feature('ge1').setIndex('initialValueUt', 0, 2, 0);
model.physics('ge').feature('ge1').setIndex('description', '', 2, 0);
model.physics('ge').feature('ge1').setIndex('equation', '(i*Ht*u1+(Del+i*Ht)*u2+lm           *u3)/1[meV]-lambda*u3', 2, 0);
model.physics('schr').prop('ModelProperties').set('lambda_scale', '1[meV]');
model.physics('schr').create('H2nd1', 'SecondOrderHamiltonianSemicond', 2);
model.physics('schr').feature('H2nd1').label('Second Order Hamiltonian 1: Diagonal F, G, lambda');
model.physics('schr').feature('H2nd1').selection.all;
model.physics('schr').feature('H2nd1').setIndex('i', 2, 0, 0);
model.physics('schr').feature('H2nd1').setIndex('A', 'A1+A3', 0, 0);
model.physics('schr').feature('H2nd1').setIndex('j', 2, 0, 0);
model.physics('schr').feature('H2nd1').setIndex('desc', 'F: lambda+theta', 0, 0);
model.physics('schr').feature('H2nd1').setIndex('m', 1, 1, 0);
model.physics('schr').feature('H2nd1').setIndex('n', 1, 1, 0);
model.physics('schr').feature('H2nd1').setIndex('i', 1, 1, 0);
model.physics('schr').feature('H2nd1').setIndex('A', 0, 1, 0);
model.physics('schr').feature('H2nd1').setIndex('j', 1, 1, 0);
model.physics('schr').feature('H2nd1').setIndex('desc', 'Description', 1, 0);
model.physics('schr').feature('H2nd1').setIndex('n', 1, 1, 0);
model.physics('schr').feature('H2nd1').setIndex('i', 1, 1, 0);
model.physics('schr').feature('H2nd1').setIndex('A', 0, 1, 0);
model.physics('schr').feature('H2nd1').setIndex('j', 1, 1, 0);
model.physics('schr').feature('H2nd1').setIndex('desc', 'Description', 1, 0);
model.physics('schr').feature('H2nd1').setIndex('m', 1, 1, 0);
model.physics('schr').feature('H2nd1').setIndex('n', 1, 1, 0);
model.physics('schr').feature('H2nd1').setIndex('i', 1, 1, 0);
model.physics('schr').feature('H2nd1').setIndex('A', 0, 1, 0);
model.physics('schr').feature('H2nd1').setIndex('j', 1, 1, 0);
model.physics('schr').feature('H2nd1').setIndex('desc', 'Description', 1, 0);
model.physics('schr').feature('H2nd1').setIndex('A', 'A2+A4', 1, 0);
model.physics('schr').feature('H2nd1').setIndex('desc', 'F: lambda+theta', 1, 0);
model.physics('schr').feature('H2nd1').setIndex('m', 1, 2, 0);
model.physics('schr').feature('H2nd1').setIndex('n', 1, 2, 0);
model.physics('schr').feature('H2nd1').setIndex('i', 1, 2, 0);
model.physics('schr').feature('H2nd1').setIndex('A', 0, 2, 0);
model.physics('schr').feature('H2nd1').setIndex('j', 1, 2, 0);
model.physics('schr').feature('H2nd1').setIndex('desc', 'Description', 2, 0);
model.physics('schr').feature('H2nd1').setIndex('n', 1, 2, 0);
model.physics('schr').feature('H2nd1').setIndex('i', 1, 2, 0);
model.physics('schr').feature('H2nd1').setIndex('A', 0, 2, 0);
model.physics('schr').feature('H2nd1').setIndex('j', 1, 2, 0);
model.physics('schr').feature('H2nd1').setIndex('desc', 'Description', 2, 0);
model.physics('schr').feature('H2nd1').setIndex('m', 1, 2, 0);
model.physics('schr').feature('H2nd1').setIndex('n', 1, 2, 0);
model.physics('schr').feature('H2nd1').setIndex('i', 1, 2, 0);
model.physics('schr').feature('H2nd1').setIndex('A', 0, 2, 0);
model.physics('schr').feature('H2nd1').setIndex('j', 1, 2, 0);
model.physics('schr').feature('H2nd1').setIndex('desc', 'Description', 2, 0);
model.physics('schr').feature('H2nd1').setIndex('m', 2, 2, 0);
model.physics('schr').feature('H2nd1').setIndex('n', 2, 2, 0);
model.physics('schr').feature('H2nd1').setIndex('i', 2, 2, 0);
model.physics('schr').feature('H2nd1').setIndex('A', 'A1+A3', 2, 0);
model.physics('schr').feature('H2nd1').setIndex('j', 2, 2, 0);
model.physics('schr').feature('H2nd1').setIndex('desc', 'G: lambda+theta', 2, 0);
model.physics('schr').feature('H2nd1').setIndex('m', 1, 3, 0);
model.physics('schr').feature('H2nd1').setIndex('n', 1, 3, 0);
model.physics('schr').feature('H2nd1').setIndex('i', 1, 3, 0);
model.physics('schr').feature('H2nd1').setIndex('A', 0, 3, 0);
model.physics('schr').feature('H2nd1').setIndex('j', 1, 3, 0);
model.physics('schr').feature('H2nd1').setIndex('desc', 'Description', 3, 0);
model.physics('schr').feature('H2nd1').setIndex('n', 1, 3, 0);
model.physics('schr').feature('H2nd1').setIndex('i', 1, 3, 0);
model.physics('schr').feature('H2nd1').setIndex('A', 0, 3, 0);
model.physics('schr').feature('H2nd1').setIndex('j', 1, 3, 0);
model.physics('schr').feature('H2nd1').setIndex('desc', 'Description', 3, 0);
model.physics('schr').feature('H2nd1').setIndex('m', 1, 3, 0);
model.physics('schr').feature('H2nd1').setIndex('n', 1, 3, 0);
model.physics('schr').feature('H2nd1').setIndex('i', 1, 3, 0);
model.physics('schr').feature('H2nd1').setIndex('A', 0, 3, 0);
model.physics('schr').feature('H2nd1').setIndex('j', 1, 3, 0);
model.physics('schr').feature('H2nd1').setIndex('desc', 'Description', 3, 0);
model.physics('schr').feature('H2nd1').setIndex('m', 2, 3, 0);
model.physics('schr').feature('H2nd1').setIndex('n', 2, 3, 0);
model.physics('schr').feature('H2nd1').setIndex('A', 'A2+A4', 3, 0);
model.physics('schr').feature('H2nd1').setIndex('desc', 'G: lambda+theta', 3, 0);
model.physics('schr').feature('H2nd1').setIndex('m', 1, 4, 0);
model.physics('schr').feature('H2nd1').setIndex('n', 1, 4, 0);
model.physics('schr').feature('H2nd1').setIndex('i', 1, 4, 0);
model.physics('schr').feature('H2nd1').setIndex('A', 0, 4, 0);
model.physics('schr').feature('H2nd1').setIndex('j', 1, 4, 0);
model.physics('schr').feature('H2nd1').setIndex('desc', 'Description', 4, 0);
model.physics('schr').feature('H2nd1').setIndex('n', 1, 4, 0);
model.physics('schr').feature('H2nd1').setIndex('i', 1, 4, 0);
model.physics('schr').feature('H2nd1').setIndex('A', 0, 4, 0);
model.physics('schr').feature('H2nd1').setIndex('j', 1, 4, 0);
model.physics('schr').feature('H2nd1').setIndex('desc', 'Description', 4, 0);
model.physics('schr').feature('H2nd1').setIndex('m', 1, 4, 0);
model.physics('schr').feature('H2nd1').setIndex('n', 1, 4, 0);
model.physics('schr').feature('H2nd1').setIndex('i', 1, 4, 0);
model.physics('schr').feature('H2nd1').setIndex('A', 0, 4, 0);
model.physics('schr').feature('H2nd1').setIndex('j', 1, 4, 0);
model.physics('schr').feature('H2nd1').setIndex('desc', 'Description', 4, 0);
model.physics('schr').feature('H2nd1').setIndex('m', 3, 4, 0);
model.physics('schr').feature('H2nd1').setIndex('n', 3, 4, 0);
model.physics('schr').feature('H2nd1').setIndex('i', 2, 4, 0);
model.physics('schr').feature('H2nd1').setIndex('A', 'A1', 4, 0);
model.physics('schr').feature('H2nd1').setIndex('j', 2, 4, 0);
model.physics('schr').feature('H2nd1').setIndex('desc', 'lambda', 4, 0);
model.physics('schr').feature('H2nd1').setIndex('m', 1, 5, 0);
model.physics('schr').feature('H2nd1').setIndex('n', 1, 5, 0);
model.physics('schr').feature('H2nd1').setIndex('i', 1, 5, 0);
model.physics('schr').feature('H2nd1').setIndex('A', 0, 5, 0);
model.physics('schr').feature('H2nd1').setIndex('j', 1, 5, 0);
model.physics('schr').feature('H2nd1').setIndex('desc', 'Description', 5, 0);
model.physics('schr').feature('H2nd1').setIndex('n', 1, 5, 0);
model.physics('schr').feature('H2nd1').setIndex('i', 1, 5, 0);
model.physics('schr').feature('H2nd1').setIndex('A', 0, 5, 0);
model.physics('schr').feature('H2nd1').setIndex('j', 1, 5, 0);
model.physics('schr').feature('H2nd1').setIndex('desc', 'Description', 5, 0);
model.physics('schr').feature('H2nd1').setIndex('m', 1, 5, 0);
model.physics('schr').feature('H2nd1').setIndex('n', 1, 5, 0);
model.physics('schr').feature('H2nd1').setIndex('i', 1, 5, 0);
model.physics('schr').feature('H2nd1').setIndex('A', 0, 5, 0);
model.physics('schr').feature('H2nd1').setIndex('j', 1, 5, 0);
model.physics('schr').feature('H2nd1').setIndex('desc', 'Description', 5, 0);
model.physics('schr').feature('H2nd1').setIndex('m', 3, 5, 0);
model.physics('schr').feature('H2nd1').setIndex('n', 3, 5, 0);
model.physics('schr').feature('H2nd1').setIndex('A', 'A2', 5, 0);
model.physics('schr').feature('H2nd1').setIndex('desc', 'lambda', 5, 0);
model.physics('schr').feature('meff1').active(false);
model.physics('schr').feature('ve1').label('Electron Potential Energy 1: Diagonal F, G, lambda');
model.physics('schr').feature('ve1').set('Ve_psi1', 'Del1+Del2+lmeps+theps');
model.physics('schr').feature('ve1').set('Ve_psi2', 'Del1-Del2+lmeps+theps');
model.physics('schr').feature('ve1').set('Ve_psi3', 'lmeps');
model.physics('schr').create('H2nd2', 'SecondOrderHamiltonianSemicond', 2);
model.physics('schr').feature('H2nd2').label('Second Order Hamiltonian 2: Off-diagonal Kt, Ht');
model.physics('schr').feature('H2nd2').selection.all;
model.physics('schr').feature('H2nd2').setIndex('n', 2, 0, 0);
model.physics('schr').feature('H2nd2').setIndex('A', 'A5', 0, 0);
model.physics('schr').feature('H2nd2').setIndex('desc', 'Kt', 0, 0);
model.physics('schr').feature('H2nd2').setIndex('m', 1, 1, 0);
model.physics('schr').feature('H2nd2').setIndex('n', 1, 1, 0);
model.physics('schr').feature('H2nd2').setIndex('i', 1, 1, 0);
model.physics('schr').feature('H2nd2').setIndex('A', 0, 1, 0);
model.physics('schr').feature('H2nd2').setIndex('j', 1, 1, 0);
model.physics('schr').feature('H2nd2').setIndex('desc', 'Description', 1, 0);
model.physics('schr').feature('H2nd2').setIndex('n', 1, 1, 0);
model.physics('schr').feature('H2nd2').setIndex('i', 1, 1, 0);
model.physics('schr').feature('H2nd2').setIndex('A', 0, 1, 0);
model.physics('schr').feature('H2nd2').setIndex('j', 1, 1, 0);
model.physics('schr').feature('H2nd2').setIndex('desc', 'Description', 1, 0);
model.physics('schr').feature('H2nd2').setIndex('m', 1, 1, 0);
model.physics('schr').feature('H2nd2').setIndex('n', 1, 1, 0);
model.physics('schr').feature('H2nd2').setIndex('i', 1, 1, 0);
model.physics('schr').feature('H2nd2').setIndex('A', 0, 1, 0);
model.physics('schr').feature('H2nd2').setIndex('j', 1, 1, 0);
model.physics('schr').feature('H2nd2').setIndex('desc', 'Description', 1, 0);
model.physics('schr').feature('H2nd2').setIndex('m', 2, 1, 0);
model.physics('schr').feature('H2nd2').setIndex('A', 'A5', 1, 0);
model.physics('schr').feature('H2nd2').setIndex('desc', 'Kt', 1, 0);
model.physics('schr').feature('H2nd2').setIndex('m', 1, 2, 0);
model.physics('schr').feature('H2nd2').setIndex('n', 1, 2, 0);
model.physics('schr').feature('H2nd2').setIndex('i', 1, 2, 0);
model.physics('schr').feature('H2nd2').setIndex('A', 0, 2, 0);
model.physics('schr').feature('H2nd2').setIndex('j', 1, 2, 0);
model.physics('schr').feature('H2nd2').setIndex('desc', 'Description', 2, 0);
model.physics('schr').feature('H2nd2').setIndex('n', 1, 2, 0);
model.physics('schr').feature('H2nd2').setIndex('i', 1, 2, 0);
model.physics('schr').feature('H2nd2').setIndex('A', 0, 2, 0);
model.physics('schr').feature('H2nd2').setIndex('j', 1, 2, 0);
model.physics('schr').feature('H2nd2').setIndex('desc', 'Description', 2, 0);
model.physics('schr').feature('H2nd2').setIndex('m', 1, 2, 0);
model.physics('schr').feature('H2nd2').setIndex('n', 1, 2, 0);
model.physics('schr').feature('H2nd2').setIndex('i', 1, 2, 0);
model.physics('schr').feature('H2nd2').setIndex('A', 0, 2, 0);
model.physics('schr').feature('H2nd2').setIndex('j', 1, 2, 0);
model.physics('schr').feature('H2nd2').setIndex('desc', 'Description', 2, 0);
model.physics('schr').feature('H2nd2').setIndex('n', 3, 2, 0);
model.physics('schr').feature('H2nd2').setIndex('A', '-i*A6', 2, 0);
model.physics('schr').feature('H2nd2').setIndex('j', 2, 2, 0);
model.physics('schr').feature('H2nd2').setIndex('desc', 'Ht', 2, 0);
model.physics('schr').feature('H2nd2').setIndex('m', 1, 3, 0);
model.physics('schr').feature('H2nd2').setIndex('n', 1, 3, 0);
model.physics('schr').feature('H2nd2').setIndex('i', 1, 3, 0);
model.physics('schr').feature('H2nd2').setIndex('A', 0, 3, 0);
model.physics('schr').feature('H2nd2').setIndex('j', 1, 3, 0);
model.physics('schr').feature('H2nd2').setIndex('desc', 'Description', 3, 0);
model.physics('schr').feature('H2nd2').setIndex('n', 1, 3, 0);
model.physics('schr').feature('H2nd2').setIndex('i', 1, 3, 0);
model.physics('schr').feature('H2nd2').setIndex('A', 0, 3, 0);
model.physics('schr').feature('H2nd2').setIndex('j', 1, 3, 0);
model.physics('schr').feature('H2nd2').setIndex('desc', 'Description', 3, 0);
model.physics('schr').feature('H2nd2').setIndex('m', 1, 3, 0);
model.physics('schr').feature('H2nd2').setIndex('n', 1, 3, 0);
model.physics('schr').feature('H2nd2').setIndex('i', 1, 3, 0);
model.physics('schr').feature('H2nd2').setIndex('A', 0, 3, 0);
model.physics('schr').feature('H2nd2').setIndex('j', 1, 3, 0);
model.physics('schr').feature('H2nd2').setIndex('desc', 'Description', 3, 0);
model.physics('schr').feature('H2nd2').setIndex('m', 3, 3, 0);
model.physics('schr').feature('H2nd2').setIndex('A', 'i*A6', 3, 0);
model.physics('schr').feature('H2nd2').setIndex('j', 2, 3, 0);
model.physics('schr').feature('H2nd2').setIndex('desc', 'Ht', 3, 0);
model.physics('schr').feature('H2nd2').setIndex('m', 1, 4, 0);
model.physics('schr').feature('H2nd2').setIndex('n', 1, 4, 0);
model.physics('schr').feature('H2nd2').setIndex('i', 1, 4, 0);
model.physics('schr').feature('H2nd2').setIndex('A', 0, 4, 0);
model.physics('schr').feature('H2nd2').setIndex('j', 1, 4, 0);
model.physics('schr').feature('H2nd2').setIndex('desc', 'Description', 4, 0);
model.physics('schr').feature('H2nd2').setIndex('n', 1, 4, 0);
model.physics('schr').feature('H2nd2').setIndex('i', 1, 4, 0);
model.physics('schr').feature('H2nd2').setIndex('A', 0, 4, 0);
model.physics('schr').feature('H2nd2').setIndex('j', 1, 4, 0);
model.physics('schr').feature('H2nd2').setIndex('desc', 'Description', 4, 0);
model.physics('schr').feature('H2nd2').setIndex('m', 1, 4, 0);
model.physics('schr').feature('H2nd2').setIndex('n', 1, 4, 0);
model.physics('schr').feature('H2nd2').setIndex('i', 1, 4, 0);
model.physics('schr').feature('H2nd2').setIndex('A', 0, 4, 0);
model.physics('schr').feature('H2nd2').setIndex('j', 1, 4, 0);
model.physics('schr').feature('H2nd2').setIndex('desc', 'Description', 4, 0);
model.physics('schr').feature('H2nd2').setIndex('m', 2, 4, 0);
model.physics('schr').feature('H2nd2').setIndex('n', 3, 4, 0);
model.physics('schr').feature('H2nd2').setIndex('A', '-i*A6', 4, 0);
model.physics('schr').feature('H2nd2').setIndex('j', 2, 4, 0);
model.physics('schr').feature('H2nd2').setIndex('desc', 'Ht', 4, 0);
model.physics('schr').feature('H2nd2').setIndex('m', 1, 5, 0);
model.physics('schr').feature('H2nd2').setIndex('n', 1, 5, 0);
model.physics('schr').feature('H2nd2').setIndex('i', 1, 5, 0);
model.physics('schr').feature('H2nd2').setIndex('A', 0, 5, 0);
model.physics('schr').feature('H2nd2').setIndex('j', 1, 5, 0);
model.physics('schr').feature('H2nd2').setIndex('desc', 'Description', 5, 0);
model.physics('schr').feature('H2nd2').setIndex('n', 1, 5, 0);
model.physics('schr').feature('H2nd2').setIndex('i', 1, 5, 0);
model.physics('schr').feature('H2nd2').setIndex('A', 0, 5, 0);
model.physics('schr').feature('H2nd2').setIndex('j', 1, 5, 0);
model.physics('schr').feature('H2nd2').setIndex('desc', 'Description', 5, 0);
model.physics('schr').feature('H2nd2').setIndex('m', 1, 5, 0);
model.physics('schr').feature('H2nd2').setIndex('n', 1, 5, 0);
model.physics('schr').feature('H2nd2').setIndex('i', 1, 5, 0);
model.physics('schr').feature('H2nd2').setIndex('A', 0, 5, 0);
model.physics('schr').feature('H2nd2').setIndex('j', 1, 5, 0);
model.physics('schr').feature('H2nd2').setIndex('desc', 'Description', 5, 0);
model.physics('schr').feature('H2nd2').setIndex('m', 3, 5, 0);
model.physics('schr').feature('H2nd2').setIndex('n', 2, 5, 0);
model.physics('schr').feature('H2nd2').setIndex('A', 'i*A6', 5, 0);
model.physics('schr').feature('H2nd2').setIndex('j', 2, 5, 0);
model.physics('schr').feature('H2nd2').setIndex('desc', 'Ht', 5, 0);
model.physics('schr').create('H0th1', 'ZerothOrderHamiltonianSemicond', 2);
model.physics('schr').feature('H0th1').label('Zeroth Order Hamiltonian 1: Off-diagonal Delta');
model.physics('schr').feature('H0th1').selection.all;
model.physics('schr').feature('H0th1').setIndex('m', 2, 0, 0);
model.physics('schr').feature('H0th1').setIndex('n', 3, 0, 0);
model.physics('schr').feature('H0th1').setIndex('H0', 'Del*2*me_const/hbar_const^2', 0, 0);
model.physics('schr').feature('H0th1').setIndex('desc', 'Delta', 0, 0);
model.physics('schr').feature('H0th1').setIndex('m', 1, 1, 0);
model.physics('schr').feature('H0th1').setIndex('n', 1, 1, 0);
model.physics('schr').feature('H0th1').setIndex('H0', 0, 1, 0);
model.physics('schr').feature('H0th1').setIndex('desc', 'Description', 1, 0);
model.physics('schr').feature('H0th1').setIndex('n', 1, 1, 0);
model.physics('schr').feature('H0th1').setIndex('H0', 0, 1, 0);
model.physics('schr').feature('H0th1').setIndex('desc', 'Description', 1, 0);
model.physics('schr').feature('H0th1').setIndex('m', 1, 1, 0);
model.physics('schr').feature('H0th1').setIndex('n', 1, 1, 0);
model.physics('schr').feature('H0th1').setIndex('H0', 0, 1, 0);
model.physics('schr').feature('H0th1').setIndex('desc', 'Description', 1, 0);
model.physics('schr').feature('H0th1').setIndex('m', 3, 1, 0);
model.physics('schr').feature('H0th1').setIndex('n', 2, 1, 0);
model.physics('schr').feature('H0th1').setIndex('H0', 'Del*2*me_const/hbar_const^2', 1, 0);
model.physics('schr').feature('H0th1').setIndex('desc', 'Delta', 1, 0);
model.physics('schr').create('pc1', 'PeriodicCondition', 1);
model.physics('schr').feature('pc1').selection.set([1 4]);
model.physics('schr').feature('pc1').set('PeriodicType', 'Floquet');
model.physics('schr').feature('pc1').set('kF', {'kx' 'kz' '0'});
model.physics('schr').feature.duplicate('pc2', 'pc1');
model.physics('schr').feature('pc2').selection.set([2 3]);

model.mesh('mesh1').create('map1', 'Map');
model.mesh('mesh1').feature('map1').create('dis1', 'Distribution');
model.mesh('mesh1').feature('map1').feature('dis1').selection.all;
model.mesh('mesh1').feature('map1').feature('dis1').set('numelem', 2);
model.mesh('mesh1').run;

model.study('std1').label(['Study 1: Fig. 5. Schr' native2unicode(hex2dec({'00' 'f6'}), 'unicode') 'dinger Eq.']);
model.study('std1').setGenPlots(false);
model.study('std1').feature('eigv').set('shift', '10');
model.study('std1').feature('eigv').setEntry('activate', 'ge', false);
model.study('std1').feature('eigv').set('useparam', true);
model.study('std1').feature('eigv').set('sweeptype', 'filled');
model.study('std1').feature('eigv').setIndex('pname', 'epsxx', 0);
model.study('std1').feature('eigv').setIndex('plistarr', '', 0);
model.study('std1').feature('eigv').setIndex('punit', '', 0);
model.study('std1').feature('eigv').setIndex('pname', 'epsxx', 0);
model.study('std1').feature('eigv').setIndex('plistarr', '', 0);
model.study('std1').feature('eigv').setIndex('punit', '', 0);
model.study('std1').feature('eigv').setIndex('plistarr', '0 -0.01', 0);
model.study('std1').feature('eigv').setIndex('pname', 'epsyy', 1);
model.study('std1').feature('eigv').setIndex('plistarr', '', 1);
model.study('std1').feature('eigv').setIndex('punit', '', 1);
model.study('std1').feature('eigv').setIndex('pname', 'epsyy', 1);
model.study('std1').feature('eigv').setIndex('plistarr', '', 1);
model.study('std1').feature('eigv').setIndex('punit', '', 1);
model.study('std1').feature('eigv').setIndex('pname', 'kp', 1);
model.study('std1').feature('eigv').setIndex('plistarr', 'range(-0.12,0.005,0.12)', 1);
model.study('std1').feature('eigv').setIndex('punit', '1/angstrom', 1);

model.sol.create('sol1');
model.sol('sol1').study('std1');
model.sol('sol1').create('st1', 'StudyStep');
model.sol('sol1').feature('st1').set('study', 'std1');
model.sol('sol1').feature('st1').set('studystep', 'eigv');
model.sol('sol1').create('v1', 'Variables');
model.sol('sol1').feature('v1').set('control', 'eigv');
model.sol('sol1').create('e1', 'Eigenvalue');
model.sol('sol1').feature('e1').create('ep1', 'EigenvalueParam');
model.sol('sol1').feature('e1').feature('ep1').set('control', 'eigv');
model.sol('sol1').feature('e1').set('neigs', 6);
model.sol('sol1').feature('e1').set('shift', '0');
model.sol('sol1').feature('e1').set('rtol', 1.0E-10);
model.sol('sol1').feature('e1').set('transform', 'none');
model.sol('sol1').feature('e1').set('eigref', '0.1');
model.sol('sol1').feature('e1').set('eigvfunscale', 'average');
model.sol('sol1').feature('e1').set('control', 'eigv');
model.sol('sol1').attach('std1');
model.sol('sol1').runAll;

model.result.create('pg1', 'PlotGroup1D');
model.result('pg1').run;
model.result('pg1').label('Fig. 5. Unstrained');
model.result('pg1').set('data', 'none');
model.result('pg1').set('titletype', 'label');
model.result('pg1').set('xlabelactive', true);
model.result('pg1').set('xlabel', 'Negative axis: kz    Positive axis: kx   (1/angstrom)');
model.result('pg1').set('ylabelactive', true);
model.result('pg1').set('ylabel', 'Energy (meV)');
model.result('pg1').set('axislimits', true);
model.result('pg1').set('xmin', -0.12);
model.result('pg1').set('xmax', 0.12);
model.result('pg1').set('ymin', -100);
model.result('pg1').set('ymax', 50);
model.result('pg1').create('glob1', 'Global');
model.result('pg1').feature('glob1').set('markerpos', 'datapoints');
model.result('pg1').feature('glob1').set('linewidth', 'preference');
model.result('pg1').feature('glob1').label(['Global 1 - Schr' native2unicode(hex2dec({'00' 'f6'}), 'unicode') 'dinger Eq. HH']);
model.result('pg1').feature('glob1').set('data', 'dset1');
model.result('pg1').feature('glob1').setIndex('looplevelinput', 'first', 2);
model.result('pg1').feature('glob1').setIndex('looplevelinput', 'last', 0);
model.result('pg1').feature('glob1').set('expr', {});
model.result('pg1').feature('glob1').set('descr', {});
model.result('pg1').feature('glob1').setIndex('expr', 'lambda', 0);
model.result('pg1').feature('glob1').setIndex('descr', 'HH', 0);
model.result('pg1').feature('glob1').set('xdata', 'expr');
model.result('pg1').feature('glob1').set('xdataexpr', 'kp/1[angstrom^-1]');
model.result('pg1').feature.duplicate('glob2', 'glob1');
model.result('pg1').run;
model.result('pg1').feature('glob2').label(['Global 1 - Schr' native2unicode(hex2dec({'00' 'f6'}), 'unicode') 'dinger Eq. LH']);
model.result('pg1').feature('glob2').setIndex('looplevelinput', 'manualindices', 0);
model.result('pg1').feature('glob2').setIndex('looplevelindices', 2, 0);
model.result('pg1').feature('glob2').setIndex('descr', 'LH', 0);
model.result('pg1').feature.duplicate('glob3', 'glob2');
model.result('pg1').run;
model.result('pg1').feature('glob3').label(['Global 1 - Schr' native2unicode(hex2dec({'00' 'f6'}), 'unicode') 'dinger Eq. CH']);
model.result('pg1').feature('glob3').setIndex('looplevelinput', 'first', 0);
model.result('pg1').feature('glob3').setIndex('descr', 'CH', 0);
model.result('pg1').run;
model.result.duplicate('pg2', 'pg1');
model.result('pg2').run;
model.result('pg2').label('Fig. 5. -1% Strained');
model.result('pg2').run;
model.result('pg2').feature('glob1').setIndex('looplevelinput', 'last', 2);
model.result('pg2').run;
model.result('pg2').feature('glob2').setIndex('looplevelinput', 'last', 2);
model.result('pg2').run;
model.result('pg2').feature('glob3').setIndex('looplevelinput', 'last', 2);

model.study.create('std2');
model.study('std2').label('Study 2: Fig. 5. Analytic');
model.study('std2').setGenPlots(false);
model.study('std2').feature.copy('eigv1', 'std1/eigv');
model.study('std2').feature('eigv1').set('eigsolver', 'lapack');
model.study('std2').feature('eigv1').setEntry('activate', 'schr', false);
model.study('std2').feature('eigv1').setEntry('activate', 'ge', true);
model.study('std2').feature('eigv1').setIndex('plistarr', 'range(-0.12,0.01,0.12)', 1);

model.sol.create('sol2');
model.sol('sol2').study('std2');
model.sol('sol2').create('st1', 'StudyStep');
model.sol('sol2').feature('st1').set('study', 'std2');
model.sol('sol2').feature('st1').set('studystep', 'eigv1');
model.sol('sol2').create('v1', 'Variables');
model.sol('sol2').feature('v1').set('control', 'eigv1');
model.sol('sol2').create('e1', 'Eigenvalue');
model.sol('sol2').feature('e1').create('ep1', 'EigenvalueParam');
model.sol('sol2').feature('e1').feature('ep1').set('control', 'eigv1');
model.sol('sol2').feature('e1').set('control', 'eigv1');
model.sol('sol2').attach('std2');
model.sol('sol2').runAll;

model.result('pg1').run;
model.result('pg1').feature.duplicate('glob4', 'glob3');
model.result('pg1').run;
model.result('pg1').feature('glob4').label('Global 1 - Analytic');
model.result('pg1').feature('glob4').set('data', 'dset2');
model.result('pg1').feature('glob4').setIndex('looplevelinput', 'all', 0);
model.result('pg1').feature('glob4').setIndex('descr', 'Analytic', 0);
model.result('pg1').feature('glob4').set('linestyle', 'none');
model.result('pg1').feature('glob4').set('linemarker', 'circle');
model.result('pg1').run;
model.result('pg2').run;
model.result('pg2').feature.copy('glob4', 'pg1/glob4');
model.result('pg2').run;
model.result('pg2').feature('glob4').setIndex('looplevelinput', 'last', 2);
model.result('pg2').run;

model.study.create('std3');
model.study('std3').label(['Study 3: 2D Dispersion Schr' native2unicode(hex2dec({'00' 'f6'}), 'unicode') 'dinger Eq.']);
model.study('std3').setGenPlots(false);
model.study('std3').feature.copy('eigv1', 'std1/eigv');
model.study('std3').feature('eigv1').setIndex('pname', 'kx', 0);
model.study('std3').feature('eigv1').setIndex('plistarr', 'range(0,0.1,1)*0.07', 0);
model.study('std3').feature('eigv1').setIndex('punit', '1/angstrom', 0);
model.study('std3').feature('eigv1').setIndex('pname', 'kz', 1);
model.study('std3').feature('eigv1').setIndex('plistarr', 'range(0,0.1,1)*0.07', 1);

model.sol.create('sol3');
model.sol('sol3').study('std3');
model.sol('sol3').create('st1', 'StudyStep');
model.sol('sol3').feature('st1').set('study', 'std3');
model.sol('sol3').feature('st1').set('studystep', 'eigv1');
model.sol('sol3').create('v1', 'Variables');
model.sol('sol3').feature('v1').set('control', 'eigv1');
model.sol('sol3').create('e1', 'Eigenvalue');
model.sol('sol3').feature('e1').create('ep1', 'EigenvalueParam');
model.sol('sol3').feature('e1').feature('ep1').set('control', 'eigv1');
model.sol('sol3').feature('e1').set('neigs', 6);
model.sol('sol3').feature('e1').set('shift', '0');
model.sol('sol3').feature('e1').set('rtol', 1.0E-10);
model.sol('sol3').feature('e1').set('transform', 'none');
model.sol('sol3').feature('e1').set('eigref', '0.1');
model.sol('sol3').feature('e1').set('eigvfunscale', 'average');
model.sol('sol3').feature('e1').set('control', 'eigv1');
model.sol('sol3').attach('std3');
model.sol('sol3').runAll;

model.result.evaluationGroup.create('eg1', 'EvaluationGroup');
model.result.evaluationGroup('eg1').label('Evaluation Group 1: HH');
model.result.evaluationGroup('eg1').set('data', 'dset3');
model.result.evaluationGroup('eg1').setIndex('looplevelinput', 'last', 0);
model.result.evaluationGroup('eg1').create('gev1', 'EvalGlobal');
model.result.evaluationGroup('eg1').feature('gev1').label(['Global Evaluation 1: Schr' native2unicode(hex2dec({'00' 'f6'}), 'unicode') 'dinger eq.']);
model.result.evaluationGroup('eg1').feature('gev1').set('expr', {});
model.result.evaluationGroup('eg1').feature('gev1').set('descr', {});
model.result.evaluationGroup('eg1').feature('gev1').setIndex('expr', 'lambda', 0);
model.result.evaluationGroup('eg1').feature('gev1').setIndex('descr', 'HH (Schr)', 0);
model.result.evaluationGroup('eg1').run;
model.result.create('pg3', 'PlotGroup2D');
model.result('pg3').set('data', 'none');
model.result('pg3').create('tbls1', 'TableSurface');
model.result('pg3').feature('tbls1').set('source', 'evaluationgroup');
model.result('pg3').feature('tbls1').set('evaluationgroup', 'eg1');
model.result('pg3').run;
model.result('pg3').feature('tbls1').label('Table Surface 1: HH (Schr)');
model.result('pg3').feature('tbls1').set('coldata', 4);
model.result('pg3').feature('tbls1').create('hght1', 'TableHeight');
model.result('pg3').run;
model.result('pg3').run;
model.result('pg3').label('2D Band Structure, -1% Strained');
model.result('pg3').set('titletype', 'label');
model.result.evaluationGroup.duplicate('eg2', 'eg1');
model.result.evaluationGroup('eg2').label('Evaluation Group 2: LH');
model.result.evaluationGroup('eg2').setIndex('looplevelinput', 'manualindices', 0);
model.result.evaluationGroup('eg2').setIndex('looplevelindices', 2, 0);
model.result.evaluationGroup('eg2').feature('gev1').setIndex('descr', 'LH (Schr)', 0);
model.result.evaluationGroup('eg2').run;
model.result('pg3').run;
model.result('pg3').feature.duplicate('tbls2', 'tbls1');
model.result('pg3').run;
model.result('pg3').feature('tbls2').label('Table Surface 2: LH (Schr)');
model.result('pg3').feature('tbls2').set('evaluationgroup', 'eg2');
model.result('pg3').feature('tbls2').set('inheritplot', 'tbls1');
model.result.evaluationGroup.duplicate('eg3', 'eg2');
model.result.evaluationGroup('eg3').label('Evaluation Group 3: CH');
model.result.evaluationGroup('eg3').setIndex('looplevelinput', 'first', 0);
model.result.evaluationGroup('eg3').feature('gev1').setIndex('descr', 'CH (Schr)', 0);
model.result.evaluationGroup('eg3').run;
model.result('pg3').run;
model.result('pg3').feature.duplicate('tbls3', 'tbls2');
model.result('pg3').run;
model.result('pg3').feature('tbls3').label('Table Surface 3: CH (Schr)');
model.result('pg3').feature('tbls3').set('evaluationgroup', 'eg3');
model.result('pg3').run;

model.study.create('std4');
model.study('std4').label('Study 4: 2D Dispersion Analytic');
model.study('std4').setGenPlots(false);
model.study('std4').feature.copy('eigv1', 'std3/eigv1');
model.study('std4').feature('eigv1').set('eigsolver', 'lapack');
model.study('std4').feature('eigv1').setEntry('activate', 'schr', false);
model.study('std4').feature('eigv1').setEntry('activate', 'ge', true);

model.sol.create('sol4');
model.sol('sol4').study('std4');
model.sol('sol4').create('st1', 'StudyStep');
model.sol('sol4').feature('st1').set('study', 'std4');
model.sol('sol4').feature('st1').set('studystep', 'eigv1');
model.sol('sol4').create('v1', 'Variables');
model.sol('sol4').feature('v1').set('control', 'eigv1');
model.sol('sol4').create('e1', 'Eigenvalue');
model.sol('sol4').feature('e1').create('ep1', 'EigenvalueParam');
model.sol('sol4').feature('e1').feature('ep1').set('control', 'eigv1');
model.sol('sol4').feature('e1').set('control', 'eigv1');
model.sol('sol4').attach('std4');
model.sol('sol4').runAll;

model.result.evaluationGroup('eg1').feature.duplicate('gev2', 'gev1');
model.result.evaluationGroup('eg1').feature('gev2').label('Global Evaluation 2: Analytic');
model.result.evaluationGroup('eg1').feature('gev2').set('data', 'dset4');
model.result.evaluationGroup('eg1').feature('gev2').setIndex('looplevelinput', 'last', 0);
model.result.evaluationGroup('eg1').feature('gev2').setIndex('descr', 'HH (Anal)', 0);
model.result.evaluationGroup('eg1').run;
model.result('pg3').run;
model.result('pg3').feature.duplicate('tbls4', 'tbls1');
model.result('pg3').run;
model.result('pg3').feature('tbls4').label('Table Surface 4: HH (Anal)');
model.result('pg3').feature('tbls4').set('coldata', 8);
model.result('pg3').feature('tbls4').set('coloring', 'uniform');
model.result('pg3').feature('tbls4').set('color', 'gray');
model.result('pg3').feature('tbls4').set('wireframe', true);
model.result('pg3').feature('tbls4').set('inheritplot', 'tbls1');
model.result('pg3').feature('tbls4').set('inheritcolor', false);
model.result.evaluationGroup('eg2').feature.duplicate('gev2', 'gev1');
model.result.evaluationGroup('eg2').feature('gev2').label('Global Evaluation 2: Analytic');
model.result.evaluationGroup('eg2').feature('gev2').set('data', 'dset4');
model.result.evaluationGroup('eg2').feature('gev2').setIndex('looplevelinput', 'manualindices', 0);
model.result.evaluationGroup('eg2').feature('gev2').setIndex('looplevelindices', 2, 0);
model.result.evaluationGroup('eg2').feature('gev2').setIndex('descr', 'LH (Anal)', 0);
model.result.evaluationGroup('eg2').run;
model.result('pg3').run;
model.result('pg3').feature.duplicate('tbls5', 'tbls4');
model.result('pg3').run;
model.result('pg3').feature('tbls5').label('Table Surface 5: LH (Anal)');
model.result('pg3').feature('tbls5').set('evaluationgroup', 'eg2');
model.result.evaluationGroup('eg3').feature.duplicate('gev2', 'gev1');
model.result.evaluationGroup('eg3').feature('gev2').label('Global Evaluation 2: Analytic');
model.result.evaluationGroup('eg3').feature('gev2').set('data', 'dset4');
model.result.evaluationGroup('eg3').feature('gev2').setIndex('looplevelinput', 'first', 0);
model.result.evaluationGroup('eg3').feature('gev2').setIndex('descr', 'CH (Anal)', 0);
model.result.evaluationGroup('eg3').run;
model.result('pg3').run;
model.result('pg3').feature.duplicate('tbls6', 'tbls5');
model.result('pg3').run;
model.result('pg3').feature('tbls6').label('Table Surface 6: CH (Anal)');
model.result('pg3').feature('tbls6').set('evaluationgroup', 'eg3');
model.result('pg3').run;

model.view('view3').camera.setIndex('position', -0.2, 0);
model.view('view3').camera.setIndex('position', -0.4, 1);
model.view('view3').camera.set('position', [-0.2 -0.4 0.2]);
model.view('view3').camera.setIndex('up', 0.1, 0);
model.view('view3').camera.setIndex('up', 0.3, 1);
model.view('view3').camera.set('up', [0.1 0.3 0.95]);

model.title(['k' native2unicode(hex2dec({'00' 'b7'}), 'unicode') 'p Method for Strained Wurtzite GaN Band Structure']);

model.description(['This benchmark model computes the valence band structure of an unstrained and a strained bulk GaN wurtzite crystal, as a tutorial for users who wish to set up multiple wave-function components with the Schr' native2unicode(hex2dec({'00' 'f6'}), 'unicode') 'dinger Equation interface. The model follows the formulation given in the reference paper by Chuang and Chang. The diagonal and off-diagonal elements of the Hamiltonian matrix are entered using built-in features, with detailed instructions in the model documentation. The computed eigenvalues agree well with the analytic solution and Fig.' native2unicode(hex2dec({'00' 'a0'}), 'unicode') '5 in the paper.']);

model.result('pg3').feature('tbls4').set('showparam', false);
model.result('pg3').feature('tbls1').set('showparam', false);
model.result('pg3').feature('tbls5').set('showparam', false);
model.result('pg3').feature('tbls2').set('showparam', false);
model.result('pg3').feature('tbls6').set('showparam', false);
model.result('pg3').feature('tbls3').set('showparam', false);

model.mesh.clearMeshes;

model.sol('sol1').clearSolutionData;
model.sol('sol2').clearSolutionData;
model.sol('sol3').clearSolutionData;
model.sol('sol4').clearSolutionData;

model.label('k_dot_p_method_strained_wurtzite_gan_band_structure.mph');

model.modelNode.label('Components');

out = model;
